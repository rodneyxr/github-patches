[
  {
    "name": "Storage permission in BKS keystore file picker for Android 6+",
    "url": "https://github.com/lgallard/qBittorrent-Controller/issues/74",
    "description": "If the storage data permission is not granted, the file picker doesn\u0027t work, it just shows an empty list. For this case it should be asked\n",
    "keywords": [],
    "code": {
      "language": "Java",
      "url": "https://github.com/lgallard/qBittorrent-Controller/commit/4b01fe27602e725337c23d8afe0fd3611b79efa8",
      "files": [
        {
          "file_name": "app/src/free/res/values-es/strings.xml",
          "patch": "@@ -254,5 +254,7 @@\n     \u003cstring name\u003d\"settings_qbittorrent_https_self_signed_keystore_password_title\"\u003eContraseña del almacén de claves \u003c/string\u003e\n     \u003cstring name\u003d\"error_permission\"\u003eSe requiere acceso de almacenamiento para descargar y enviar los archivos torrents!\u003c/string\u003e\n     \u003cstring name\u003d\"error_grant_permission\"\u003eSe requiere acceso de almacenamiento para descargar y enviar los archivos torrents\\n\\n.¿Le gustaría conceder el permiso en la configuración de Android?\u003c/string\u003e\n+    \u003cstring name\u003d\"error_grant_permission2\"\u003eSe requiere acceso de almacenamiento para listar directorios y archivos!\\n\\n¿Le gustaría conceder el permiso en la configuración de Android?\u003c/string\u003e\n+    \u003cstring name\u003d\"error_permission2\"\u003eSe requiere acceso de almacenamiento para listar directorios y archivos!\u003c/string\u003e\n \n \u003c/resources\u003e"
        },
        {
          "file_name": "app/src/free/res/values-eu/strings.xml",
          "patch": "@@ -253,6 +253,9 @@\n   \u003cstring name\u003d\"settings_qbittorrent_https_self_signed_keystore_password_title\"\u003eGiltzategi sarhitza\u003c/string\u003e\n   \u003cstring name\u003d\"error_grant_permission\"\u003eBiltegiratze sarbidea beharrezkoa da torrentak jeitsi eta bidaltzeko!\\n\\nBaimena ematea nahi duzu Android ezarpenetan?\u003c/string\u003e\n   \u003cstring name\u003d\"error_permission\"\u003eBiltegirartze sarbidea beharrezkoa da torrentak jeitsi eta bidaltzeko!\u003c/string\u003e\n+  \u003cstring name\u003d\"error_grant_permission2\"\u003eBiltegiratze sarbidea ordena guneak eta fitxategiak zerrendatu behar da!\\n\\nBaimena ematea nahi duzu Android ezarpenetan?\u003c/string\u003e\n+  \u003cstring name\u003d\"error_permission2\"\u003eBiltegiratze sarbidea ordena guneak eta fitxategiak zerrendatu behar da!\u003c/string\u003e\n+\n \u003c/resources\u003e\n \n "
        },
        {
          "file_name": "app/src/free/res/values-fr/strings.xml",
          "patch": "@@ -252,6 +252,8 @@\n     \u003cstring name\u003d\"settings_qbittorrent_https_self_signed_keystore_password_title\"\u003eMot de passe keystore\u003c/string\u003e\n     \u003cstring name\u003d\"settings_qbittorrent_https_self_signed_bks_file_title\"\u003eKeystore de certificat auto-signé\u003c/string\u003e\n     \u003cstring name\u003d\"error_grant_permission\"\u003eL\\\u0027accès de stockage est nécessaire pour télécharger et envoyer des fichiers torrent!\\n\\nVoulez-vous accorder l\\\u0027autorisation dans les paramètres Android?\u003c/string\u003e\n-    \u003cstring name\u003d\"error_permission\"\u003el\\\u0027accès de stockage est nécessaire pour télécharger et envoyer des fichiers torrent\u003c/string\u003e\n+    \u003cstring name\u003d\"error_permission\"\u003eL\\\u0027accès de stockage est nécessaire pour télécharger et envoyer des fichiers torrent!\u003c/string\u003e\n+    \u003cstring name\u003d\"error_grant_permission2\"\u003eL\\\u0027accès au stockage est nécessaire afin de répertorier les répertoires et fichiers!\\n\\nVoulez-vous accorder l\\\u0027autorisation dans les paramètres Android?\u003c/string\u003e\n+    \u003cstring name\u003d\"error_permission2\"\u003eL\\\u0027accès au stockage est nécessaire afin de répertorier les répertoires et fichiers!\u003c/string\u003e\n \n \u003c/resources\u003e\n\\ No newline at end of file"
        },
        {
          "file_name": "app/src/free/res/values-it-rIT/strings.xml",
          "patch": "@@ -253,5 +253,7 @@\n     \u003cstring name\u003d\"settings_qbittorrent_https_self_signed_bks_file_title\"\u003eChiavi per il certificato auto-firmato\u003c/string\u003e\n     \u003cstring name\u003d\"error_grant_permission\"\u003eL\\\u0027accesso storage è necessario per scaricare e inviare file torrent!\\n\\nVolete concedere l\\\u0027autorizzazione nelle impostazioni di Android?\u003c/string\u003e\n     \u003cstring name\u003d\"error_permission\"\u003eL\\\u0027accesso storage è necessario per scaricare e inviare file torrent!\u003c/string\u003e\n+    \u003cstring name\u003d\"error_grant_permission2\"\u003eL\\\u0027accesso storage è necessario per elencare directory e file!\\n\\nVolete concedere l\\\u0027autorizzazione nelle impostazioni di Android?\u003c/string\u003e\n+    \u003cstring name\u003d\"error_permission2\"\u003eL\\\u0027accesso storage è necessario per elencare directory e file!\u003c/string\u003e\n \n \u003c/resources\u003e\n\\ No newline at end of file"
        },
        {
          "file_name": "app/src/free/res/values-ja/strings.xml",
          "patch": "@@ -244,5 +244,7 @@\n   \u003cstring name\u003d\"settings_qbittorrent_https_self_signed_keystore_password_title\"\u003eキーストアのパスワード\u003c/string\u003e\n   \u003cstring name\u003d\"error_grant_permission\"\u003eTorrent ファイルをダウンロードしたり送信するために、ストレージのアクセスが必要です! \\nAndroid の設定でアクセス許可を付与しますか?\u003c/string\u003e\n   \u003cstring name\u003d\"error_permission\"\u003eTorrent ファイルをダウンロードしたり送信するために、ストレージのアクセスが必要です!\u003c/string\u003e\n+  \u003cstring name\u003d\"error_grant_permission2\"\u003eストレージへのアクセスは、ディレクトリとファイルの一覧を表示するために必要です。! \\nAndroid の設定でアクセス許可を付与しますか?\u003c/string\u003e\n+  \u003cstring name\u003d\"error_permission2\"\u003eストレージへのアクセスは、ディレクトリとファイルの一覧を表示するために必要です。!\u003c/string\u003e\n \n \u003c/resources\u003e"
        },
        {
          "file_name": "app/src/free/res/values-pl/strings.xml",
          "patch": "@@ -253,5 +253,7 @@\n     \u003cstring name\u003d\"settings_qbittorrent_https_self_signed_bks_file_title\"\u003eKluczy dla certyfikatu z podpisem własnym\u003c/string\u003e\n     \u003cstring name\u003d\"error_grant_permission\"\u003eDostęp do pamięci jest zobowiązany do pobierania i wysyłania plików torrent!\\n\\nChciałbyś udzielenia pozwolenia w ustawieniach Android?\u003c/string\u003e\n     \u003cstring name\u003d\"error_permission\"\u003eDostęp do pamięci jest zobowiązany do pobierania i wysyłania plików torrent!\u003c/string\u003e\n+    \u003cstring name\u003d\"error_grant_permission2\"\u003eDostęp do bagażu wymagane do listy katalogów i plików!\\n\\nChciałbyś udzielenia pozwolenia w ustawieniach Android?\u003c/string\u003e\n+    \u003cstring name\u003d\"error_permission2\"\u003eDostęp do bagażu wymagane do listy katalogów i plików!\u003c/string\u003e\n \n \u003c/resources\u003e\n\\ No newline at end of file"
        },
        {
          "file_name": "app/src/free/res/values-pt-rBR/strings.xml",
          "patch": "@@ -253,5 +253,7 @@\n     \u003cstring name\u003d\"settings_qbittorrent_https_self_signed_bks_file_title\"\u003eKeystore for self-signed certificate\u003c/string\u003e\n     \u003cstring name\u003d\"error_grant_permission\"\u003eAcesso de armazenamento é necessário para baixar e enviar arquivos torrent!\\n\\nVocê gostaria de conceder a permissão em configurações do Android?\u003c/string\u003e\n     \u003cstring name\u003d\"error_permission\"\u003eAcesso de armazenamento é necessário para baixar e enviar arquivos torrent!\u003c/string\u003e\n+    \u003cstring name\u003d\"error_grant_permission2\"\u003eAcesso de armazenamento é necessário, a fim de listar diretórios e arquivos!\\n\\nVocê gostaria de conceder a permissão em configurações do Android?\u003c/string\u003e\n+    \u003cstring name\u003d\"error_permission2\"\u003eAcesso de armazenamento é necessário, a fim de listar diretórios e arquivos!\u003c/string\u003e\n \n \u003c/resources\u003e\n\\ No newline at end of file"
        },
        {
          "file_name": "app/src/free/res/values-pt-rPT/strings.xml",
          "patch": "@@ -253,5 +253,7 @@\n     \u003cstring name\u003d\"settings_qbittorrent_https_self_signed_bks_file_title\"\u003eKeystore for self-signed certificate\u003c/string\u003e\n     \u003cstring name\u003d\"error_grant_permission\"\u003eAcesso de armazenamento é necessário para baixar e enviar arquivos torrent!\\n\\nVocê gostaria de conceder a permissão em configurações do Android?\u003c/string\u003e\n     \u003cstring name\u003d\"error_permission\"\u003eAcesso de armazenamento é necessário para baixar e enviar arquivos torrent!\u003c/string\u003e\n+    \u003cstring name\u003d\"error_grant_permission2\"\u003eAcesso de armazenamento é necessário, a fim de listar diretórios e arquivos!\\n\\nVocê gostaria de conceder a permissão em configurações do Android?\u003c/string\u003e\n+    \u003cstring name\u003d\"error_permission2\"\u003eAcesso de armazenamento é necessário, a fim de listar diretórios e arquivos!\u003c/string\u003e\n \n \u003c/resources\u003e\n\\ No newline at end of file"
        },
        {
          "file_name": "app/src/free/res/values-ru/strings.xml",
          "patch": "@@ -253,5 +253,7 @@\n   \u003cstring name\u003d\"settings_qbittorrent_https_self_signed_bks_file_title\"\u003eKeystore для собственного сертификата\u003c/string\u003e\n   \u003cstring name\u003d\"error_grant_permission\"\u003eДоступ хранения требуется для загрузки и отправки торрент-файлы!\\n\\nВы хотите, чтобы предоставить разрешение в настройках Android?\u003c/string\u003e\n   \u003cstring name\u003d\"error_permission\"\u003eДоступ для хранения требуется, чтобы загрузить и отправить торрент-файлы!\u003c/string\u003e\n+  \u003cstring name\u003d\"error_grant_permission2\"\u003eдоступ для хранения требуется для того, чтобы перечислить директории и файлы!\\n\\nВы хотите, чтобы предоставить разрешение в настройках Android?\u003c/string\u003e\n+  \u003cstring name\u003d\"error_permission2\"\u003eдоступ для хранения требуется для того, чтобы перечислить директории и файлы!\u003c/string\u003e\n \n \u003c/resources\u003e"
        },
        {
          "file_name": "app/src/free/res/values-sv/strings.xml",
          "patch": "@@ -251,7 +251,9 @@\n     \u003cstring name\u003d\"settings_qbittorrent_https_category\"\u003eHTTPS\u003c/string\u003e\n     \u003cstring name\u003d\"settings_qbittorrent_https_self_signed_keystore_password_title\"\u003eyckelbehållaren lösenord\u003c/string\u003e\n     \u003cstring name\u003d\"settings_qbittorrent_https_self_signed_bks_file_title\"\u003eNyckel för självsignerat certifikat\u003c/string\u003e\n-    \u003cstring name\u003d\"error_grant_permission\"\u003eTillgång lagring krävs för att hämta och skicka torrentfiler !\\n\\nVill du ge tillstånd i Android-inställningar?\u003c/string\u003e\n-    \u003cstring name\u003d\"error_permission\"\u003eTillgång lagring krävs för att hämta och skicka torrentfiler !\u003c/string\u003e\n+    \u003cstring name\u003d\"error_grant_permission\"\u003eTillgång lagring krävs för att hämta och skicka torrentfiler!\\n\\nVill du ge tillstånd i Android-inställningar?\u003c/string\u003e\n+    \u003cstring name\u003d\"error_permission\"\u003eTillgång lagring krävs för att hämta och skicka torrentfiler!\u003c/string\u003e\n+    \u003cstring name\u003d\"error_grant_permission2\"\u003eKrävs lagring tillgång för att lista kataloger och filer!\\n\\nVill du ge tillstånd i Android-inställningar?\u003c/string\u003e\n+    \u003cstring name\u003d\"error_permission2\"\u003eKrävs lagring tillgång för att lista kataloger och filer!\u003c/string\u003e\n \n \u003c/resources\u003e\n\\ No newline at end of file"
        },
        {
          "file_name": "app/src/free/res/values/strings.xml",
          "patch": "@@ -252,5 +252,7 @@\n     \u003cstring name\u003d\"settings_qbittorrent_https_self_signed_keystore_password_title\"\u003eKeystore password\u003c/string\u003e\n     \u003cstring name\u003d\"error_grant_permission\"\u003eStorage access required to download and send torrent files!\\n\\nWould you like to grant the permission in Android settings?\u003c/string\u003e\n     \u003cstring name\u003d\"error_permission\"\u003eStorage access required to download and send torrent files!\u003c/string\u003e\n+    \u003cstring name\u003d\"error_grant_permission2\"\u003eStorage access required to list directories and files!\\n\\nWould you like to grant the permission in Android settings?\u003c/string\u003e\n+    \u003cstring name\u003d\"error_permission2\"\u003eStorage access required to list directories and files!\u003c/string\u003e\n \n \u003c/resources\u003e\n\\ No newline at end of file"
        },
        {
          "file_name": "app/src/main/java/com/lgallardo/qbittorrentclient/SettingsActivity.java",
          "patch": "@@ -8,19 +8,25 @@\n  */\n package com.lgallardo.qbittorrentclient;\n \n+import android.Manifest;\n import android.app.Activity;\n import android.app.AlertDialog;\n import android.app.AlertDialog.Builder;\n import android.content.DialogInterface;\n import android.content.Intent;\n import android.content.SharedPreferences;\n import android.content.SharedPreferences.Editor;\n+import android.content.pm.PackageManager;\n+import android.net.Uri;\n import android.os.Bundle;\n import android.preference.CheckBoxPreference;\n import android.preference.EditTextPreference;\n import android.preference.ListPreference;\n import android.preference.Preference;\n import android.preference.PreferenceActivity;\n+import android.provider.Settings;\n+import android.support.v4.app.ActivityCompat;\n+import android.support.v4.content.ContextCompat;\n import android.util.Log;\n import android.view.Menu;\n \n@@ -57,6 +63,7 @@\n \n     private Preference keystore_path;\n     private EditTextPreference keystore_password;\n+    private static final int MY_PERMISSIONS_REQUEST_WRITE_EXTERNAL_STORAGE \u003d 100;\n \n     @Override\n     protected void onCreate(Bundle savedInstanceState) {\n@@ -311,16 +318,178 @@ public void onCancel(DialogInterface dialog) {\n         keystore_path.setOnPreferenceClickListener(new Preference.OnPreferenceClickListener() {\n             @Override\n             public boolean onPreferenceClick(Preference preference) {\n-                Intent intent \u003d new Intent(getApplicationContext(), FilePickerActivity.class);\n-                intent.putExtra(FilePickerActivity.ARG_FILE_FILTER, Pattern.compile(\".*\\\\.bks\"));\n-                startActivityForResult(intent, 1);\n+\n+                // Check dangerous permissions and open file picker\n+                openFilePicker();\n \n                 return true;\n             }\n         });\n \n     }\n \n+\n+\n+\n+    private void openFilePicker() {\n+\n+        // Check Dangerous permissions (Android 6.0+, API 23+)\n+        if (ContextCompat.checkSelfPermission(this, Manifest.permission.WRITE_EXTERNAL_STORAGE) !\u003d PackageManager.PERMISSION_GRANTED) {\n+\n+\n+            // Should we show an explanation?\n+            if (ActivityCompat.shouldShowRequestPermissionRationale(this, Manifest.permission.WRITE_EXTERNAL_STORAGE)) {\n+                genericOkDialog(R.string.error_permission2,\n+                        new DialogInterface.OnClickListener() {\n+                            @Override\n+                            public void onClick(DialogInterface dialog, int which) {\n+                                ActivityCompat.requestPermissions(SettingsActivity.this, new String[]{Manifest.permission.WRITE_EXTERNAL_STORAGE, Manifest.permission.WRITE_EXTERNAL_STORAGE},\n+                                        MY_PERMISSIONS_REQUEST_WRITE_EXTERNAL_STORAGE);\n+                            }\n+                        });\n+\n+            }else{\n+\n+                // No explanation needed, request the permission.\n+                ActivityCompat.requestPermissions(this, new String[]{Manifest.permission.WRITE_EXTERNAL_STORAGE, Manifest.permission.WRITE_EXTERNAL_STORAGE},\n+                        MY_PERMISSIONS_REQUEST_WRITE_EXTERNAL_STORAGE);\n+\n+            }\n+\n+\n+        } else {\n+\n+            // Permissions granted, open file picker\n+            Intent intent \u003d new Intent(getApplicationContext(), FilePickerActivity.class);\n+            intent.putExtra(FilePickerActivity.ARG_FILE_FILTER, Pattern.compile(\".*\\\\.bks\"));\n+            startActivityForResult(intent, 1);\n+\n+        }\n+\n+\n+    }\n+\n+    @Override\n+    public void onRequestPermissionsResult(int requestCode,\n+                                           String permissions[], int[] grantResults) {\n+        switch (requestCode) {\n+            case MY_PERMISSIONS_REQUEST_WRITE_EXTERNAL_STORAGE: {\n+                // If request is cancelled, the result arrays are empty.\n+                if (grantResults.length \u003e 0 \u0026\u0026 grantResults[0] \u003d\u003d PackageManager.PERMISSION_GRANTED) {\n+\n+                    // Permissions granted, open file picker\n+                    Intent intent \u003d new Intent(getApplicationContext(), FilePickerActivity.class);\n+                    intent.putExtra(FilePickerActivity.ARG_FILE_FILTER, Pattern.compile(\".*\\\\.bks\"));\n+                    startActivityForResult(intent, 1);\n+\n+\n+                } else {\n+\n+                    // Permission denied\n+\n+\n+                    // Should we show an explanation?\n+                    if (!ActivityCompat.shouldShowRequestPermissionRationale(this, Manifest.permission.WRITE_EXTERNAL_STORAGE)) {\n+\n+                        genericOkCancelDialog(R.string.error_grant_permission2,\n+                                new DialogInterface.OnClickListener() {\n+                                    @Override\n+                                    public void onClick(DialogInterface dialog, int which) {\n+\n+                                        Intent appIntent \u003d new Intent(Settings.ACTION_APPLICATION_DETAILS_SETTINGS);\n+                                        appIntent.setData(Uri.parse(\"package:\" + MainActivity.packageName));\n+                                        startActivityForResult(appIntent, 0);\n+                                    }\n+                                });\n+                    }\n+                    return;\n+                }\n+            }\n+        }\n+    }\n+\n+\n+    public void genericOkDialog(int title, int message) {\n+        genericOkDialog(title, message, null);\n+    }\n+\n+    public void genericOkDialog(int message, DialogInterface.OnClickListener okListener) {\n+        genericOkDialog(-1, message, okListener);\n+    }\n+\n+\n+    public void genericOkDialog(int message) {\n+        genericOkDialog(-1, message, null);\n+    }\n+\n+\n+    public void genericOkDialog(int title, int message, DialogInterface.OnClickListener okListener) {\n+\n+        if (!isFinishing()) {\n+\n+            Builder builder \u003d new Builder(this);\n+\n+            // Title\n+            if (title !\u003d -1) {\n+                builder.setTitle(title);\n+            }\n+\n+            // Message\n+            builder.setMessage(message);\n+\n+            // Ok\n+            builder.setPositiveButton(R.string.ok, okListener);\n+\n+            // Create dialog\n+            AlertDialog dialog \u003d builder.create();\n+\n+            // Show dialog\n+            dialog.show();\n+        }\n+\n+    }\n+\n+    private void genericOkCancelDialog(int message, DialogInterface.OnClickListener okListener) {\n+\n+        genericOkCancelDialog(-1, message, okListener);\n+\n+    }\n+\n+    private void genericOkCancelDialog(int message) {\n+\n+        genericOkCancelDialog(-1, message, null);\n+\n+    }\n+\n+    private void genericOkCancelDialog(int title, int message, DialogInterface.OnClickListener okListener) {\n+\n+        if (!isFinishing()) {\n+\n+            Builder builder \u003d new Builder(this);\n+\n+            // Title\n+            if (title !\u003d -1) {\n+                builder.setTitle(title);\n+            }\n+\n+            // Message\n+            builder.setMessage(message);\n+\n+            // Ok\n+            builder.setPositiveButton(R.string.ok, okListener);\n+\n+            // Cancel\n+            builder.setNegativeButton(R.string.cancel, null);\n+\n+            // Create dialog\n+            AlertDialog dialog \u003d builder.create();\n+\n+            // Show dialog\n+            dialog.show();\n+        }\n+\n+    }\n+\n     @Override\n     protected void onActivityResult(int requestCode, int resultCode, Intent data) {\n \n@@ -343,6 +512,8 @@ protected void onActivityResult(int requestCode, int resultCode, Intent data) {\n         keystore_path.setSummary(keystore_path_value);\n     }\n \n+\n+\n     @Override\n     public boolean onCreateOptionsMenu(Menu menu) {\n         // Inflate the menu; this adds items to the action bar if it is present."
        },
        {
          "file_name": "app/src/pro/res/values-es/strings.xml",
          "patch": "@@ -243,7 +243,9 @@\n     \u003cstring name\u003d\"settings_qbittorrent_https_category\"\u003eHTTPS\u003c/string\u003e\n     \u003cstring name\u003d\"settings_qbittorrent_https_self_signed_bks_file_title\"\u003eAlmacén de claves del certificado autofirmado\u003c/string\u003e\n     \u003cstring name\u003d\"settings_qbittorrent_https_self_signed_keystore_password_title\"\u003eContraseña del almacén de claves \u003c/string\u003e\n-    \u003cstring name\u003d\"error_permission\"\u003eSe requiere acceso de almacenamiento para descargar y enviar los archivos torrents!\u003c/string\u003e\n     \u003cstring name\u003d\"error_grant_permission\"\u003eSe requiere acceso de almacenamiento para descargar y enviar los archivos torrents\\n\\n.¿Le gustaría conceder el permiso en la configuración de Android?\u003c/string\u003e\n+    \u003cstring name\u003d\"error_permission\"\u003eSe requiere acceso de almacenamiento para descargar y enviar los archivos torrents!\u003c/string\u003e\n+    \u003cstring name\u003d\"error_grant_permission2\"\u003eSe requiere acceso de almacenamiento para listar directorios y archivos!\\n\\n¿Le gustaría conceder el permiso en la configuración de Android?\u003c/string\u003e\n+    \u003cstring name\u003d\"error_permission2\"\u003eSe requiere acceso de almacenamiento para listar directorios y archivos!\u003c/string\u003e\n \n \u003c/resources\u003e\n\\ No newline at end of file"
        },
        {
          "file_name": "app/src/pro/res/values-eu/strings.xml",
          "patch": "@@ -246,4 +246,6 @@\n   \u003cstring name\u003d\"settings_qbittorrent_https_self_signed_keystore_password_title\"\u003eGiltzategi sarhitza\u003c/string\u003e\n   \u003cstring name\u003d\"error_grant_permission\"\u003eBiltegiratze sarbidea beharrezkoa da torrentak jeitsi eta bidaltzeko!\\n\\nBaimena ematea nahi duzu Android ezarpenetan?\u003c/string\u003e\n   \u003cstring name\u003d\"error_permission\"\u003eBiltegirartze sarbidea beharrezkoa da torrentak jeitsi eta bidaltzeko!\u003c/string\u003e\n+  \u003cstring name\u003d\"error_grant_permission2\"\u003eBiltegiratze sarbidea ordena guneak eta fitxategiak zerrendatu behar da!\\n\\nBaimena ematea nahi duzu Android ezarpenetan?\u003c/string\u003e\n+  \u003cstring name\u003d\"error_permission2\"\u003eBiltegiratze sarbidea ordena guneak eta fitxategiak zerrendatu behar da!\u003c/string\u003e\n \u003c/resources\u003e"
        },
        {
          "file_name": "app/src/pro/res/values-fr/strings.xml",
          "patch": "@@ -245,6 +245,8 @@\n     \u003cstring name\u003d\"settings_qbittorrent_https_self_signed_keystore_password_title\"\u003eMot de passe keystore\u003c/string\u003e\n     \u003cstring name\u003d\"settings_qbittorrent_https_self_signed_bks_file_title\"\u003eKeystore de certificat auto-signé\u003c/string\u003e\n     \u003cstring name\u003d\"error_grant_permission\"\u003eL\\\u0027accès de stockage est nécessaire pour télécharger et envoyer des fichiers torrent!\\n\\nVoulez-vous accorder l\\\u0027autorisation dans les paramètres Android?\u003c/string\u003e\n-    \u003cstring name\u003d\"error_permission\"\u003el\\\u0027accès de stockage est nécessaire pour télécharger et envoyer des fichiers torrent\u003c/string\u003e\n+    \u003cstring name\u003d\"error_permission\"\u003eL\\\u0027accès de stockage est nécessaire pour télécharger et envoyer des fichiers torrent\u003c/string\u003e\n+    \u003cstring name\u003d\"error_grant_permission2\"\u003eL\\\u0027accès au stockage est nécessaire afin de répertorier les répertoires et fichiers!\\n\\nVoulez-vous accorder l\\\u0027autorisation dans les paramètres Android?\u003c/string\u003e\n+    \u003cstring name\u003d\"error_permission2\"\u003eL\\\u0027accès au stockage est nécessaire afin de répertorier les répertoires et fichiers!\u003c/string\u003e\n \n \u003c/resources\u003e\n\\ No newline at end of file"
        },
        {
          "file_name": "app/src/pro/res/values-it-rIT/strings.xml",
          "patch": "@@ -246,5 +246,7 @@\n     \u003cstring name\u003d\"settings_qbittorrent_https_self_signed_bks_file_title\"\u003eChiavi per il certificato auto-firmato\u003c/string\u003e\n     \u003cstring name\u003d\"error_grant_permission\"\u003eL\\\u0027accesso storage è necessario per scaricare e inviare file torrent!\\n\\nVolete concedere l\\\u0027autorizzazione nelle impostazioni di Android?\u003c/string\u003e\n     \u003cstring name\u003d\"error_permission\"\u003eL\\\u0027accesso storage è necessario per scaricare e inviare file torrent!\u003c/string\u003e\n+    \u003cstring name\u003d\"error_grant_permission2\"\u003eL\\\u0027accesso storage è necessario per elencare directory e file!\\n\\nVolete concedere l\\\u0027autorizzazione nelle impostazioni di Android?\u003c/string\u003e\n+    \u003cstring name\u003d\"error_permission2\"\u003eL\\\u0027accesso storage è necessario per elencare directory e file!\u003c/string\u003e\n \n \u003c/resources\u003e\n\\ No newline at end of file"
        },
        {
          "file_name": "app/src/pro/res/values-ja/strings.xml",
          "patch": "@@ -237,6 +237,8 @@\n   \u003cstring name\u003d\"settings_qbittorrent_https_self_signed_keystore_password_title\"\u003eキーストアのパスワード\u003c/string\u003e\n   \u003cstring name\u003d\"error_grant_permission\"\u003eTorrent ファイルをダウンロードしたり送信するために、ストレージのアクセスが必要です! \\nAndroid の設定でアクセス許可を付与しますか?\u003c/string\u003e\n   \u003cstring name\u003d\"error_permission\"\u003eTorrent ファイルをダウンロードしたり送信するために、ストレージのアクセスが必要です!\u003c/string\u003e\n+  \u003cstring name\u003d\"error_grant_permission2\"\u003eストレージへのアクセスは、ディレクトリとファイルの一覧を表示するために必要です。! \\nAndroid の設定でアクセス許可を付与しますか?\u003c/string\u003e\n+  \u003cstring name\u003d\"error_permission2\"\u003eストレージへのアクセスは、ディレクトリとファイルの一覧を表示するために必要です。!\u003c/string\u003e\n \n \n \u003c/resources\u003e"
        },
        {
          "file_name": "app/src/pro/res/values-pl/strings.xml",
          "patch": "@@ -246,5 +246,7 @@\n     \u003cstring name\u003d\"settings_qbittorrent_https_self_signed_bks_file_title\"\u003eKluczy dla certyfikatu z podpisem własnym\u003c/string\u003e\n     \u003cstring name\u003d\"error_grant_permission\"\u003eDostęp do pamięci jest zobowiązany do pobierania i wysyłania plików torrent!\\n\\nChciałbyś udzielenia pozwolenia w ustawieniach Android?\u003c/string\u003e\n     \u003cstring name\u003d\"error_permission\"\u003eDostęp do pamięci jest zobowiązany do pobierania i wysyłania plików torrent!\u003c/string\u003e\n+    \u003cstring name\u003d\"error_grant_permission2\"\u003eDostęp do bagażu wymagane do listy katalogów i plików!\\n\\nChciałbyś udzielenia pozwolenia w ustawieniach Android?\u003c/string\u003e\n+    \u003cstring name\u003d\"error_permission2\"\u003eDostęp do bagażu wymagane do listy katalogów i plików!\u003c/string\u003e\n \n \u003c/resources\u003e\n\\ No newline at end of file"
        },
        {
          "file_name": "app/src/pro/res/values-pt-rBR/strings.xml",
          "patch": "@@ -246,5 +246,7 @@\n     \u003cstring name\u003d\"settings_qbittorrent_https_self_signed_bks_file_title\"\u003eKeystore for self-signed certificate\u003c/string\u003e\n     \u003cstring name\u003d\"error_grant_permission\"\u003eAcesso de armazenamento é necessário para baixar e enviar arquivos torrent!\\n\\nVocê gostaria de conceder a permissão em configurações do Android?\u003c/string\u003e\n     \u003cstring name\u003d\"error_permission\"\u003eAcesso de armazenamento é necessário para baixar e enviar arquivos torrent!\u003c/string\u003e\n+    \u003cstring name\u003d\"error_grant_permission2\"\u003eAcesso de armazenamento é necessário, a fim de listar diretórios e arquivos!\\n\\nVocê gostaria de conceder a permissão em configurações do Android?\u003c/string\u003e\n+    \u003cstring name\u003d\"error_permission2\"\u003eAcesso de armazenamento é necessário, a fim de listar diretórios e arquivos!\u003c/string\u003e\n \n \u003c/resources\u003e\n\\ No newline at end of file"
        },
        {
          "file_name": "app/src/pro/res/values-pt-rPT/strings.xml",
          "patch": "@@ -246,5 +246,7 @@\n     \u003cstring name\u003d\"settings_qbittorrent_https_self_signed_bks_file_title\"\u003eKeystore for self-signed certificate\u003c/string\u003e\n     \u003cstring name\u003d\"error_grant_permission\"\u003eAcesso de armazenamento é necessário para baixar e enviar arquivos torrent!\\n\\nVocê gostaria de conceder a permissão em configurações do Android?\u003c/string\u003e\n     \u003cstring name\u003d\"error_permission\"\u003eAcesso de armazenamento é necessário para baixar e enviar arquivos torrent!\u003c/string\u003e\n+    \u003cstring name\u003d\"error_grant_permission2\"\u003eAcesso de armazenamento é necessário, a fim de listar diretórios e arquivos!\\n\\nVocê gostaria de conceder a permissão em configurações do Android?\u003c/string\u003e\n+    \u003cstring name\u003d\"error_permission2\"\u003eAcesso de armazenamento é necessário, a fim de listar diretórios e arquivos!\u003c/string\u003e\n \n \u003c/resources\u003e\n\\ No newline at end of file"
        },
        {
          "file_name": "app/src/pro/res/values-ru/strings.xml",
          "patch": "@@ -246,5 +246,7 @@\n   \u003cstring name\u003d\"settings_qbittorrent_https_self_signed_bks_file_title\"\u003eKeystore для собственного сертификата\u003c/string\u003e\n   \u003cstring name\u003d\"error_grant_permission\"\u003eДоступ хранения требуется для загрузки и отправки торрент-файлы!\\n\\nВы хотите, чтобы предоставить разрешение в настройках Android?\u003c/string\u003e\n   \u003cstring name\u003d\"error_permission\"\u003eДоступ для хранения требуется, чтобы загрузить и отправить торрент-файлы!\u003c/string\u003e\n+  \u003cstring name\u003d\"error_grant_permission2\"\u003eдоступ для хранения требуется для того, чтобы перечислить директории и файлы!\\n\\nВы хотите, чтобы предоставить разрешение в настройках Android?\u003c/string\u003e\n+  \u003cstring name\u003d\"error_permission2\"\u003eдоступ для хранения требуется для того, чтобы перечислить директории и файлы!\u003c/string\u003e\n \n \u003c/resources\u003e"
        },
        {
          "file_name": "app/src/pro/res/values-sv/strings.xml",
          "patch": "@@ -244,7 +244,9 @@\n     \u003cstring name\u003d\"settings_qbittorrent_https_category\"\u003eHTTPS\u003c/string\u003e\n     \u003cstring name\u003d\"settings_qbittorrent_https_self_signed_keystore_password_title\"\u003eyckelbehållaren lösenord\u003c/string\u003e\n     \u003cstring name\u003d\"settings_qbittorrent_https_self_signed_bks_file_title\"\u003eNyckel för självsignerat certifikat\u003c/string\u003e\n-    \u003cstring name\u003d\"error_grant_permission\"\u003eTillgång lagring krävs för att hämta och skicka torrentfiler !\\n\\nVill du ge tillstånd i Android-inställningar?\u003c/string\u003e\n-    \u003cstring name\u003d\"error_permission\"\u003eTillgång lagring krävs för att hämta och skicka torrentfiler !\u003c/string\u003e\n+    \u003cstring name\u003d\"error_grant_permission\"\u003eTillgång lagring krävs för att hämta och skicka torrentfiler!\\n\\nVill du ge tillstånd i Android-inställningar?\u003c/string\u003e\n+    \u003cstring name\u003d\"error_permission\"\u003eTillgång lagring krävs för att hämta och skicka torrentfiler!\u003c/string\u003e\n+    \u003cstring name\u003d\"error_grant_permission2\"\u003eKrävs lagring tillgång för att lista kataloger och filer!\\n\\nVill du ge tillstånd i Android-inställningar?\u003c/string\u003e\n+    \u003cstring name\u003d\"error_permission2\"\u003eKrävs lagring tillgång för att lista kataloger och filer!\u003c/string\u003e\n \n \u003c/resources\u003e\n\\ No newline at end of file"
        },
        {
          "file_name": "app/src/pro/res/values/strings.xml",
          "patch": "@@ -246,4 +246,7 @@\n     \u003cstring name\u003d\"settings_qbittorrent_https_self_signed_keystore_password_title\"\u003eKeystore password\u003c/string\u003e\n     \u003cstring name\u003d\"error_grant_permission\"\u003eStorage access required to download and send torrent files!\\n\\nWould you like to grant the permission in Android settings?\u003c/string\u003e\n     \u003cstring name\u003d\"error_permission\"\u003eStorage access required to download and send torrent files!\u003c/string\u003e\n+    \u003cstring name\u003d\"error_grant_permission2\"\u003eStorage access required to list directories and files!\\n\\nWould you like to grant the permission in Android settings?\u003c/string\u003e\n+    \u003cstring name\u003d\"error_permission2\"\u003eStorage access required to list directories and files!\u003c/string\u003e\n+\n \u003c/resources\u003e\n\\ No newline at end of file"
        }
      ]
    }
  },
  {
    "name": "Canvas.drawRect() stops drawing after updating to Android Studio 0.6.0",
    "url": "https://github.com/barbeau/gpstest/issues/51",
    "description": "I updated to use Android Studio 0.6.0, which required bumping the build-tools to v19.1.0 (from v19.0.1), the Android Gradle plugin to v0.11 (from 0.9), and the Gradle wrapper to 1.12 (from 1.11).\n\nBefore the above changes, GPSTest was successfully drawing squares on a canvas to show signal strength of GLONASS satellites (see IDs 87 and 88):\n![beforeandroidstudio0 6 0-resized](https://cloud.githubusercontent.com/assets/928045/3253063/a9a2aa22-f1ce-11e3-8467-5f902bc9317f.png)\n\nAfter updating Android tools and launching via Android Studio or gradlew installDebug, the squares suddenly disappeared (see IDs 77, 87, 88):\n\n![afterandroidstudio0 6 0-resized](https://cloud.githubusercontent.com/assets/928045/3253068/bb0cdc24-f1ce-11e3-861a-02255b3bbc86.png)\n",
    "keywords": [
      "0",
      "studio",
      "1",
      "6",
      "android"
    ],
    "code": {
      "language": "Java",
      "url": "https://github.com/barbeau/gpstest/commit/e4861771c57fa12d5a36620d3f1a33326bc3c705",
      "files": [
        {
          "file_name": "GPSTest/src/main/java/com/android/gpstest/GpsSkyFragment.java",
          "patch": "@@ -354,9 +354,9 @@ private void drawSatellite(Canvas c, int s, float elev, float azim, float snr, i\n                     c.drawCircle(x, y, SAT_RADIUS, mSatelliteStrokePaint);\n                     break;\n                 case GLONASS:\n-                    c.drawRect(x - SAT_RADIUS, y + SAT_RADIUS, x + SAT_RADIUS, y - SAT_RADIUS,\n+                    c.drawRect(x - SAT_RADIUS, y - SAT_RADIUS, x + SAT_RADIUS, y + SAT_RADIUS,\n                             thisPaint);\n-                    c.drawRect(x - SAT_RADIUS, y + SAT_RADIUS, x + SAT_RADIUS, y - SAT_RADIUS,\n+                    c.drawRect(x - SAT_RADIUS, y - SAT_RADIUS, x + SAT_RADIUS, y + SAT_RADIUS,\n                             mSatelliteStrokePaint);\n                     break;\n             }"
        }
      ]
    }
  },
  {
    "name": "HW acceleration switched off on Android 6.0",
    "url": "https://github.com/cgeo/cgeo/issues/5598",
    "description": "##### Detailed steps causing the problem:\n\nThere are numerous users on support mail, who have graphical problems and stability problems.\nAll of them have in common:\n- They either have a new device with Android 6.0 or recently upgraded to Android 6.0\n- In all system informations I do see that HW-acceleration is switched off (`HW acceleration: disabled (manually changed)`)\n- After enabling it, the problems are gone \n##### Expected behavior after performing these steps:\n\nThe users do say that they did not manually change this setting before.\n\nIs there any problem in the code, which may lead to the effect, that it is disabled on Android 6.0?\nIs this setting contained in any (google) backup and might be wrongly restored on a users new device?\n##### Version of c:geo used:\n\n2016.03.06.\n",
    "keywords": [
      "0",
      "6 0",
      "6",
      "android",
      "users",
      "#####",
      "problems"
    ],
    "code": {
      "language": "Java",
      "url": "https://github.com/cgeo/cgeo/commit/f24b8447e944b4eb2d06c61c5e394902bc977bef",
      "files": [
        {
          "file_name": "main/res/values/preference_keys.xml",
          "patch": "@@ -203,6 +203,7 @@\n     \u003cstring name\u003d\"pref_changelog_last_checksum\"\u003echangelog_last_checksum\u003c/string\u003e\n     \u003cstring name\u003d\"pref_caches_history\"\u003ecaches_history\u003c/string\u003e\n     \u003cstring name\u003d\"pref_hardware_acceleration\"\u003ehardware_acceleration2\u003c/string\u003e\n+    \u003cstring name\u003d\"pref_phone_model_and_sdk\"\u003ephone_model_and_sdk\u003c/string\u003e\n     \u003cstring name\u003d\"pref_last_cache_log\"\u003elast_cache_log\u003c/string\u003e\n     \u003cstring name\u003d\"pref_last_trackable_log\"\u003elast_trackable_log\u003c/string\u003e\n     \u003cstring name\u003d\"pref_home_location\"\u003ehome_location\u003c/string\u003e"
        },
        {
          "file_name": "main/src/cgeo/geocaching/settings/Settings.java",
          "patch": "@@ -77,6 +77,8 @@\n             StringUtils.equals(Build.MODEL, \"GT-I9195\")  ||    // Samsung S4 mini\n             StringUtils.equals(Build.MODEL, \"GT-I8200N\");      // Samsung S3 mini\n \n+    private static final String PHONE_MODEL_AND_SDK \u003d Build.MODEL + \"/\" + Build.VERSION.SDK_INT;\n+\n     // twitter api keys\n     private final static @NonNull String TWITTER_KEY_CONSUMER_PUBLIC \u003d CryptUtils.rot13(\"ESnsCvAv3kEupF1GCR3jGj\");\n     private final static @NonNull String TWITTER_KEY_CONSUMER_SECRET \u003d CryptUtils.rot13(\"7vQWceACV9umEjJucmlpFe9FCMZSeqIqfkQ2BnhV9x\");\n@@ -435,9 +437,10 @@ public static void setUseGooglePlayServices(final boolean value) {\n     }\n \n     public static boolean useGooglePlayServices() {\n+        final boolean defaultForPhone \u003d VERSION.SDK_INT \u003e\u003d VERSION_CODES.ICE_CREAM_SANDWICH;\n         // By default, enable play services starting from ICS.\n         return CgeoApplication.getInstance().isGooglePlayServicesAvailable() \u0026\u0026\n-                getBoolean(R.string.pref_googleplayservices, VERSION.SDK_INT \u003e\u003d VERSION_CODES.ICE_CREAM_SANDWICH);\n+                outdatedPhoneModelOrSdk() ? defaultForPhone : getBoolean(R.string.pref_googleplayservices, defaultForPhone);\n     }\n \n     public static boolean useLowPowerMode() {\n@@ -1201,11 +1204,21 @@ public static void addCacheToHistory(@NonNull final String geocode) {\n     }\n \n     public static boolean useHardwareAcceleration() {\n-        return getBoolean(R.string.pref_hardware_acceleration, !HW_ACCEL_DISABLED_BY_DEFAULT);\n+        return outdatedPhoneModelOrSdk() ? !HW_ACCEL_DISABLED_BY_DEFAULT :\n+                getBoolean(R.string.pref_hardware_acceleration, !HW_ACCEL_DISABLED_BY_DEFAULT);\n     }\n \n     static void setUseHardwareAcceleration(final boolean useHardwareAcceleration) {\n         putBoolean(R.string.pref_hardware_acceleration, useHardwareAcceleration);\n+        storePhoneModelAndSdk();\n+    }\n+\n+    static private boolean outdatedPhoneModelOrSdk() {\n+        return !StringUtils.equals(PHONE_MODEL_AND_SDK, getString(R.string.pref_phone_model_and_sdk, null));\n+    }\n+\n+    static private void storePhoneModelAndSdk() {\n+        putString(R.string.pref_phone_model_and_sdk, PHONE_MODEL_AND_SDK);\n     }\n \n     public static String getLastCacheLog() {"
        }
      ]
    }
  },
  {
    "name": "getActiveNotifications() throws an NPE on Android 6.0.1 (mostly Motorola ROMs)",
    "url": "https://github.com/WhisperSystems/Signal-Android/issues/6043",
    "description": "Edited by @2-4601:\r\n\r\nThis issue is about a crash when opening notifications. Most of the affected devices are Motorola\u0027s running Android 6.0.1.\r\n```\r\nE AndroidRuntime: FATAL EXCEPTION: AsyncTask #2\r\nE AndroidRuntime: Process: org.thoughtcrime.securesms, PID: 25021\r\nE AndroidRuntime: java.lang.RuntimeException: An error occurred while executing doInBackground()\r\nE AndroidRuntime: \tat android.os.AsyncTask$3.done(AsyncTask.java:309)\r\nE AndroidRuntime: \tat java.util.concurrent.FutureTask.finishCompletion(FutureTask.java:354)\r\nE AndroidRuntime: \tat java.util.concurrent.FutureTask.setException(FutureTask.java:223)\r\nE AndroidRuntime: \tat java.util.concurrent.FutureTask.run(FutureTask.java:242)\r\nE AndroidRuntime: \tat android.os.AsyncTask$SerialExecutor$1.run(AsyncTask.java:234)\r\nE AndroidRuntime: \tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1113)\r\nE AndroidRuntime: \tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:588)\r\nE AndroidRuntime: \tat java.lang.Thread.run(Thread.java:818)\r\nE AndroidRuntime: Caused by: java.lang.NullPointerException: Attempt to invoke virtual method \u0027java.util.List android.content.pm.ParceledListSlice.getList()\u0027 on a null object reference\r\nE AndroidRuntime: \tat android.app.NotificationManager.getActiveNotifications(NotificationManager.java:683)\r\nE AndroidRuntime: \tat org.thoughtcrime.securesms.notifications.MessageNotifier.cancelActiveNotifications(MessageNotifier.java:133)\r\nE AndroidRuntime: \tat org.thoughtcrime.securesms.notifications.MessageNotifier.updateNotification(MessageNotifier.java:241)\r\nE AndroidRuntime: \tat org.thoughtcrime.securesms.notifications.MessageNotifier.updateNotification(MessageNotifier.java:172)\r\nE AndroidRuntime: \tat org.thoughtcrime.securesms.ConversationActivity$25.doInBackground(ConversationActivity.java:1356)\r\nE AndroidRuntime: \tat org.thoughtcrime.securesms.ConversationActivity$25.doInBackground(ConversationActivity.java:1350)\r\nE AndroidRuntime: \tat android.os.AsyncTask$2.call(AsyncTask.java:295)\r\nE AndroidRuntime: \tat java.util.concurrent.FutureTask.run(FutureTask.java:237)\r\nE AndroidRuntime: \t... 4 more\r\n```\r\n\r\nOriginal issue was about something else that was already fixed in the beta release at the time of reporting. The original issue was turned into this issue from the second comment.\r\nOriginal issue below for posterity:\r\n\r\n\u003e I have:\r\n\u003e - [x] searched open and closed issues for duplicates\r\n\u003e - [x] read https://github.com/WhisperSystems/Signal-Android/wiki/Submitting-useful-bug-reports\r\n\u003e \r\n\u003e ----------------------------------------\r\n\u003e \r\n\u003e ### Bug description\r\n\u003e App crashes.\r\n\u003e \r\n\u003e ### Steps to reproduce\r\n\u003e Unable to reproduce. This happened twice within a short timespan as I was using the app. Strangely, the action I was performing at the time (1st crash: sending a photo captured within Signal to a group conversation, 2nd crash: responding to a text message to a single contact) was successful both times, even though the app reported that it crashed.\r\n\u003e \r\n\u003e **Actual result:** App crashes and has to be relaunched.\r\n\u003e **Expected result:** App should not crash, messages should be sent.\r\n\u003e \r\n\u003e ### Device info\r\n\u003e **Device:** Samsung Galaxy S5 Neo\r\n\u003e **Android version:** 6.0.1\r\n\u003e **Signal version:** 3.25.4\r\n\u003e \r\n\u003e ### Link to debug log\r\n\u003e 1st crash: https://gist.github.com/cec3a81959ce454cce66fab9da1644db\r\n\u003e 2nd crash: https://gist.github.com/a2cddcbc9aeb725918025e7b14e0e991\r\n\u003e \r\n\u003e PS: I also submitted the Google app crash report thing, not sure if that\u0027s useful to the OWS crowd.",
    "keywords": [
      "threadpoolexecutor",
      "###",
      "asynctask",
      "java util",
      "android",
      "concurrent",
      "run",
      "crash",
      "futuretask",
      "java",
      "util concurrent",
      "\u003e ###",
      "lang",
      "\u003e \u003e",
      "app",
      "original",
      "issue",
      "os",
      "org",
      "messagenotifier",
      "e",
      "org thoughtcrime",
      "concurrent futuretask",
      "androidruntime",
      "0",
      "1",
      "doinbackground",
      "util",
      "6",
      "securesms",
      "e androidruntime",
      "thoughtcrime",
      "notifications",
      "\u003e"
    ],
    "code": {
      "language": "Java",
      "url": "https://github.com/WhisperSystems/Signal-Android/commit/360c2b2a5090b0be87dd8a03245e5f198305c590",
      "files": [
        {
          "file_name": "src/org/thoughtcrime/securesms/notifications/MessageNotifier.java",
          "patch": "@@ -130,36 +130,47 @@ private static void cancelActiveNotifications(@NonNull Context context) {\n     notifications.cancel(SUMMARY_NOTIFICATION_ID);\n \n     if (Build.VERSION.SDK_INT \u003e\u003d 23) {\n-      StatusBarNotification[] activeNotifications \u003d notifications.getActiveNotifications();\n+      try {\n+        StatusBarNotification[] activeNotifications \u003d notifications.getActiveNotifications();\n \n-      for (StatusBarNotification activeNotification : activeNotifications) {\n-        if (activeNotification.getId() !\u003d NotificationBarManager.RED_PHONE_NOTIFICATION) {\n-          notifications.cancel(activeNotification.getId());\n+        for (StatusBarNotification activeNotification : activeNotifications) {\n+          if (activeNotification.getId() !\u003d NotificationBarManager.RED_PHONE_NOTIFICATION) {\n+            notifications.cancel(activeNotification.getId());\n+          }\n         }\n+      } catch (Throwable e) {\n+        // XXX Appears to be a ROM bug, see #6043\n+        Log.w(TAG, e);\n+        notifications.cancelAll();\n       }\n     }\n   }\n \n   private static void cancelOrphanedNotifications(@NonNull Context context, NotificationState notificationState) {\n     if (Build.VERSION.SDK_INT \u003e\u003d 23) {\n-      NotificationManager     notifications       \u003d ServiceUtil.getNotificationManager(context);\n-      StatusBarNotification[] activeNotifications \u003d notifications.getActiveNotifications();\n-\n-      for (StatusBarNotification notification : activeNotifications) {\n-        boolean validNotification \u003d false;\n-\n-        if (notification.getId() !\u003d SUMMARY_NOTIFICATION_ID \u0026\u0026 notification.getId() !\u003d NotificationBarManager.RED_PHONE_NOTIFICATION) {\n-          for (NotificationItem item : notificationState.getNotifications()) {\n-            if (notification.getId() \u003d\u003d (SUMMARY_NOTIFICATION_ID + item.getThreadId())) {\n-              validNotification \u003d true;\n-              break;\n+      try {\n+        NotificationManager     notifications       \u003d ServiceUtil.getNotificationManager(context);\n+        StatusBarNotification[] activeNotifications \u003d notifications.getActiveNotifications();\n+\n+        for (StatusBarNotification notification : activeNotifications) {\n+          boolean validNotification \u003d false;\n+\n+          if (notification.getId() !\u003d SUMMARY_NOTIFICATION_ID \u0026\u0026 notification.getId() !\u003d NotificationBarManager.RED_PHONE_NOTIFICATION) {\n+            for (NotificationItem item : notificationState.getNotifications()) {\n+              if (notification.getId() \u003d\u003d (SUMMARY_NOTIFICATION_ID + item.getThreadId())) {\n+                validNotification \u003d true;\n+                break;\n+              }\n             }\n-          }\n \n-          if (!validNotification) {\n-            notifications.cancel(notification.getId());\n+            if (!validNotification) {\n+              notifications.cancel(notification.getId());\n+            }\n           }\n         }\n+      } catch (Throwable e) {\n+        // XXX Android ROM Bug, see #6043\n+        Log.w(TAG, e);\n       }\n     }\n   }"
        }
      ]
    }
  },
  {
    "name": "Cannot store images on Android 6",
    "url": "https://github.com/QuantumBadger/RedReader/issues/297",
    "description": "Permissions went through a makeover in Android 6. I now run cm13 (6.0), and I can no longer store images.\n\nI can still do with opening via my web browser and manually downloading the image, but would be nice to get this fixed.\n\nNo need to paste the logcat here - it\u0027s just an `open failed: EACCESS (Permission denied)` error. You probably have to make sure to request the permission at runtime on top of declaring it in your manifest.\n\nThis should be very easy to reproduce on a 6.0 emulator. Otherwise, I can test debug builds.\n",
    "keywords": [
      "can",
      "6"
    ],
    "code": {
      "language": "Java",
      "url": "https://github.com/QuantumBadger/RedReader/commit/375b4526022ba869b1a0d4f8ce280847e00439c8",
      "files": [
        {
          "file_name": "assets/changelog.txt",
          "patch": "@@ -2,6 +2,7 @@\n Material Design\n Imgur upload support\n Experimental Tor support (thanks to SpotComms)\n+Fixed image saving on Android Marshmallow\n \n 70/1.9.3.4\n Fixed album swiping"
        },
        {
          "file_name": "src/main/java/org/quantumbadger/redreader/activities/BaseActivity.java",
          "patch": "@@ -21,14 +21,21 @@\n import android.content.DialogInterface;\n import android.content.SharedPreferences;\n import android.content.pm.ActivityInfo;\n+import android.content.pm.PackageManager;\n+import android.os.Build;\n import android.os.Bundle;\n import android.preference.PreferenceManager;\n+import android.support.annotation.NonNull;\n import android.support.v7.app.AppCompatActivity;\n+import info.guardianproject.netcipher.proxy.OrbotHelper;\n import org.quantumbadger.redreader.R;\n import org.quantumbadger.redreader.cache.CacheDownload;\n+import org.quantumbadger.redreader.common.General;\n import org.quantumbadger.redreader.common.PrefsUtility;\n import org.quantumbadger.redreader.http.okhttp.OKHTTPBackend;\n-import info.guardianproject.netcipher.proxy.OrbotHelper;\n+\n+import java.util.HashMap;\n+import java.util.concurrent.atomic.AtomicInteger;\n \n public class BaseActivity extends AppCompatActivity implements SharedPreferences.OnSharedPreferenceChangeListener {\n \n@@ -37,6 +44,14 @@\n \n \tprivate static boolean closingAll \u003d false;\n \n+\tprivate final AtomicInteger mPermissionRequestIdGenerator \u003d new AtomicInteger();\n+\tprivate final HashMap\u003cInteger, PermissionCallback\u003e mPermissionRequestCallbacks \u003d new HashMap\u003c\u003e();\n+\n+\tpublic interface PermissionCallback {\n+\t\tvoid onPermissionGranted();\n+\t\tvoid onPermissionDenied();\n+\t}\n+\n \tpublic void closeAllExceptMain() {\n \t\tclosingAll \u003d true;\n \t\tcloseIfNecessary();\n@@ -77,6 +92,49 @@ private void closeIfNecessary() {\n \t\t}\n \t}\n \n+\tpublic void requestPermissionWithCallback(\n+\t\t\t\t@NonNull final String permission,\n+\t\t\t\t@NonNull final PermissionCallback callback) {\n+\n+\t\tGeneral.checkThisIsUIThread();\n+\n+\t\tif(Build.VERSION.SDK_INT \u003e\u003d Build.VERSION_CODES.M) {\n+\n+\t\t\tif(checkSelfPermission(permission) \u003d\u003d PackageManager.PERMISSION_GRANTED) {\n+\t\t\t\tcallback.onPermissionGranted();\n+\n+\t\t\t} else {\n+\t\t\t\tfinal int requestCode \u003d mPermissionRequestIdGenerator.incrementAndGet();\n+\t\t\t\tmPermissionRequestCallbacks.put(requestCode, callback);\n+\t\t\t\trequestPermissions(new String[]{permission}, requestCode);\n+\t\t\t}\n+\n+\t\t} else {\n+\t\t\tcallback.onPermissionGranted();\n+\t\t}\n+\t}\n+\n+\t@Override\n+\tpublic void onRequestPermissionsResult(\n+\t\t\tfinal int requestCode,\n+\t\t\t@NonNull final String[] permissions,\n+\t\t\t@NonNull final int[] grantResults) {\n+\n+\t\tfinal PermissionCallback callback \u003d mPermissionRequestCallbacks.remove(requestCode);\n+\n+\t\tif(callback !\u003d null) {\n+\t\t\tif(permissions.length !\u003d 1) {\n+\t\t\t\tthrow new RuntimeException(\"Unexpected permission result\");\n+\t\t\t}\n+\n+\t\t\tif(grantResults[0] \u003d\u003d PackageManager.PERMISSION_GRANTED) {\n+\t\t\t\tcallback.onPermissionGranted();\n+\t\t\t} else {\n+\t\t\t\tcallback.onPermissionDenied();\n+\t\t\t}\n+\t\t}\n+\t}\n+\n \tprivate void setOrientationFromPrefs() {\n \t\tPrefsUtility.ScreenOrientation orientation \u003d PrefsUtility.pref_behaviour_screen_orientation(this, sharedPreferences);\n \t\tif (orientation \u003d\u003d PrefsUtility.ScreenOrientation.AUTO)"
        },
        {
          "file_name": "src/main/java/org/quantumbadger/redreader/reddit/prepared/RedditPreparedPost.java",
          "patch": "@@ -17,6 +17,7 @@\n \n package org.quantumbadger.redreader.reddit.prepared;\n \n+import android.Manifest;\n import android.app.AlertDialog;\n import android.content.Context;\n import android.content.DialogInterface;\n@@ -36,11 +37,11 @@\n import android.view.View;\n import android.widget.ImageButton;\n import android.widget.Toast;\n-\n import org.apache.commons.lang3.StringEscapeUtils;\n import org.quantumbadger.redreader.R;\n import org.quantumbadger.redreader.account.RedditAccount;\n import org.quantumbadger.redreader.account.RedditAccountManager;\n+import org.quantumbadger.redreader.activities.BaseActivity;\n import org.quantumbadger.redreader.activities.BugReportActivity;\n import org.quantumbadger.redreader.activities.CommentReplyActivity;\n import org.quantumbadger.redreader.activities.MainActivity;\n@@ -333,89 +334,117 @@ public void onClick(DialogInterface dialog, int which) {\n \n \t\t\tcase SAVE_IMAGE: {\n \n-\t\t\t\tfinal RedditAccount anon \u003d RedditAccountManager.getAnon();\n-\n-\t\t\t\tLinkHandler.getImageInfo(activity, post.src.getUrl(), Constants.Priority.IMAGE_VIEW, 0, new GetImageInfoListener() {\n-\n-\t\t\t\t\t@Override\n-\t\t\t\t\tpublic void onFailure(final @CacheRequest.RequestFailureType int type, final Throwable t, final Integer status, final String readableMessage) {\n-\t\t\t\t\t\tfinal RRError error \u003d General.getGeneralErrorForFailure(activity, type, t, status, post.src.getUrl());\n-\t\t\t\t\t\tGeneral.showResultDialog(activity, error);\n-\t\t\t\t\t}\n-\n+\t\t\t\t((BaseActivity)activity).requestPermissionWithCallback(Manifest.permission.WRITE_EXTERNAL_STORAGE, new BaseActivity.PermissionCallback() {\n \t\t\t\t\t@Override\n-\t\t\t\t\tpublic void onSuccess(final ImageInfo info) {\n-\n-\t\t\t\t\t\tCacheManager.getInstance(activity).makeRequest(new CacheRequest(General.uriFromString(info.urlOriginal), anon, null,\n-\t\t\t\t\t\t\t\tConstants.Priority.IMAGE_VIEW, 0, CacheRequest.DOWNLOAD_IF_NECESSARY,\n-\t\t\t\t\t\t\t\tConstants.FileType.IMAGE, CacheRequest.DOWNLOAD_QUEUE_IMMEDIATE, false, false, activity) {\n-\n-\t\t\t\t\t\t\t@Override\n-\t\t\t\t\t\t\tprotected void onCallbackException(Throwable t) {\n-\t\t\t\t\t\t\t\tBugReportActivity.handleGlobalError(context, t);\n-\t\t\t\t\t\t\t}\n+\t\t\t\t\tpublic void onPermissionGranted() {\n \n-\t\t\t\t\t\t\t@Override\n-\t\t\t\t\t\t\tprotected void onDownloadNecessary() {\n-\t\t\t\t\t\t\t\tGeneral.quickToast(context, R.string.download_downloading);\n-\t\t\t\t\t\t\t}\n+\t\t\t\t\t\tfinal RedditAccount anon \u003d RedditAccountManager.getAnon();\n \n-\t\t\t\t\t\t\t@Override\n-\t\t\t\t\t\t\tprotected void onDownloadStarted() {\n-\t\t\t\t\t\t\t}\n+\t\t\t\t\t\tLinkHandler.getImageInfo(activity, post.src.getUrl(), Constants.Priority.IMAGE_VIEW, 0, new GetImageInfoListener() {\n \n \t\t\t\t\t\t\t@Override\n-\t\t\t\t\t\t\tprotected void onFailure(@CacheRequest.RequestFailureType int type, Throwable t, Integer status, String readableMessage) {\n-\t\t\t\t\t\t\t\tfinal RRError error \u003d General.getGeneralErrorForFailure(context, type, t, status, url.toString());\n+\t\t\t\t\t\t\tpublic void onFailure(final @CacheRequest.RequestFailureType int type, final Throwable t, final Integer status, final String readableMessage) {\n+\t\t\t\t\t\t\t\tfinal RRError error \u003d General.getGeneralErrorForFailure(activity, type, t, status, post.src.getUrl());\n \t\t\t\t\t\t\t\tGeneral.showResultDialog(activity, error);\n \t\t\t\t\t\t\t}\n \n \t\t\t\t\t\t\t@Override\n-\t\t\t\t\t\t\tprotected void onProgress(boolean authorizationInProgress, long bytesRead, long totalBytes) {\n-\t\t\t\t\t\t\t}\n-\n-\t\t\t\t\t\t\t@Override\n-\t\t\t\t\t\t\tprotected void onSuccess(CacheManager.ReadableCacheFile cacheFile, long timestamp, UUID session, boolean fromCache, String mimetype) {\n+\t\t\t\t\t\t\tpublic void onSuccess(final ImageInfo info) {\n \n-\t\t\t\t\t\t\t\tFile dst \u003d new File(Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_PICTURES), General.uriFromString(info.urlOriginal).getPath());\n+\t\t\t\t\t\t\t\tCacheManager.getInstance(activity).makeRequest(new CacheRequest(General.uriFromString(info.urlOriginal), anon, null,\n+\t\t\t\t\t\t\t\t\tConstants.Priority.IMAGE_VIEW, 0, CacheRequest.DOWNLOAD_IF_NECESSARY,\n+\t\t\t\t\t\t\t\t\tConstants.FileType.IMAGE, CacheRequest.DOWNLOAD_QUEUE_IMMEDIATE, false, false, activity) {\n \n-\t\t\t\t\t\t\t\tif(dst.exists()) {\n-\t\t\t\t\t\t\t\t\tint count \u003d 0;\n+\t\t\t\t\t\t\t\t\t@Override\n+\t\t\t\t\t\t\t\t\tprotected void onCallbackException(Throwable t) {\n+\t\t\t\t\t\t\t\t\t\tBugReportActivity.handleGlobalError(context, t);\n+\t\t\t\t\t\t\t\t\t}\n \n-\t\t\t\t\t\t\t\t\twhile(dst.exists()) {\n-\t\t\t\t\t\t\t\t\t\tcount++;\n-\t\t\t\t\t\t\t\t\t\tdst \u003d new File(Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_PICTURES), count + \"_\" + General.uriFromString(info.urlOriginal).getPath().substring(1));\n+\t\t\t\t\t\t\t\t\t@Override\n+\t\t\t\t\t\t\t\t\tprotected void onDownloadNecessary() {\n+\t\t\t\t\t\t\t\t\t\tGeneral.quickToast(context, R.string.download_downloading);\n \t\t\t\t\t\t\t\t\t}\n-\t\t\t\t\t\t\t\t}\n \n-\t\t\t\t\t\t\t\ttry {\n-\t\t\t\t\t\t\t\t\tfinal InputStream cacheFileInputStream \u003d cacheFile.getInputStream();\n+\t\t\t\t\t\t\t\t\t@Override\n+\t\t\t\t\t\t\t\t\tprotected void onDownloadStarted() {\n+\t\t\t\t\t\t\t\t\t}\n \n-\t\t\t\t\t\t\t\t\tif(cacheFileInputStream \u003d\u003d null) {\n-\t\t\t\t\t\t\t\t\t\tnotifyFailure(CacheRequest.REQUEST_FAILURE_CACHE_MISS, null, null, \"Could not find cached image\");\n-\t\t\t\t\t\t\t\t\t\treturn;\n+\t\t\t\t\t\t\t\t\t@Override\n+\t\t\t\t\t\t\t\t\tprotected void onFailure(\n+\t\t\t\t\t\t\t\t\t\t\t\t@CacheRequest.RequestFailureType int type,\n+\t\t\t\t\t\t\t\t\t\t\t\tThrowable t,\n+\t\t\t\t\t\t\t\t\t\t\t\tInteger status,\n+\t\t\t\t\t\t\t\t\t\t\t\tString readableMessage) {\n+\n+\t\t\t\t\t\t\t\t\t\tfinal RRError error \u003d General.getGeneralErrorForFailure(context, type, t, status, url.toString());\n+\t\t\t\t\t\t\t\t\t\tGeneral.showResultDialog(activity, error);\n \t\t\t\t\t\t\t\t\t}\n \n-\t\t\t\t\t\t\t\t\tGeneral.copyFile(cacheFileInputStream, dst);\n+\t\t\t\t\t\t\t\t\t@Override\n+\t\t\t\t\t\t\t\t\tprotected void onProgress(\n+\t\t\t\t\t\t\t\t\t\t\tboolean authorizationInProgress,\n+\t\t\t\t\t\t\t\t\t\t\tlong bytesRead,\n+\t\t\t\t\t\t\t\t\t\t\tlong totalBytes) {\n+\t\t\t\t\t\t\t\t\t}\n \n-\t\t\t\t\t\t\t\t} catch(IOException e) {\n-\t\t\t\t\t\t\t\t\tnotifyFailure(CacheRequest.REQUEST_FAILURE_STORAGE, e, null, \"Could not copy file\");\n-\t\t\t\t\t\t\t\t\treturn;\n-\t\t\t\t\t\t\t\t}\n+\t\t\t\t\t\t\t\t\t@Override\n+\t\t\t\t\t\t\t\t\tprotected void onSuccess(\n+\t\t\t\t\t\t\t\t\t\t\tCacheManager.ReadableCacheFile cacheFile,\n+\t\t\t\t\t\t\t\t\t\t\tlong timestamp,\n+\t\t\t\t\t\t\t\t\t\t\tUUID session,\n+\t\t\t\t\t\t\t\t\t\t\tboolean fromCache,\n+\t\t\t\t\t\t\t\t\t\t\tString mimetype) {\n+\n+\t\t\t\t\t\t\t\t\t\tFile dst \u003d new File(\n+\t\t\t\t\t\t\t\t\t\t\tEnvironment.getExternalStoragePublicDirectory(Environment.DIRECTORY_PICTURES),\n+\t\t\t\t\t\t\t\t\t\t\tGeneral.uriFromString(info.urlOriginal).getPath());\n+\n+\t\t\t\t\t\t\t\t\t\tif(dst.exists()) {\n+\t\t\t\t\t\t\t\t\t\t\tint count \u003d 0;\n+\n+\t\t\t\t\t\t\t\t\t\t\twhile(dst.exists()) {\n+\t\t\t\t\t\t\t\t\t\t\t\tcount++;\n+\t\t\t\t\t\t\t\t\t\t\t\tdst \u003d new File(\n+\t\t\t\t\t\t\t\t\t\t\t\t\tEnvironment.getExternalStoragePublicDirectory(Environment.DIRECTORY_PICTURES),\n+\t\t\t\t\t\t\t\t\t\t\t\t\tcount + \"_\" + General.uriFromString(info.urlOriginal).getPath().substring(1));\n+\t\t\t\t\t\t\t\t\t\t\t}\n+\t\t\t\t\t\t\t\t\t\t}\n+\n+\t\t\t\t\t\t\t\t\t\ttry {\n+\t\t\t\t\t\t\t\t\t\t\tfinal InputStream cacheFileInputStream \u003d cacheFile.getInputStream();\n+\n+\t\t\t\t\t\t\t\t\t\t\tif(cacheFileInputStream \u003d\u003d null) {\n+\t\t\t\t\t\t\t\t\t\t\t\tnotifyFailure(CacheRequest.REQUEST_FAILURE_CACHE_MISS, null, null, \"Could not find cached image\");\n+\t\t\t\t\t\t\t\t\t\t\t\treturn;\n+\t\t\t\t\t\t\t\t\t\t\t}\n+\n+\t\t\t\t\t\t\t\t\t\t\tGeneral.copyFile(cacheFileInputStream, dst);\n+\n+\t\t\t\t\t\t\t\t\t\t} catch(IOException e) {\n+\t\t\t\t\t\t\t\t\t\t\tnotifyFailure(CacheRequest.REQUEST_FAILURE_STORAGE, e, null, \"Could not copy file\");\n+\t\t\t\t\t\t\t\t\t\t\treturn;\n+\t\t\t\t\t\t\t\t\t\t}\n+\n+\t\t\t\t\t\t\t\t\t\tactivity.sendBroadcast(new Intent(Intent.ACTION_MEDIA_SCANNER_SCAN_FILE,\n+\t\t\t\t\t\t\t\t\t\t\tUri.parse(\"file://\" + dst.getAbsolutePath()))\n+\t\t\t\t\t\t\t\t\t\t);\n+\n+\t\t\t\t\t\t\t\t\t\tGeneral.quickToast(context, context.getString(R.string.action_save_image_success) + \" \" + dst.getAbsolutePath());\n+\t\t\t\t\t\t\t\t\t}\n+\t\t\t\t\t\t\t\t});\n \n-\t\t\t\t\t\t\t\tactivity.sendBroadcast(new Intent(Intent.ACTION_MEDIA_SCANNER_SCAN_FILE,\n-\t\t\t\t\t\t\t\t\t\t\t\tUri.parse(\"file://\" + dst.getAbsolutePath()))\n-\t\t\t\t\t\t\t\t);\n+\t\t\t\t\t\t\t}\n \n-\t\t\t\t\t\t\t\tGeneral.quickToast(context, context.getString(R.string.action_save_image_success) + \" \" + dst.getAbsolutePath());\n+\t\t\t\t\t\t\t@Override\n+\t\t\t\t\t\t\tpublic void onNotAnImage() {\n+\t\t\t\t\t\t\t\tGeneral.quickToast(activity, R.string.selected_link_is_not_image);\n \t\t\t\t\t\t\t}\n \t\t\t\t\t\t});\n-\n \t\t\t\t\t}\n \n \t\t\t\t\t@Override\n-\t\t\t\t\tpublic void onNotAnImage() {\n-\t\t\t\t\t\tGeneral.quickToast(activity, R.string.selected_link_is_not_image);\n+\t\t\t\t\tpublic void onPermissionDenied() {\n+\t\t\t\t\t\tGeneral.quickToast(activity, R.string.save_image_permission_denied);\n \t\t\t\t\t}\n \t\t\t\t});\n "
        },
        {
          "file_name": "src/main/res/values/strings.xml",
          "patch": "@@ -792,4 +792,7 @@\n \t\u003cstring name\u003d\"submit_post_self_text_hint\"\u003eSelf Text\u003c/string\u003e\n \t\u003cstring name\u003d\"submit_post_url_hint\"\u003eURL\u003c/string\u003e\n \n+\t\u003c!-- 2016-06-24 --\u003e\n+\t\u003cstring name\u003d\"save_image_permission_denied\"\u003ePermission denied: could not save image.\u003c/string\u003e\n+\n \u003c/resources\u003e"
        }
      ]
    }
  },
  {
    "name": "Unintentional check for READ_CONTACTS on Android 6",
    "url": "https://github.com/pinetum/AirUnlock-for-Android/issues/5",
    "description": "Hello, I\u0027m Denis Bogdanas, a research assistant at Oregon Stat University.\r\nI\u0027m working on a tool that automatically introduces runtime permission checks and requests for Android 6 apps. As part of this study I analyzed this app, looking for how permissions are referred in the code.\r\n\r\nIt looks like the method SimpleScannerActivity.onCreate() checks for permission READ_CONTACTS but requests CAMERA. This seems like a programming error. As a result permission request screen will be shown every time the app executes that code, even if permission CAMERA is already granted. This likely degrades user experience.\r\n\r\nWould you be interested to fix this issue?\r\n\r\nbest regards,\r\nDenis",
    "keywords": [
      "permission"
    ],
    "code": {
      "language": "Java",
      "url": "https://github.com/pinetum/AirUnlock-for-Android/commit/7bba46c8bfbce005b0f30062ec7bdb735db8bc6c",
      "files": [
        {
          "file_name": "Application/src/main/java/tw/qtlin/mac/airunlocker/SimpleScannerActivity.java",
          "patch": "@@ -42,7 +42,7 @@ public void onCreate(Bundle state) {\n \n \n         if (ContextCompat.checkSelfPermission(this,\n-                Manifest.permission.READ_CONTACTS)\n+                Manifest.permission.CAMERA)\n                 !\u003d PackageManager.PERMISSION_GRANTED) {\n \n "
        }
      ]
    }
  },
  {
    "name": "DialogPreference message doesn\u0027t show in Android version 6.0 (API 23)",
    "url": "https://github.com/Neamar/KISS/issues/575",
    "description": "The message of Dialog Preferences on the Settings Activity don\u0027t show up.\r\n\r\nExample of what happens with the option \u0027Restart KISS\u0027, under \u0027Advanced Settings\u0027.\r\n\r\n![](http://i.imgur.com/PfXTogu.png)\r\n\r\nHere are the logs from Android Studio:\r\n\r\n![](http://i.imgur.com/nstlnXN.png)\r\n\r\nOnly tested this with an Android emulator. Not sure how often this happens on real devices or if it\u0027s just an emulator problem.\r\n\r\nAndroid versions 4.2, 4.4 (API 19) and 5.1 (API 22) didn\u0027t have this problem.",
    "keywords": [
      "4",
      "android",
      "api"
    ],
    "code": {
      "language": "Java",
      "url": "https://github.com/Neamar/KISS/commit/6bfaf0277da5940fc2378206bed31652508edfaa",
      "files": [
        {
          "file_name": "app/src/main/res/values-v21/themes.xml",
          "patch": "@@ -7,6 +7,7 @@\n         \u003citem name\u003d\"android:colorAccent\"\u003e@color/kiss_green\u003c/item\u003e\n         \u003citem name\u003d\"android:navigationBarColor\"\u003e@android:color/transparent\u003c/item\u003e\n         \u003citem name\u003d\"appSelectableItemBackground\"\u003e?android:attr/selectableItemBackgroundBorderless\u003c/item\u003e\n+        \u003citem name\u003d\"android:alertDialogTheme\"\u003e@android:style/Theme.Material.Light.Dialog.Alert\u003c/item\u003e\n     \u003c/style\u003e\n \n     \u003cstyle name\u003d\"BaseThemeDark\" parent\u003d\"@android:style/Theme.Material.NoActionBar\"\u003e"
        }
      ]
    }
  },
  {
    "name": "I see black strip on my Nexus 5 Android 6 ",
    "url": "https://github.com/mesmotronic/air-ane-fullscreen/issues/24",
    "description": "If I run an application from shortcut on desktop or from app list - black strip appears. If I run it from google search bar - it works. It also works well when launched remotely using adb after compilation in IDEA.\n",
    "keywords": [],
    "code": {
      "language": "Java",
      "url": "https://github.com/mesmotronic/air-ane-fullscreen/commit/2eb4b586c17772ef1a13a6bb5e3d5df700d490a5",
      "files": [
        {
          "file_name": "README.md",
          "patch": "@@ -10,7 +10,7 @@ Released under BSD license. Requires Adobe AIR 17+.\n Just give me the ANE!\n ---------------------\n \n-If you don\u0027t care about the source code and just want to download the latest, ready-built ANE, click the [releases link](https://github.com/mesmotronic/air-fullscreen-ane/releases) at the top of this project\u0027s page on GitHub.\n+If you don\u0027t care about the source code and just want to download the latest, ready-built ANE, click the [releases link](https://github.com/mesmotronic/air-ane-fullscreen/releases) at the top of this project\u0027s page on GitHub.\n \n How does it work?\n -----------------"
        },
        {
          "file_name": "build/AndroidFullScreen.ane"
        },
        {
          "file_name": "build/android/fullscreen-ane-jar.jar"
        },
        {
          "file_name": "build/build.cmd",
          "patch": "@@ -1,6 +1,6 @@\n @echo off\n \n-copy ..\\android-jar\\bin\\fullscreen-ane-jar.jar android\n+copy ..\\jar-android\\bin\\fullscreen-ane-jar.jar android\n \n call adt ^\n  -package ^"
        },
        {
          "file_name": "example-flex/src/AndroidFullScreenTest-app.xml",
          "patch": "@@ -1,5 +1,5 @@\n \u003c?xml version\u003d\"1.0\" encoding\u003d\"utf-8\" standalone\u003d\"no\"?\u003e\n-\u003capplication xmlns\u003d\"http://ns.adobe.com/air/application/17.0\"\u003e\n+\u003capplication xmlns\u003d\"http://ns.adobe.com/air/application/19.0\"\u003e\n \n \t\u003cid\u003ecom.mesmotronic.ane.fullscreen.test\u003c/id\u003e\n \n@@ -13,7 +13,7 @@\n \t\t\u003cfullScreen\u003efalse\u003c/fullScreen\u003e\n \t\t\u003cvisible\u003etrue\u003c/visible\u003e\n \t\t\u003csoftKeyboardBehavior\u003enone\u003c/softKeyboardBehavior\u003e\n-\t\t\u003crenderMode\u003egpu\u003c/renderMode\u003e\n+\t\t\u003crenderMode\u003edirect\u003c/renderMode\u003e\n     \u003c/initialWindow\u003e\n \t\n \t\u003candroid\u003e"
        },
        {
          "file_name": "jar-android/.classpath"
        },
        {
          "file_name": "jar-android/.gitignore"
        },
        {
          "file_name": "jar-android/.project"
        },
        {
          "file_name": "jar-android/AndroidManifest.xml",
          "patch": "@@ -1,13 +1,13 @@\n \u003cmanifest \n     xmlns:android\u003d\"http://schemas.android.com/apk/res/android\"\n     package\u003d\"com.mesmotronic.ane.fullscreen\"\n-    android:versionCode\u003d\"1\"\n-    android:versionName\u003d\"1.0\" \n+    android:versionCode\u003d\"140\"\n+    android:versionName\u003d\"1.4.0\" \n     \u003e\n \t\n     \u003cuses-sdk\n         android:minSdkVersion\u003d\"16\"\n-        android:targetSdkVersion\u003d\"17\"\n+        android:targetSdkVersion\u003d\"23\"\n         /\u003e\n \n     \u003capplication /\u003e"
        },
        {
          "file_name": "jar-android/libs/android-support-v4.jar"
        },
        {
          "file_name": "jar-android/project.properties",
          "patch": "@@ -11,5 +11,5 @@\n #proguard.config\u003d${sdk.dir}/tools/proguard/proguard-android.txt:proguard-project.txt\n \n # Project target.\n-target\u003dandroid-22\n+target\u003dandroid-23\n android.library\u003dtrue"
        },
        {
          "file_name": "jar-android/src/com/mesmotronic/ane/fullscreen/FullScreenContext.java",
          "patch": "@@ -39,6 +39,7 @@\n import android.view.Menu;\n import android.view.MenuItem;\n import android.view.MotionEvent;\n+import android.view.SearchEvent;\n import android.view.View;\n import android.view.View.OnFocusChangeListener;\n import android.view.Window;\n@@ -99,6 +100,12 @@ public Window getWindow()\n \t\t\t_windowCallback \u003d new Window.Callback()\n \t\t\t{\n \t\t\t\t@Override\n+\t\t\t\tpublic ActionMode onWindowStartingActionMode(Callback callback, int i)\n+\t\t\t\t{\n+\t\t\t\t\treturn windowCallback.onWindowStartingActionMode(callback, i);\n+\t\t\t\t}\n+\t\t\t\t\n+\t\t\t\t@Override\n \t\t\t\tpublic ActionMode onWindowStartingActionMode(Callback callback) \n \t\t\t\t{\n \t\t\t\t\treturn windowCallback.onWindowStartingActionMode(callback);\n@@ -123,6 +130,12 @@ public void onWindowAttributesChanged(LayoutParams attrs)\n \t\t\t\t}\n \t\t\t\t\n \t\t\t\t@Override\n+\t\t\t\tpublic boolean onSearchRequested(SearchEvent event) \n+\t\t\t\t{\n+\t\t\t\t\treturn windowCallback.onSearchRequested(event);\n+\t\t\t\t}\n+\t\t\t\t\n+\t\t\t\t@Override\n \t\t\t\tpublic boolean onSearchRequested() \n \t\t\t\t{\n \t\t\t\t\treturn windowCallback.onSearchRequested();"
        },
        {
          "file_name": "jar-android/src/com/mesmotronic/ane/fullscreen/FullScreenExtension.java"
        },
        {
          "file_name": "jar-android/src/com/mesmotronic/ane/fullscreen/functions/ImmersiveHeightFunction.java"
        },
        {
          "file_name": "jar-android/src/com/mesmotronic/ane/fullscreen/functions/ImmersiveModeFunction.java",
          "patch": "@@ -36,6 +36,7 @@\n import android.view.Menu;\n import android.view.MenuItem;\n import android.view.MotionEvent;\n+import android.view.SearchEvent;\n import android.view.View;\n import android.view.WindowManager;\n import android.view.ActionMode.Callback;\n@@ -120,6 +121,12 @@ public void onSystemUiVisibilityChange(int visibility)\n \t\t\t\twindow.setCallback(new Window.Callback()\n \t\t\t\t{\n \t\t\t\t\t@Override\n+\t\t\t\t\tpublic ActionMode onWindowStartingActionMode(Callback callback, int i)\n+\t\t\t\t\t{\n+\t\t\t\t\t\treturn windowCallback.onWindowStartingActionMode(callback, i);\n+\t\t\t\t\t}\n+\t\t\t\t\t\n+\t\t\t\t\t@Override\n \t\t\t\t\tpublic ActionMode onWindowStartingActionMode(Callback callback) \n \t\t\t\t\t{\n \t\t\t\t\t\treturn windowCallback.onWindowStartingActionMode(callback);\n@@ -143,6 +150,12 @@ public void onWindowAttributesChanged(LayoutParams attrs)\n \t\t\t\t\t}\n \t\t\t\t\t\n \t\t\t\t\t@Override\n+\t\t\t\t\tpublic boolean onSearchRequested(SearchEvent event) \n+\t\t\t\t\t{\n+\t\t\t\t\t\treturn windowCallback.onSearchRequested(event);\n+\t\t\t\t\t}\n+\t\t\t\t\t\n+\t\t\t\t\t@Override\n \t\t\t\t\tpublic boolean onSearchRequested() \n \t\t\t\t\t{\n \t\t\t\t\t\treturn windowCallback.onSearchRequested();"
        },
        {
          "file_name": "jar-android/src/com/mesmotronic/ane/fullscreen/functions/ImmersiveWidthFunction.java"
        },
        {
          "file_name": "jar-android/src/com/mesmotronic/ane/fullscreen/functions/InitFunction.java"
        },
        {
          "file_name": "jar-android/src/com/mesmotronic/ane/fullscreen/functions/IsImmersiveModeSupportedFunction.java"
        },
        {
          "file_name": "jar-android/src/com/mesmotronic/ane/fullscreen/functions/LeanModeFunction.java"
        },
        {
          "file_name": "jar-android/src/com/mesmotronic/ane/fullscreen/functions/ShowSystemUiFunction.java"
        },
        {
          "file_name": "jar-android/src/com/mesmotronic/ane/fullscreen/functions/ShowUnderSystemUiFunction.java"
        },
        {
          "file_name": "swc-android/.actionScriptProperties"
        },
        {
          "file_name": "swc-android/.flexLibProperties"
        },
        {
          "file_name": "swc-android/.gitignore"
        },
        {
          "file_name": "swc-android/.project"
        },
        {
          "file_name": "swc-android/src/com/mesmotronic/ane/AndroidFullScreen.as"
        },
        {
          "file_name": "swc-default/.actionScriptProperties"
        },
        {
          "file_name": "swc-default/.flexLibProperties"
        },
        {
          "file_name": "swc-default/.gitignore"
        },
        {
          "file_name": "swc-default/.project"
        },
        {
          "file_name": "swc-default/src/com/mesmotronic/ane/AndroidFullScreen.as"
        }
      ]
    }
  },
  {
    "name": "Sample app crashed on Android 6.0",
    "url": "https://github.com/xiprox/ErrorView/issues/5",
    "description": "Device: Nexus 5\n\n```\n10-05 09:55:44.974 28433-28433/? E/AndroidRuntime: java.lang.LinkageError: tr.xip.errorview.sample.MainActivity\n10-05 09:55:44.974 28433-28433/? E/AndroidRuntime:     at dalvik.system.DexFile.defineClassNative(Native Method)\n10-05 09:55:44.974 28433-28433/? E/AndroidRuntime:     at dalvik.system.DexFile.defineClass(DexFile.java:226)\n10-05 09:55:44.974 28433-28433/? E/AndroidRuntime:     at dalvik.system.DexFile.loadClassBinaryName(DexFile.java:219)\n10-05 09:55:44.974 28433-28433/? E/AndroidRuntime:     at dalvik.system.DexPathList.findClass(DexPathList.java:338)\n10-05 09:55:44.974 28433-28433/? E/AndroidRuntime:     at dalvik.system.BaseDexClassLoader.findClass(BaseDexClassLoader.java:54)\n10-05 09:55:44.974 28433-28433/? E/AndroidRuntime:     at java.lang.ClassLoader.loadClass(ClassLoader.java:511)\n10-05 09:55:44.974 28433-28433/? E/AndroidRuntime:     at java.lang.ClassLoader.loadClass(ClassLoader.java:469)\n10-05 09:55:44.974 28433-28433/? E/AndroidRuntime:     at android.app.Instrumentation.newActivity(Instrumentation.java:1067)\n10-05 09:55:44.974 28433-28433/? E/AndroidRuntime:     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2317)\n10-05 09:55:44.974 28433-28433/? E/AndroidRuntime:     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2476)\n10-05 09:55:44.974 28433-28433/? E/AndroidRuntime:     at android.app.ActivityThread.-wrap11(ActivityThread.java)\n10-05 09:55:44.974 28433-28433/? E/AndroidRuntime:     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1344)\n10-05 09:55:44.974 28433-28433/? E/AndroidRuntime:     at android.os.Handler.dispatchMessage(Handler.java:102)\n10-05 09:55:44.974 28433-28433/? E/AndroidRuntime:     at android.os.Looper.loop(Looper.java:148)\n10-05 09:55:44.974 28433-28433/? E/AndroidRuntime:     at android.app.ActivityThread.main(ActivityThread.java:5417)\n10-05 09:55:44.974 28433-28433/? E/AndroidRuntime:     at java.lang.reflect.Method.invoke(Native Method)\n10-05 09:55:44.974 28433-28433/? E/AndroidRuntime:     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:726)\n10-05 09:55:44.974 28433-28433/? E/AndroidRuntime:     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:616)\n```\n",
    "keywords": [
      "app",
      "dexfile",
      "os",
      "method",
      "app activitythread",
      "09:55:44 974",
      "android",
      "dalvik",
      "classloader",
      "e/androidruntime",
      "974 28433-28433/",
      "10-05 09:55:44",
      "09:55:44",
      "activitythread",
      "system",
      "java",
      "974",
      "system dexfile",
      "28433-28433/ e/androidruntime",
      "28433-28433/",
      "10-05",
      "lang",
      "zygoteinit"
    ],
    "code": {
      "language": "Java",
      "url": "https://github.com/xiprox/ErrorView/commit/209c5d217b69ba09894584cfac56a76de0155fd9",
      "files": [
        {
          "file_name": "sample/src/main/java/tr/xip/errorview/sample/MainActivity.java",
          "patch": "@@ -26,7 +26,7 @@ public void onRetry() {\n                     public void run() {\n                         mErrorView.setConfig(ErrorView.Config.create()\n                                 .title(getString(R.string.error_title_damn))\n-                                .titleColor(getColor(R.color.apptheme_primary))\n+                                .titleColor(getResources().getColor(R.color.apptheme_primary))\n                                 .subtitle(getString(R.string.error_subtitle_failed_one_more_time))\n                                 .retryText(getString(R.string.error_view_retry))\n                                 .build());\n@@ -35,8 +35,4 @@ public void run() {\n             }\n         });\n     }\n-\n-    public int getColor(int res) {\n-        return getResources().getColor(res);\n-    }\n }"
        }
      ]
    }
  },
  {
    "name": "date not imported for existing photo in Android 6",
    "url": "https://github.com/inaturalist/iNaturalistAndroid/issues/308",
    "description": "Location imports normally, but not the date. Possibly related to https://github.com/inaturalist/iNaturalistAndroid/commit/9b9e7e8377144128bed5e5ff9b5c690dd0c4a33f#diff-e507e33bfc3ec18375f7d63e741e5bd9R2087 (#298). I can replicate this with any photo on my Moto G, even if they have the `DatetimeOriginal` tag.",
    "keywords": [],
    "code": {
      "language": "Java",
      "url": "https://github.com/inaturalist/iNaturalistAndroid/commit/b4c42a769db18c266af633a6ab879bd759fcfb38",
      "files": [
        {
          "file_name": "iNaturalist/src/main/AndroidManifest.xml",
          "patch": "@@ -1,8 +1,8 @@\n \u003c?xml version\u003d\"1.0\" encoding\u003d\"utf-8\"?\u003e \n \u003cmanifest xmlns:android\u003d\"http://schemas.android.com/apk/res/android\"\n     package\u003d\"org.inaturalist.android\"\n-    android:versionCode\u003d\"201\"\n-    android:versionName\u003d\"1.5.4\" \u003e\n+    android:versionCode\u003d\"202\"\n+    android:versionName\u003d\"1.5.5\" \u003e\n \n     \u003cuses-sdk android:minSdkVersion\u003d\"10\" android:targetSdkVersion\u003d\"21\"\n         /\u003e"
        },
        {
          "file_name": "iNaturalist/src/main/java/org/inaturalist/android/INaturalistApp.java",
          "patch": "@@ -132,8 +132,8 @@ public void onCreate() {\n                 .memoryCache(new LruCache((int)(Runtime.getRuntime().maxMemory() * 0.5)))\n                 .build();\n         Picasso.setSingletonInstance(picasso);\n-        Picasso.with(getApplicationContext())\n-                .setIndicatorsEnabled(true);\n+        //Picasso.with(getApplicationContext())\n+        //        .setIndicatorsEnabled(true);\n \n         mNotificationManager \u003d (NotificationManager) getSystemService(Context.NOTIFICATION_SERVICE);\n         INaturalistApp.context \u003d getApplicationContext();"
        },
        {
          "file_name": "iNaturalist/src/main/java/org/inaturalist/android/ObservationEditor.java",
          "patch": "@@ -2244,7 +2244,13 @@ private void importPhotoMetadata(Uri photoUri) {\n             }\n \n \n-            String datetime \u003d exif.getAttribute(\"DateTimeOriginal\" /* ExifInterface.TAG_DATETIME_ORIGINAL - supported from API v24 only */);\n+            String datetime;\n+            if (android.os.Build.VERSION.SDK_INT \u003c Build.VERSION_CODES.N) {\n+                // Older Android (before v7), doesn\u0027t parse the EXIF tag of TAG_DATETIME_ORIGINAL\n+                datetime \u003d exif.getAttribute(ExifInterface.TAG_DATETIME);\n+            } else {\n+                datetime \u003d exif.getAttribute(ExifInterface.TAG_DATETIME_ORIGINAL);\n+            }\n \n             if (datetime !\u003d null) {\n                 SimpleDateFormat exifDateFormat \u003d new SimpleDateFormat(\"yyyy:MM:dd HH:mm:ss\");"
        }
      ]
    }
  },
  {
    "name": "Share CSV for Android \u003e6.0",
    "url": "https://github.com/lidox/reaction-test/issues/75",
    "description": "",
    "keywords": [],
    "code": {
      "language": "Java",
      "url": "https://github.com/lidox/reaction-test/commit/e8ff634df00b788770cb265ad1e000db7ca56a06",
      "files": [
        {
          "file_name": "ReactionTest/.idea/misc.xml",
          "patch": "@@ -37,7 +37,7 @@\n     \u003cConfirmationsSetting value\u003d\"0\" id\u003d\"Add\" /\u003e\n     \u003cConfirmationsSetting value\u003d\"0\" id\u003d\"Remove\" /\u003e\n   \u003c/component\u003e\n-  \u003ccomponent name\u003d\"ProjectRootManager\" version\u003d\"2\" languageLevel\u003d\"JDK_1_8\" default\u003d\"true\" assert-keyword\u003d\"true\" jdk-15\u003d\"true\" project-jdk-name\u003d\"1.8\" project-jdk-type\u003d\"JavaSDK\"\u003e\n+  \u003ccomponent name\u003d\"ProjectRootManager\" version\u003d\"2\" languageLevel\u003d\"JDK_1_7\" default\u003d\"true\" assert-keyword\u003d\"true\" jdk-15\u003d\"true\" project-jdk-name\u003d\"1.8\" project-jdk-type\u003d\"JavaSDK\"\u003e\n     \u003coutput url\u003d\"file://$PROJECT_DIR$/build/classes\" /\u003e\n   \u003c/component\u003e\n   \u003ccomponent name\u003d\"ProjectType\"\u003e"
        },
        {
          "file_name": "ReactionTest/app/src/main/java/com/artursworld/reactiontest/controller/export/ExportViaCSV.java",
          "patch": "@@ -1,9 +1,14 @@\n package com.artursworld.reactiontest.controller.export;\n \n+import android.Manifest;\n import android.app.Activity;\n+import android.content.pm.PackageManager;\n import android.os.AsyncTask;\n import android.support.annotation.NonNull;\n+import android.support.v4.app.ActivityCompat;\n+import android.support.v4.content.ContextCompat;\n import android.widget.ListView;\n+import android.widget.Toast;\n \n import com.artursworld.reactiontest.controller.helper.Type;\n import com.artursworld.reactiontest.controller.util.UtilsRG;\n@@ -32,6 +37,8 @@\n  */\n public class ExportViaCSV implements IExporter {\n \n+    public static final int REQUEST_CODE_WRITE_EXTERNAL_STORAGE \u003d 1;\n+\n     private static final String SEPARATOR \u003d \", \";\n     private Activity activity \u003d null;\n     private String userId \u003d null;\n@@ -44,7 +51,37 @@ public ExportViaCSV(Activity a, String userId) {\n \n     @Override\n     public void export() {\n-        loadDirectoryAndExport(userId);\n+        if (!permissionExternalStorageAllowed()) {\n+            requestPermission();\n+        }\n+        if (permissionExternalStorageAllowed()) {\n+            loadDirectoryAndExport(userId);\n+        }\n+    }\n+\n+    /**\n+     * Request storage permissions\n+     */\n+    private void requestPermission() {\n+\n+        if (ActivityCompat.shouldShowRequestPermissionRationale(activity, Manifest.permission.WRITE_EXTERNAL_STORAGE)) {\n+            UtilsRG.info(\"permission for WRITE_EXTERNAL_STORAGE is already set\");\n+        } else {\n+            ActivityCompat.requestPermissions(activity, new String[]{Manifest.permission.WRITE_EXTERNAL_STORAGE}, ExportViaCSV.REQUEST_CODE_WRITE_EXTERNAL_STORAGE);\n+        }\n+    }\n+\n+    /**\n+     * Check if permission is granted\n+     *\n+     * @return true if granted otherwise false\n+     */\n+    private boolean permissionExternalStorageAllowed() {\n+        int result \u003d ContextCompat.checkSelfPermission(activity, Manifest.permission.WRITE_EXTERNAL_STORAGE);\n+        if (result \u003d\u003d PackageManager.PERMISSION_GRANTED) {\n+            return true;\n+        }\n+        return false;\n     }\n \n     /**"
        },
        {
          "file_name": "ReactionTest/app/src/main/java/com/artursworld/reactiontest/view/user/UserManagementFragmentListView.java",
          "patch": "@@ -1,10 +1,15 @@\n package com.artursworld.reactiontest.view.user;\n \n+import android.Manifest;\n import android.app.Fragment;\n import android.app.FragmentTransaction;\n import android.content.Intent;\n+import android.content.pm.PackageManager;\n import android.os.AsyncTask;\n import android.os.Bundle;\n+import android.support.design.widget.Snackbar;\n+import android.support.v4.app.ActivityCompat;\n+import android.support.v4.content.ContextCompat;\n import android.view.ContextMenu;\n import android.view.LayoutInflater;\n import android.view.MenuItem;\n@@ -21,6 +26,7 @@\n import com.artursworld.reactiontest.controller.util.UtilsRG;\n import com.artursworld.reactiontest.model.entity.MedicalUser;\n import com.artursworld.reactiontest.model.persistence.manager.MedicalUserManager;\n+import com.sdsmdg.tastytoast.TastyToast;\n \n import java.util.List;\n \n@@ -95,14 +101,13 @@ public void onItemClick(AdapterView\u003c?\u003e parent, View view, int position, long id)\n         if (isEmptyUserList) {\n             if (userListView !\u003d null \u0026\u0026 getActivity() !\u003d null) {\n                 TextView emptyText \u003d (TextView) getView().findViewById(R.id.empty_user_list);\n-                if(emptyText !\u003d null)\n+                if (emptyText !\u003d null)\n                     emptyText.setVisibility(View.VISIBLE);\n             }\n-        }\n-        else{\n+        } else {\n             if (userListView !\u003d null \u0026\u0026 getActivity() !\u003d null) {\n                 TextView emptyText \u003d (TextView) getView().findViewById(R.id.empty_user_list);\n-                if(emptyText !\u003d null)\n+                if (emptyText !\u003d null)\n                     emptyText.setVisibility(View.INVISIBLE);\n             }\n         }\n@@ -118,14 +123,14 @@ public void onCreateContextMenu(ContextMenu menu, View v, ContextMenu.ContextMen\n     public boolean onContextItemSelected(MenuItem item) {\n         AdapterView.AdapterContextMenuInfo info \u003d (AdapterView.AdapterContextMenuInfo) item.getMenuInfo();\n \n-        if(item.getItemId() \u003d\u003d R.id.delete_user){\n+        if (item.getItemId() \u003d\u003d R.id.delete_user) {\n             final String medicalUserId \u003d userListView.getItemAtPosition(info.position).toString();\n-            UtilsRG.info(\"delete user(\"+medicalUserId+\")\");\n-            new AsyncTask\u003cVoid, Void, Void\u003e(){\n+            UtilsRG.info(\"delete user(\" + medicalUserId + \")\");\n+            new AsyncTask\u003cVoid, Void, Void\u003e() {\n                 @Override\n                 protected Void doInBackground(Void... params) {\n                     MedicalUserManager db \u003d new MedicalUserManager(getActivity().getApplicationContext());\n-                    if(db !\u003d null){\n+                    if (db !\u003d null) {\n                         db.deleteUserById(medicalUserId);\n                     }\n                     return null;\n@@ -137,10 +142,12 @@ protected void onPostExecute(Void aVoid) {\n                     initMedicalUserListViewAsync(null);\n                 }\n             }.execute();\n-        }\n-        else if(item.getItemId() \u003d\u003d R.id.export){\n+        } else if (item.getItemId() \u003d\u003d R.id.export) {\n             IExporter exporter \u003d new ExportViaCSV(getActivity(), selectedMedicalUserId);\n             exporter.export();\n+\n+\n+\n         }\n         return super.onContextItemSelected(item);\n     }"
        }
      ]
    }
  },
  {
    "name": "Support Android 6 runtime permission for external storage",
    "url": "https://github.com/erickok/transdroid/issues/258",
    "description": "Used when reading directly local .torrent files from the storage or when writing/reading settings files. Should request this when first using the permission.\n",
    "keywords": [],
    "code": {
      "language": "Java",
      "url": "https://github.com/erickok/transdroid/commit/f82ba6e12b0d47ddd70f10dc0a318933be602ce0",
      "files": [
        {
          "file_name": "app/build.gradle",
          "patch": "@@ -28,7 +28,7 @@ android {\n         }\n     }\n     lintOptions {\n-        disable \u0027MissingTranslation\u0027, \u0027ExtraTranslation\u0027\n+        disable \u0027MissingTranslation\u0027, \u0027ExtraTranslation\u0027, \u0027StringFormatInvalid\u0027\n     }\n }\n "
        },
        {
          "file_name": "app/src/main/java/org/transdroid/core/app/settings/SettingsPersistence.java",
          "patch": "@@ -134,9 +134,9 @@ public void importSettings(SharedPreferences prefs, JSONObject json) throws JSON\n \t\t\t\tif (server.has(\"new_torrent_alarm\"))\n \t\t\t\t\teditor.putBoolean(\"server_alarmnew_\" + postfix, server.getBoolean(\"new_torrent_alarm\"));\n \t\t\t\tif (server.has(\"alarm_filter_exclude\"))\n-\t\t\t\t\teditor.putBoolean(\"server_alarmexclude_\" + postfix, server.getBoolean(\"alarm_filter_exclude\"));\n+\t\t\t\t\teditor.putString(\"server_alarmexclude_\" + postfix, server.getString(\"alarm_filter_exclude\"));\n \t\t\t\tif (server.has(\"alarm_filter_include\"))\n-\t\t\t\t\teditor.putBoolean(\"server_alarminclude_\" + postfix, server.getBoolean(\"alarm_filter_include\"));\n+\t\t\t\t\teditor.putString(\"server_alarminclude_\" + postfix, server.getString(\"alarm_filter_include\"));\n \n \t\t\t}\n \t\t}\n@@ -174,11 +174,13 @@ public void importSettings(SharedPreferences prefs, JSONObject json) throws JSON\n \t\t\t\tif (feed.has(\"new_item_alarm\"))\n \t\t\t\t\teditor.putBoolean(\"rssfeed_alarmnew_\" + postfix, feed.getBoolean(\"new_item_alarm\"));\n \t\t\t\tif (feed.has(\"alarm_filter_include\"))\n-\t\t\t\t\teditor.putBoolean(\"rssfeed_alarminclude_\" + postfix, feed.getBoolean(\"alarm_filter_include\"));\n+\t\t\t\t\teditor.putString(\"rssfeed_include_\" + postfix, feed.getString(\"alarm_filter_include\"));\n \t\t\t\tif (feed.has(\"alarm_filter_exclude\"))\n-\t\t\t\t\teditor.putBoolean(\"rssfeed_alarmexclude_\" + postfix, feed.getBoolean(\"alarm_filter_exclude\"));\n-\t\t\t\tif (feed.has(\"last_seen\"))\n-\t\t\t\t\teditor.putString(\"rssfeed_lastnew_\" + postfix, feed.getString(\"last_seen\"));\n+\t\t\t\t\teditor.putString(\"rssfeed_exclude_\" + postfix, feed.getString(\"alarm_filter_exclude\"));\n+\t\t\t\tif (feed.has(\"last_seen_time\"))\n+\t\t\t\t\teditor.putLong(\"rssfeed_lastviewed_\" + postfix, feed.getLong(\"last_seen_time\"));\n+\t\t\t\tif (feed.has(\"last_seen_item\"))\n+\t\t\t\t\teditor.putString(\"rssfeed_lastvieweditemurl_\" + postfix, feed.getString(\"last_seen_item\"));\n \n \t\t\t}\n \t\t}\n@@ -280,8 +282,8 @@ private JSONObject exportSettings(SharedPreferences prefs) throws JSONException\n \t\t\tserver.put(\"server_timeout\", prefs.getString(\"server_timeout_\" + postfixi, null));\n \t\t\tserver.put(\"download_alarm\", prefs.getBoolean(\"server_alarmfinished_\" + postfixi, false));\n \t\t\tserver.put(\"new_torrent_alarm\", prefs.getBoolean(\"server_alarmnew_\" + postfixi, false));\n-\t\t\tserver.put(\"alarm_filter_exclude\", prefs.getBoolean(\"server_alarmexclude_\" + postfixi, false));\n-\t\t\tserver.put(\"alarm_filter_include\", prefs.getBoolean(\"server_alarminclude_\" + postfixi, false));\n+\t\t\tserver.put(\"alarm_filter_exclude\", prefs.getString(\"server_alarmexclude_\" + postfixi, null));\n+\t\t\tserver.put(\"alarm_filter_include\", prefs.getString(\"server_alarminclude_\" + postfixi, null));\n \n \t\t\tservers.put(server);\n \t\t\ti++;\n@@ -317,9 +319,10 @@ private JSONObject exportSettings(SharedPreferences prefs) throws JSONException\n \t\t\tfeed.put(\"url\", prefs.getString(\"rssfeed_url_\" + postfixk, null));\n \t\t\tfeed.put(\"needs_auth\", prefs.getBoolean(\"rssfeed_reqauth_\" + postfixk, false));\n \t\t\tfeed.put(\"new_item_alarm\", prefs.getBoolean(\"rssfeed_alarmnew_\" + postfixk, false));\n-\t\t\tfeed.put(\"alarm_filter_exclude\", prefs.getBoolean(\"server_alarmexclude_\" + postfixk, false));\n-\t\t\tfeed.put(\"alarm_filter_include\", prefs.getBoolean(\"server_alarminclude_\" + postfixk, false));\n-\t\t\tfeed.put(\"last_seen\", prefs.getString(\"rssfeed_lastnew_\" + postfixk, null));\n+\t\t\tfeed.put(\"alarm_filter_exclude\", prefs.getString(\"server_alarmexclude_\" + postfixk, null));\n+\t\t\tfeed.put(\"alarm_filter_include\", prefs.getString(\"server_alarminclude_\" + postfixk, null));\n+\t\t\tfeed.put(\"last_seen_time\", prefs.getLong(\"rssfeed_lastviewed_\" + postfixk, -1));\n+\t\t\tfeed.put(\"last_seen_item\", prefs.getString(\"rssfeed_lastvieweditemurl_\" + postfixk, null));\n \n \t\t\tfeeds.put(feed);\n \t\t\tk++;"
        },
        {
          "file_name": "app/src/main/java/org/transdroid/core/gui/TorrentsActivity.java",
          "patch": "@@ -24,6 +24,7 @@\n import android.os.AsyncTask;\n import android.os.Build;\n import android.os.Bundle;\n+import android.support.annotation.NonNull;\n import android.support.v4.view.MenuItemCompat;\n import android.support.v4.widget.DrawerLayout;\n import android.support.v7.app.ActionBarDrawerToggle;\n@@ -215,6 +216,9 @@\n \t// Auto refresh task\n \tprivate AsyncTask\u003cVoid, Void, Void\u003e autoRefreshTask;\n \n+\tprivate String awaitingAddLocalFile;\n+\tprivate String awaitingAddTitle;\n+\n \t@Override\n \tpublic void onCreate(Bundle savedInstanceState) {\n \t\t// Set the theme according to the user preference\n@@ -739,6 +743,14 @@ public boolean onSearchRequested() {\n \t\treturn true;\n \t}\n \n+\t@Override\n+\tpublic void onRequestPermissionsResult(int requestCode, @NonNull String[] permissions, @NonNull int[] grantResults) {\n+\t\tif (awaitingAddLocalFile !\u003d null \u0026\u0026 awaitingAddTitle !\u003d null \u0026\u0026\n+\t\t\t\tBoolean.TRUE.equals(navigationHelper.handleTorrentReadPermissionResult(requestCode, grantResults))) {\n+\t\t\taddTorrentByFile(awaitingAddLocalFile, awaitingAddTitle);\n+\t\t}\n+\t}\n+\n \t@Click(R.id.addmenu_link_button)\n \tprotected void startUrlEntryDialog() {\n \t\taddmenuButton.collapse();\n@@ -1043,6 +1055,12 @@ public void addTorrentByMagnetUrl(String url, String title) {\n \n \t@Background\n \tprotected void addTorrentByFile(String localFile, String title) {\n+\t\tif (!navigationHelper.checkTorrentReadPermission(this)) {\n+\t\t\t// No read permission yet (which we get the result of in onRequestPermissionsResult)\n+\t\t\tawaitingAddLocalFile \u003d localFile;\n+\t\t\tawaitingAddTitle \u003d title;\n+\t\t\treturn;\n+\t\t}\n \t\tDaemonTaskResult result \u003d AddByFileTask.create(currentConnection, localFile).execute(log);\n \t\tif (result instanceof DaemonTaskSuccessResult) {\n \t\t\tonTaskSucceeded((DaemonTaskSuccessResult) result, getString(R.string.result_added, title));"
        },
        {
          "file_name": "app/src/main/java/org/transdroid/core/gui/navigation/NavigationHelper.java",
          "patch": "@@ -16,15 +16,25 @@\n  */\n package org.transdroid.core.gui.navigation;\n \n+import android.Manifest;\n import android.annotation.SuppressLint;\n+import android.annotation.TargetApi;\n+import android.app.Activity;\n import android.content.Context;\n import android.content.Intent;\n+import android.content.pm.PackageManager;\n import android.content.pm.ResolveInfo;\n import android.net.Uri;\n+import android.os.Build;\n+import android.support.annotation.NonNull;\n+import android.support.v4.app.ActivityCompat;\n+import android.support.v4.content.ContextCompat;\n import android.text.Spannable;\n import android.text.SpannableString;\n import android.text.style.TypefaceSpan;\n \n+import com.afollestad.materialdialogs.DialogAction;\n+import com.afollestad.materialdialogs.MaterialDialog;\n import com.nostra13.universalimageloader.cache.disc.impl.ext.LruDiskCache;\n import com.nostra13.universalimageloader.cache.disc.naming.Md5FileNameGenerator;\n import com.nostra13.universalimageloader.cache.memory.impl.UsingFreqLimitedMemoryCache;\n@@ -50,10 +60,80 @@\n @EBean\n public class NavigationHelper {\n \n+\tprivate static final int REQUEST_TORRENT_READ_PERMISSION \u003d 0;\n+\tprivate static final int REQUEST_SETTINGS_READ_PERMISSION \u003d 1;\n+\tprivate static final int REQUEST_SETTINGS_WRITE_PERMISSION \u003d 2;\n+\n \tprivate static ImageLoader imageCache;\n \t@RootContext\n \tprotected Context context;\n \n+\t@TargetApi(Build.VERSION_CODES.JELLY_BEAN)\n+\tpublic boolean checkTorrentReadPermission(final Activity activity) {\n+\t\treturn Build.VERSION.SDK_INT \u003c\u003d Build.VERSION_CODES.KITKAT ||\n+\t\t\t\tcheckPermission(activity, Manifest.permission.READ_EXTERNAL_STORAGE, REQUEST_TORRENT_READ_PERMISSION);\n+\t}\n+\n+\t@TargetApi(Build.VERSION_CODES.JELLY_BEAN)\n+\tpublic boolean checkSettingsReadPermission(final Activity activity) {\n+\t\treturn Build.VERSION.SDK_INT \u003c\u003d Build.VERSION_CODES.KITKAT ||\n+\t\t\t\tcheckPermission(activity, Manifest.permission.READ_EXTERNAL_STORAGE, REQUEST_SETTINGS_READ_PERMISSION);\n+\t}\n+\n+\t@TargetApi(Build.VERSION_CODES.JELLY_BEAN)\n+\tpublic boolean checkSettingsWritePermission(final Activity activity) {\n+\t\treturn Build.VERSION.SDK_INT \u003c\u003d Build.VERSION_CODES.KITKAT ||\n+\t\t\t\tcheckPermission(activity, Manifest.permission.WRITE_EXTERNAL_STORAGE, REQUEST_SETTINGS_WRITE_PERMISSION);\n+\t}\n+\n+\tprivate boolean checkPermission(final Activity activity, final String permission, final int requestCode) {\n+\t\tif (hasPermission(permission))\n+\t\t\t// Permission already granted\n+\t\t\treturn true;\n+\t\tif (!ActivityCompat.shouldShowRequestPermissionRationale(activity, permission)) {\n+\t\t\t// Never asked again: show a dialog with an explanation\n+\t\t\tnew MaterialDialog.Builder(context).content(R.string.permission_readtorrent).positiveText(android.R.string.ok)\n+\t\t\t\t\t.onPositive(new MaterialDialog.SingleButtonCallback() {\n+\t\t\t\t\t\t@Override\n+\t\t\t\t\t\tpublic void onClick(@NonNull MaterialDialog dialog, @NonNull DialogAction which) {\n+\t\t\t\t\t\t\tActivityCompat.requestPermissions(activity, new String[]{permission}, requestCode);\n+\t\t\t\t\t\t}\n+\t\t\t\t\t}).show();\n+\t\t\treturn false;\n+\t\t}\n+\t\t// Permission not granted (and we asked for it already before)\n+\t\tActivityCompat.requestPermissions(activity, new String[]{permission}, REQUEST_TORRENT_READ_PERMISSION);\n+\t\treturn false;\n+\t}\n+\n+\tprivate boolean hasPermission(String requiredPermission) {\n+\t\treturn ContextCompat.checkSelfPermission(context, requiredPermission) \u003d\u003d PackageManager.PERMISSION_GRANTED;\n+\t}\n+\n+\tpublic Boolean handleTorrentReadPermissionResult(int requestCode, int[] grantResults) {\n+\t\tif (requestCode \u003d\u003d REQUEST_TORRENT_READ_PERMISSION) {\n+\t\t\t// Return permission granting result\n+\t\t\treturn grantResults.length \u003e 0 \u0026\u0026 grantResults[0] \u003d\u003d PackageManager.PERMISSION_GRANTED;\n+\t\t}\n+\t\treturn null;\n+\t}\n+\n+\tpublic Boolean handleSettingsReadPermissionResult(int requestCode, int[] grantResults) {\n+\t\tif (requestCode \u003d\u003d REQUEST_SETTINGS_READ_PERMISSION) {\n+\t\t\t// Return permission granting result\n+\t\t\treturn grantResults.length \u003e 0 \u0026\u0026 grantResults[0] \u003d\u003d PackageManager.PERMISSION_GRANTED;\n+\t\t}\n+\t\treturn null;\n+\t}\n+\n+\tpublic Boolean handleSettingsWritePermissionResult(int requestCode, int[] grantResults) {\n+\t\tif (requestCode \u003d\u003d REQUEST_SETTINGS_WRITE_PERMISSION) {\n+\t\t\t// Return permission granting result\n+\t\t\treturn grantResults.length \u003e 0 \u0026\u0026 grantResults[0] \u003d\u003d PackageManager.PERMISSION_GRANTED;\n+\t\t}\n+\t\treturn null;\n+\t}\n+\n \t/**\n \t * Converts a string into a {@link Spannable} that displays the string in the Roboto Condensed font\n \t * @param string A plain text {@link String}"
        },
        {
          "file_name": "app/src/main/java/org/transdroid/core/gui/settings/SystemSettingsActivity.java",
          "patch": "@@ -28,8 +28,8 @@\n import android.preference.CheckBoxPreference;\n import android.preference.Preference;\n import android.preference.Preference.OnPreferenceClickListener;\n-import android.preference.PreferenceActivity;\n import android.preference.PreferenceManager;\n+import android.support.annotation.NonNull;\n import android.text.TextUtils;\n \n import com.nispok.snackbar.Snackbar;\n@@ -81,6 +81,7 @@ public boolean onPreferenceClick(Preference preference) {\n \tprotected ErrorLogSender errorLogSender;\n \t@Bean\n \tprotected SettingsPersistence settingsPersistence;\n+\n \tprivate OnPreferenceClickListener onCheckUpdatesClick \u003d new OnPreferenceClickListener() {\n \t\t@Override\n \t\tpublic boolean onPreferenceClick(Preference preference) {\n@@ -103,19 +104,12 @@ public boolean onPreferenceClick(Preference preference) {\n \tprivate OnClickListener importSettingsFromFile \u003d new OnClickListener() {\n \t\t@Override\n \t\tpublic void onClick(DialogInterface dialog, int which) {\n-\t\t\tSharedPreferences prefs \u003d PreferenceManager.getDefaultSharedPreferences(SystemSettingsActivity.this);\n-\t\t\ttry {\n-\t\t\t\tsettingsPersistence.importSettingsFromFile(prefs, SettingsPersistence.DEFAULT_SETTINGS_FILE);\n-\t\t\t\tSnackbarManager.show(Snackbar.with(SystemSettingsActivity.this).text(R.string.pref_import_success));\n-\t\t\t} catch (FileNotFoundException e) {\n-\t\t\t\tSnackbarManager\n-\t\t\t\t\t\t.show(Snackbar.with(SystemSettingsActivity.this).text(R.string.error_file_not_found).colorResource(R.color.red));\n-\t\t\t} catch (JSONException e) {\n-\t\t\t\tSnackbarManager.show(Snackbar.with(SystemSettingsActivity.this)\n-\t\t\t\t\t\t.text(getString(R.string.error_no_valid_settings_file, getString(R.string.app_name))).colorResource(R.color.red));\n-\t\t\t}\n+\t\t\tif (!navigationHelper.checkSettingsReadPermission(SystemSettingsActivity.this))\n+\t\t\t\treturn; // We are requesting permission to access file storage\n+\t\t\timportSettingsFromFile();\n \t\t}\n \t};\n+\n \tprivate OnClickListener importSettingsFromQr \u003d new OnClickListener() {\n \t\t@Override\n \t\tpublic void onClick(DialogInterface dialog, int which) {\n@@ -125,16 +119,12 @@ public void onClick(DialogInterface dialog, int which) {\n \tprivate OnClickListener exportSettingsToFile \u003d new OnClickListener() {\n \t\t@Override\n \t\tpublic void onClick(DialogInterface dialog, int which) {\n-\t\t\tSharedPreferences prefs \u003d PreferenceManager.getDefaultSharedPreferences(SystemSettingsActivity.this);\n-\t\t\ttry {\n-\t\t\t\tsettingsPersistence.exportSettingsToFile(prefs, SettingsPersistence.DEFAULT_SETTINGS_FILE);\n-\t\t\t\tSnackbarManager.show(Snackbar.with(SystemSettingsActivity.this).text(R.string.pref_export_success));\n-\t\t\t} catch (JSONException | IOException e) {\n-\t\t\t\tSnackbarManager.show(Snackbar.with(SystemSettingsActivity.this).text(R.string.error_cant_write_settings_file)\n-\t\t\t\t\t\t.colorResource(R.color.red));\n-\t\t\t}\n+\t\t\tif (!navigationHelper.checkSettingsWritePermission(SystemSettingsActivity.this))\n+\t\t\t\treturn; // We are requesting permission to access file storage\n+\t\t\texportSettingsToFile();\n \t\t}\n \t};\n+\n \tprivate OnClickListener exportSettingsToQr \u003d new OnClickListener() {\n \t\t@Override\n \t\tpublic void onClick(DialogInterface dialog, int which) {\n@@ -176,8 +166,42 @@ protected void navigateUp() {\n \t\tMainSettingsActivity_.intent(this).flags(Intent.FLAG_ACTIVITY_CLEAR_TOP).start();\n \t}\n \n+\t@Override\n+\tpublic void onRequestPermissionsResult(int requestCode, @NonNull String[] permissions, @NonNull int[] grantResults) {\n+\t\tif (Boolean.TRUE.equals(navigationHelper.handleSettingsReadPermissionResult(requestCode, grantResults))) {\n+\t\t\timportSettingsFromFile();\n+\t\t} else if (Boolean.TRUE.equals(navigationHelper.handleSettingsWritePermissionResult(requestCode, grantResults))) {\n+\t\t\texportSettingsToFile();\n+\t\t}\n+\t}\n+\n+\tprivate void importSettingsFromFile() {\n+\t\tSharedPreferences prefs \u003d PreferenceManager.getDefaultSharedPreferences(SystemSettingsActivity.this);\n+\t\ttry {\n+\t\t\tsettingsPersistence.importSettingsFromFile(prefs, SettingsPersistence.DEFAULT_SETTINGS_FILE);\n+\t\t\tSnackbarManager.show(Snackbar.with(SystemSettingsActivity.this).text(R.string.pref_import_success));\n+\t\t} catch (FileNotFoundException e) {\n+\t\t\tSnackbarManager\n+\t\t\t\t\t.show(Snackbar.with(SystemSettingsActivity.this).text(R.string.error_file_not_found).colorResource(R.color.red));\n+\t\t} catch (JSONException e) {\n+\t\t\tSnackbarManager.show(Snackbar.with(SystemSettingsActivity.this)\n+\t\t\t\t\t.text(getString(R.string.error_no_valid_settings_file, getString(R.string.app_name))).colorResource(R.color.red));\n+\t\t}\n+\t}\n+\n+\tprivate void exportSettingsToFile() {\n+\t\tSharedPreferences prefs \u003d PreferenceManager.getDefaultSharedPreferences(SystemSettingsActivity.this);\n+\t\ttry {\n+\t\t\tsettingsPersistence.exportSettingsToFile(prefs, SettingsPersistence.DEFAULT_SETTINGS_FILE);\n+\t\t\tSnackbarManager.show(Snackbar.with(SystemSettingsActivity.this).text(R.string.pref_export_success));\n+\t\t} catch (JSONException | IOException e) {\n+\t\t\tSnackbarManager.show(Snackbar.with(SystemSettingsActivity.this).text(R.string.error_cant_write_settings_file)\n+\t\t\t\t\t.colorResource(R.color.red));\n+\t\t}\n+\t}\n+\n \t@OnActivityResult(BarcodeHelper.ACTIVITY_BARCODE_QRSETTINGS)\n-\tpublic void onQrCodeScanned(int resultCode, Intent data) {\n+\tpublic void onQrCodeScanned(@SuppressWarnings(\"UnusedParameters\") int resultCode, Intent data) {\n \t\t// We should have received Intent extras with the QR-decoded data representing Transdroid settings\n \t\tif (data \u003d\u003d null || !data.hasExtra(\"SCAN_RESULT\"))\n \t\t\treturn; // Cancelled scan; ignore"
        },
        {
          "file_name": "app/src/main/res/values/strings.xml",
          "patch": "@@ -435,7 +435,11 @@\n \t\t\u003citem\u003e43200\u003c/item\u003e\n \t\t\u003citem\u003e86400\u003c/item\u003e\n \t\u003c/string-array\u003e\n-\t\n+\n+\t\u003cstring name\u003d\"permission_readtorrent\"\u003eTransdroid requires read access to your file storage in order to read local .torrent files\u003c/string\u003e\n+\t\u003cstring name\u003d\"permission_readsettings\"\u003eTransdroid requires read access to your file storage if you want to read from a local settings file\u003c/string\u003e\n+\t\u003cstring name\u003d\"permission_writesettings\"\u003eTransdroid requires write access to your file storage to write the local settings file\u003c/string\u003e\n+\n \t\u003cstring name\u003d\"error_httperror\"\u003eError during communication; check your connection\u003c/string\u003e\n \t\u003cstring name\u003d\"error_unsupported\"\u003eYour torrent client does not support this operation\u003c/string\u003e\n \t\u003cstring name\u003d\"error_jsonrequesterror\"\u003eInternal error building request\u003c/string\u003e"
        },
        {
          "file_name": "build.gradle",
          "patch": "@@ -3,7 +3,7 @@ buildscript {\n         jcenter()\n     }\n     dependencies {\n-        classpath \u0027com.android.tools.build:gradle:1.3.0\u0027\n+        classpath \u0027com.android.tools.build:gradle:2.0.0-alpha5\u0027\n         classpath \u0027com.neenbedankt.gradle.plugins:android-apt:1.4\u0027\n     }\n }"
        },
        {
          "file_name": "gradle/wrapper/gradle-wrapper.properties",
          "patch": "@@ -1,6 +1,6 @@\n-#Tue Dec 09 09:45:38 CET 2014\n+#Wed Jan 20 12:20:00 CET 2016\n distributionBase\u003dGRADLE_USER_HOME\n distributionPath\u003dwrapper/dists\n zipStoreBase\u003dGRADLE_USER_HOME\n zipStorePath\u003dwrapper/dists\n-distributionUrl\u003dhttps\\://services.gradle.org/distributions/gradle-2.8-all.zip\n+distributionUrl\u003dhttps\\://services.gradle.org/distributions/gradle-2.10-all.zip"
        }
      ]
    }
  },
  {
    "name": "Can\u0027t run instrumentation tests on Android 6",
    "url": "https://github.com/medic/medic-gateway/issues/100",
    "description": "",
    "keywords": [],
    "code": {
      "language": "Java",
      "url": "https://github.com/medic/medic-gateway/commit/225491d67f79a56454455e409088c3c821804428",
      "files": [
        {
          "file_name": "src/androidTest/java/medic/gateway/alert/IntentProcessorInstrumentationTest.java",
          "patch": "@@ -240,11 +240,43 @@ private void deliver(Intent i, int resultCode) {\n \t\t\tField f \u003d BroadcastReceiver.class.getDeclaredField(\"mPendingResult\");\n \t\t\tf.setAccessible(true);\n \t\t\tf.set(intentProcessor, pr);\n+\n+\t\t\tdeliver(i);\n+\n+\t\t\treturn;\n+\t\t} catch(Exception ex) { /* ignore */ }\n+\n+\t\ttry {\n+\t\t\tConstructor c \u003d BroadcastReceiver.PendingResult.class.getDeclaredConstructor(int.class, String.class, android.os.Bundle.class, int.class, boolean.class, boolean.class, android.os.IBinder.class, int.class, int.class);\n+\t\t\tc.setAccessible(true);\n+\t\t\tBroadcastReceiver.PendingResult pr \u003d (BroadcastReceiver.PendingResult) c.newInstance(resultCode, null, null, 0, false, false, null, 0, 0);\n+\n+\t\t\tField f \u003d BroadcastReceiver.class.getDeclaredField(\"mPendingResult\");\n+\t\t\tf.setAccessible(true);\n+\t\t\tf.set(intentProcessor, pr);\n+\n+\t\t\tdeliver(i);\n+\n+\t\t\treturn;\n+\t\t} catch(Exception ex) { /* ignore */ }\n+\n+\t\ttry {\n+\t\t\tStringBuilder details \u003d new StringBuilder();\n+\t\t\tfor(Constructor c : BroadcastReceiver.PendingResult.class.getDeclaredConstructors()) {\n+\t\t\t\tdetails.append(c.getName());\n+\t\t\t\tdetails.append(\u0027(\u0027);\n+\t\t\t\tfor(Class p : c.getParameterTypes()) {\n+\t\t\t\t\tdetails.append(p.getName());\n+\t\t\t\t\tdetails.append(\u0027,\u0027);\n+\t\t\t\t}\n+\t\t\t\tdetails.append(\"); \");\n+\t\t\t}\n+\t\t\tthrow new RuntimeException(\"Looks like this version of Android isn\u0027t properly supported by this test :¬\\\\  \" +\n+\t\t\t\t\t\"Maybe one of these contructors will help: \" + details);\n \t\t} catch(Exception ex) {\n \t\t\tthrow new RuntimeException(ex);\n \t\t}\n \n-\t\tdeliver(i);\n \t}\n \n \tprivate void deliver(Intent i) {"
        }
      ]
    }
  },
  {
    "name": "inotify not working on Android 6+",
    "url": "https://github.com/syncthing/syncthing-android/issues/787",
    "description": "https://code.google.com/p/android/issues/detail?id\u003d189231\r\n\r\nTo verify, use the following steps while Syncthing is running: \r\n1. run `adb logcat -s FolderObserver:v`\r\n2. in a second terminal, run `adb shell` and `cd` into a Syncthing folder\r\n3. create/modify/delete files with `touch`, `mkdir`, `rm` etc\r\n4. each of these modifications should be shown in the logcat\r\n\r\nI tried this on Android 6 devices, and Android 7.0/7.1 emulators, and none of them reported the events correctly. As a workaround, I changed the rescan interval to 60 seconds on these devices.",
    "keywords": [
      "android"
    ],
    "code": {
      "language": "Java",
      "url": "https://github.com/syncthing/syncthing-android/commit/113d712d5f90e3c10c79b44f7deacb20578b5972",
      "files": [
        {
          "file_name": "src/main/java/com/nutomic/syncthingandroid/activities/FolderActivity.java",
          "patch": "@@ -333,14 +333,13 @@ private void initFolder() {\n         mFolder \u003d new Folder();\n         mFolder.id \u003d getIntent().getStringExtra(EXTRA_FOLDER_ID);\n         mFolder.label \u003d getIntent().getStringExtra(EXTRA_FOLDER_LABEL);\n-        if (Build.VERSION.SDK_INT \u003c Build.VERSION_CODES.M) {\n+        if (Build.VERSION.SDK_INT !\u003d Build.VERSION_CODES.M) {\n             // Scan every 3 days (in case inotify dropped some changes)\n             mFolder.rescanIntervalS \u003d 259200;\n         }\n         else {\n-            // FileObserver does not work correctly on Android Marshmallow.\n-            // Nougat seems to have the same problem in emulator, but we should check this again.\n-            // https://code.google.com/p/android/issues/detail?id\u003d189231\n+            // FileObserver is broken on Marshmallow.\n+            // https://github.com/syncthing/syncthing-android/issues/787\n             mFolder.rescanIntervalS \u003d 60;\n         }\n         mFolder.versioning \u003d new Folder.Versioning();"
        }
      ]
    }
  },
  {
    "name": "Implemented runtime Camera permissions check for Android 6",
    "url": "https://github.com/mattrayner/cordova-plugin-vuforia/pull/30",
    "description": "- Require Camera permissions on Vuforia start (required for Android 6, fixes #29)\n- Handle error and display message mentioning required permission\n- Bump version to 1.2.0 \n",
    "keywords": [],
    "code": {
      "language": "Java",
      "url": "https://github.com/mattrayner/cordova-plugin-vuforia/commit/9089e995b31cdc33181f0024dee7b162589901f1",
      "files": [
        {
          "file_name": "README.md",
          "patch": "@@ -42,6 +42,9 @@ navigator.VuforiaPlugin.startVuforia(\n   function(data){\n     console.log(data);\n     alert(\"Image found: \"+data.imageName);\n+  },\n+  function(data) {\n+    alert(\"Error: \" + data);\n   }\n );\n ```"
        },
        {
          "file_name": "package.json",
          "patch": "@@ -1,7 +1,7 @@\n {\n   \"name\": \"cordova-plugin-vuforia\",\n   \"description\": \"Cordova Vuforia Plugin\",\n-  \"version\": \"1.1.2\",\n+  \"version\": \"1.2.0\",\n   \"homepage\": \"https://github.com/mattrayner/cordova-plugin-vuforia\",\n   \"repository\": {\n     \"type\": \"git\","
        },
        {
          "file_name": "plugin.xml",
          "patch": "@@ -4,7 +4,7 @@\n         xmlns:rim\u003d\"http://www.blackberry.com/ns/widgets\"\n         xmlns:android\u003d\"http://schemas.android.com/apk/res/android\"\n         id\u003d\"cordova-plugin-vuforia\"\n-        version\u003d\"1.1.2\"\u003e\n+        version\u003d\"1.2.0\"\u003e\n     \u003cname\u003eVuforia\u003c/name\u003e\n     \u003cdescription\u003eCordova Vuforia Plugin\u003c/description\u003e\n     \u003clicense\u003eMIT\u003c/license\u003e\n@@ -15,7 +15,7 @@\n     \u003cauthor\u003eMatthew Rayner\u003c/author\u003e\n \n     \u003cinfo\u003e\n-        Cordova Vuforia Plugin version 1.1.2, Copyright (C) 2016 Matthew Rayner\n+        Cordova Vuforia Plugin version 1.2.0, Copyright (C) 2016 Matthew Rayner\n         Cordova Vuforia Plugin comes with ABSOLUTELY NO WARRANTY; see the\n         LICENSE file for more information.\n         This is free software, and you are welcome to redistribute it"
        },
        {
          "file_name": "src/android/VuforiaPlugin.java",
          "patch": "@@ -13,11 +13,20 @@\n import android.app.Activity;\n import android.content.Intent;\n import android.content.Context;\n+import android.content.pm.PackageManager;\n import android.util.Log;\n+import android.Manifest;\n+import android.Manifest.permission\n \n import com.mattrayner.vuforia.app.ImageTargets;\n \n public class VuforiaPlugin extends CordovaPlugin {\n+    public static final String CAMERA \u003d Manifest.permission.CAMERA;\n+    private static final int CAPTURE_VIDEO_ACTIVITY_REQUEST_CODE \u003d 200;\n+\n+    private static String ACTION;\n+    private static JSONArray ARGS;\n+\n     static final String LOGTAG \u003d \"Cordova Vuforia Plugin\";\n \n     static final int IMAGE_REC_REQUEST \u003d 1;\n@@ -29,11 +38,16 @@ public VuforiaPlugin() {\n     public void initialize(CordovaInterface cordova, CordovaWebView webView) {\n         super.initialize(cordova, webView);\n \n+        cordova.requestPermission(this, CAPTURE_VIDEO_ACTIVITY_REQUEST_CODE, CAMERA);\n+\n         Log.d(LOGTAG, \"Plugin initialized.\");\n     }\n \n     @Override\n     public boolean execute(String action, JSONArray args, CallbackContext callbackContext) throws JSONException {\n+        ACTION \u003d action;\n+        ARGS \u003d args;\n+\n         String targetFile \u003d args.getString(0);\n         String targets \u003d args.getJSONArray(1).toString();\n         String overlayText \u003d args.getString(2);\n@@ -53,12 +67,32 @@ public boolean execute(String action, JSONArray args, CallbackContext callbackCo\n         intent.putExtra(\"OVERLAY_TEXT\", overlayText);\n         intent.putExtra(\"LICENSE_KEY\", vuforiaLicense);\n \n-        // Launch a new activity with Vuforia in it. Expect it to return a result.\n-        cordova.startActivityForResult(this, intent, IMAGE_REC_REQUEST);\n+        if(cordova.hasPermission(CAMERA)) {\n+            // Launch a new activity with Vuforia in it. Expect it to return a result.\n+            cordova.startActivityForResult(this, intent, IMAGE_REC_REQUEST);\n+        }\n+        else {\n+            // Request the camera permission and handle the outcome.\n+            cordova.requestPermission(this, CAPTURE_VIDEO_ACTIVITY_REQUEST_CODE, CAMERA);\n+        }\n \n         return true;\n     }\n \n+    public void onRequestPermissionResult(int requestCode, String[] permissions, int[] grantResults) throws JSONException {\n+        for(int r:grantResults) {\n+            if(r \u003d\u003d PackageManager.PERMISSION_DENIED) {\n+                this.callback.sendPluginResult(new PluginResult(PluginResult.Status.ERROR, \"CAMERA_PERMISSION_ERROR\"));\n+                return;\n+            }\n+        }\n+        switch(requestCode) {\n+            case CAPTURE_VIDEO_ACTIVITY_REQUEST_CODE:\n+                execute(ACTION, ARGS, this.callback);\n+                break;\n+        }\n+    }\n+\n     @Override\n     public void onActivityResult(int requestCode, int resultCode, Intent data) {\n         String name;"
        },
        {
          "file_name": "www/VuforiaPlugin.js",
          "patch": "@@ -1,16 +1,17 @@\n var VuforiaPlugin \u003d {\n-  startVuforia: function(imageFile ,imageTargets, overlayCopy, vuforiaLicense, imageFoundCallback){\n+  startVuforia: function(imageFile ,imageTargets, overlayCopy, vuforiaLicense, imageFoundCallback, errorCallback){\n \n     cordova.exec(\n \n       // Register the callback handler\n       function callback(data) {\n         imageFoundCallback(data);\n       },\n-      // Register the errorHandler\n+      // Register the error handler\n       function errorHandler(err) {\n-        console.error(\u0027Vuforia Plugin Error:\u0027);\n-        console.error(err);\n+        if(typeof errorCallback !\u003d\u003d \u0027undefined\u0027) {\n+          errorCallback(err);\n+        }\n       },\n       // Define what class to route messages to\n       \u0027VuforiaPlugin\u0027,"
        }
      ]
    }
  },
  {
    "name": "Android 6.0, Emulator and crash while resuming app from notification",
    "url": "https://github.com/katzer/cordova-plugin-local-notifications/issues/682",
    "description": "Hi, \n\ni\u0027m trying to use plugin in a cordova app and my app still crash after i clicked on notification. This is driving me crazy :-/\n\nSo, i add notification like this:\ncordova.plugins.notification.local.schedule( { id: inId, title: stTitle, text: stMsg+\u0027 (\u0027+inId+\u0027)\u0027, at: new Date() + 1000 } );\n\nI register clicke event like this:\ncordova.plugins.notification.local.on(\"click\", function (notification, state) { \n    setTimeout(function() {\n        console.log(\u0027click on notification\u0027) \n    }, 1);\n});\n\nI run the app in emulator (Android 6, \"mesa GPU\", Linux Debian) and the plugin does its magic! the notification appears! And if i click on it it, crash happens :-( \n\nCan anyone help me? Thanks in advance! \n## \n\nGauthier\n\n--------- beginning of crash\nFATAL EXCEPTION: main\nProcess: com.opzo.game.zoopmem, PID: 2524\njava.lang.RuntimeException: Unable to resume activity {com.opzo.game.zoopmem/de.appplant.cordova.plugin.localnotification.ClickActivity}: java.lang.IllegalStateException: Activity {com.opzo.game.zoopmem/de.appplant.cordova.plugin.localnotification.ClickActivity} did not call finish() prior to onResume() completing\n   at android.app.ActivityThread.performResumeActivity(ActivityThread.java:3103)\n   at android.app.ActivityThread.handleResumeActivity(ActivityThread.java:3134)\n   at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2481)\n   at android.app.ActivityThread.-wrap11(ActivityThread.java)\n   at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1344)\n   at android.os.Handler.dispatchMessage(Handler.java:102)\n   at android.os.Looper.loop(Looper.java:148)\n   at android.app.ActivityThread.main(ActivityThread.java:5417)\n   at java.lang.reflect.Method.invoke(Native Method)\n   at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:726)\n   at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:616)\nCaused by: java.lang.IllegalStateException: Activity {com.opzo.game.zoopmem/de.appplant.cordova.plugin.localnotification.ClickActivity} did not call finish() prior to onResume() completing\n   at android.app.Activity.performResume(Activity.java:6324)\n   at android.app.ActivityThread.performResumeActivity(ActivityThread.java:3092)\n... 10 more\n",
    "keywords": [
      "com",
      "app",
      "game",
      "opzo",
      "os",
      "activity",
      "app activitythread",
      "android",
      "main",
      "appplant",
      "java lang",
      "crash",
      "activitythread",
      "notification",
      "java",
      "plugin",
      "cordova",
      "clickactivity}",
      "android app",
      "zoopmem/de",
      "localnotification",
      ";",
      "lang",
      "{com",
      "zygoteinit"
    ],
    "code": {
      "language": "Java",
      "url": "https://github.com/katzer/cordova-plugin-local-notifications/commit/38f58ac22734f1e7e8ed803081842e79c79028c1",
      "files": [
        {
          "file_name": "CHANGELOG.md",
          "patch": "@@ -7,6 +7,7 @@ Please also read the [Upgrade Guide](https://github.com/katzer/cordova-plugin-lo\n - New \"quarter\" intervall for iOS \u0026 Android\n - Fixed #732 loop between update and trigger (Android)\n - Fixed #710 crash due to \u003e500 notifications (Android)\n+- Fixed #682 crash while resuming app from notification (Android 6)\n - Fixed crashing `get(ID)` if notification doesn\u0027t exist\n \n #### Version 0.8.2 (08.11.2015)"
        },
        {
          "file_name": "src/android/notification/AbstractClickActivity.java",
          "patch": "@@ -68,6 +68,16 @@ public void onCreate (Bundle state) {\n     }\n \n     /**\n+     * Fixes \"Unable to resume activity\" error.\n+     * Theme_NoDisplay: Activities finish themselves before being resumed.\n+     */\n+    @Override\n+    protected void onResume() {\n+        super.onResume();\n+        finish();\n+    }\n+\n+    /**\n      * Called when local notification was clicked by the user.\n      *\n      * @param notification"
        }
      ]
    }
  },
  {
    "name": "Incoming calls crash Gadgetbridge if permissions to access contacts are disabled on Android 6.0",
    "url": "https://github.com/Freeyourgadget/Gadgetbridge/issues/182",
    "description": "When I click Demo -\u003e Incoming Call, the complete App crash.\n",
    "keywords": [],
    "code": {
      "language": "Java",
      "url": "https://github.com/Freeyourgadget/Gadgetbridge/commit/112dfa184a96f0a531520eda557f5cd5f5334d74",
      "files": [
        {
          "file_name": "CHANGELOG.md",
          "patch": "@@ -1,5 +1,8 @@\n ###Changelog\n \n+####Next Version\n+* Fix crash when contacts cannot be read on Android 6.0 (non-granted pemissions)\n+\n ####Version 0.6.7\n * Pebble: Allow installation of 3.x apps on OG Pebble (FW will be released soon)\n * Fix crashes on startup when logging is enabled or when entering the app manager on some phones"
        },
        {
          "file_name": "app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/DeviceCommunicationService.java",
          "patch": "@@ -430,7 +430,13 @@ private String getContactDisplayNameByNumber(String number) {\n         }\n \n         ContentResolver contentResolver \u003d getContentResolver();\n-        Cursor contactLookup \u003d contentResolver.query(uri, null, null, null, null);\n+\n+        Cursor contactLookup \u003d null;\n+        try {\n+            contentResolver.query(uri, null, null, null, null);\n+        } catch (SecurityException e) {\n+            return name;\n+        }\n \n         try {\n             if (contactLookup !\u003d null \u0026\u0026 contactLookup.getCount() \u003e 0) {"
        }
      ]
    }
  },
  {
    "name": "Problems with style of popup widows in Android 6.0",
    "url": "https://github.com/nextgis/android_gisapp/issues/427",
    "description": "![](http://m-d.me/img/ss/20163722-123709.png)\n![](http://m-d.me/img/ss/20163722-123731.png)\n",
    "keywords": [],
    "code": {
      "language": "Java",
      "url": "https://github.com/nextgis/android_gisapp/commit/99b7eed06b2fdc06bda5cf921c8ea12acc5e1735",
      "files": [
        {
          "file_name": "app/src/main/java/com/nextgis/mobile/activity/SettingsActivity.java",
          "patch": "@@ -46,7 +46,6 @@\n import com.nextgis.maplib.map.MapBase;\n import com.nextgis.maplib.util.SettingsConstants;\n import com.nextgis.maplibui.activity.NGPreferenceActivity;\n-import com.nextgis.maplibui.util.ControlHelper;\n import com.nextgis.maplibui.util.SettingsConstantsUI;\n import com.nextgis.mobile.MainApplication;\n import com.nextgis.mobile.R;\n@@ -452,7 +451,7 @@ public static void initializeReset(final SettingsActivity activity, final Prefer\n             preference.setOnPreferenceClickListener(new Preference.OnPreferenceClickListener() {\n                 @Override\n                 public boolean onPreferenceClick(Preference preference) {\n-                    AlertDialog.Builder confirm \u003d new AlertDialog.Builder(activity, ControlHelper.getDialogTheme(activity, activity.getThemeId()));\n+                    AlertDialog.Builder confirm \u003d new AlertDialog.Builder(activity);\n                     confirm.setTitle(R.string.reset_settings_title).setMessage(R.string.reset_settings_message)\n                             .setNegativeButton(android.R.string.cancel, null)\n                             .setPositiveButton(android.R.string.ok, new DialogInterface.OnClickListener() {"
        },
        {
          "file_name": "app/src/main/java/com/nextgis/mobile/dialog/NewFieldDialog.java",
          "patch": "@@ -56,7 +56,7 @@ public Dialog onCreateDialog(Bundle savedInstanceState) {\n         final EditText name \u003d (EditText) view.findViewById(R.id.et_field_name);\n         final Spinner type \u003d (Spinner) view.findViewById(R.id.sp_field_type);\n \n-        AlertDialog.Builder builder \u003d new AlertDialog.Builder(mContext, mDialogTheme);\n+        AlertDialog.Builder builder \u003d new AlertDialog.Builder(mContext);\n         builder.setTitle(mTitle).setView(view).setNegativeButton(android.R.string.cancel, null)\n             .setPositiveButton(android.R.string.ok, new DialogInterface.OnClickListener() {\n                 @Override"
        },
        {
          "file_name": "maplibui",
          "patch": "@@ -1 +1 @@\n-Subproject commit 4bf99e9876e70aba2a244d6a6df7555cfd877103\n+Subproject commit 80d7a7795f35431e7e57b99209094df30ca3ba72"
        }
      ]
    }
  },
  {
    "name": "Android 6 で disconnect すると konashi への入力処理を取得できない",
    "url": "https://github.com/YUKAI/konashi-android-sdk/issues/192",
    "description": "## 再現環境\n\nAndroid: Nexus 5x (Android 6.0.1)\nKonashiInspector: https://github.com/YUKAI/KonashiInspectorForAndroid/tree/1.1\nFirmware: 2.1.4\nkonashi SDK: 2.0.0\nPC 側アプリ: CoolTerm\n## 再現方法\n1. konashi と PC を FTDI USB シリアル変換アダプタで接続。\n2. Android から KonashiInspector で konashi に接続。\n3. アプリの UART パネルを開き、baudrate 9600 で PC 側からの入力を受け取れる事を確認。\n4. アプリと konashi の接続を切る。\n5. アプリと konashi を再接続して UART のトグルスイッチを OFF \u003d\u003e ON にする。\n6. 再度 PC からの入力を受け取れるか確認。\n## 補足\n- アプリを閉じて再度開くと正常に UART が受け取れる。\n- UART 以外にも PIO 入力等が受け取れていない。\n- https://github.com/YUKAI/konashi-android-sdk/blob/master/konashi-android-sdk/src/main/java/com/uxxu/konashi/lib/CallbackHandler.java#L75 が呼ばれていないような気がする。\n- iOS 版 konashi inspector では正常に動作する。\n",
    "keywords": [
      "##",
      "0",
      "1",
      "2",
      "pc",
      "6",
      "android",
      "で",
      "uart",
      "konashi"
    ],
    "code": {
      "language": "Java",
      "url": "https://github.com/YUKAI/konashi-android-sdk/commit/738c3159cd961763f9016d5f9461d70c0b6d0c6a",
      "files": [
        {
          "file_name": "gradle/wrapper/gradle-wrapper.properties",
          "patch": "@@ -1,4 +1,4 @@\n-#Wed Apr 10 15:27:10 PDT 2013\n+#Sun Jun 25 23:34:45 JST 2017\n distributionBase\u003dGRADLE_USER_HOME\n distributionPath\u003dwrapper/dists\n zipStoreBase\u003dGRADLE_USER_HOME"
        },
        {
          "file_name": "konashi-android-sdk/src/main/java/com/uxxu/konashi/lib/KonashiManager.java",
          "patch": "@@ -51,8 +51,6 @@\n import org.jdeferred.DonePipe;\n import org.jdeferred.Promise;\n import org.jdeferred.android.AndroidDeferredManager;\n-import org.jdeferred.android.AndroidDeferredObject;\n-import org.jdeferred.impl.DeferredPromise;\n \n import java.util.UUID;\n \n@@ -119,6 +117,8 @@\n     private BluetoothDevice mDevice;\n     private ConnectionHelper mConnectionHelper;\n \n+    private Context mContext;\n+\n     ///////////////////////////\n     // Initialization\n     ///////////////////////////\n@@ -156,6 +156,8 @@ public KonashiManager(Context context) {\n         mBletia \u003d new Bletia(context);\n         mConnectionHelper \u003d new ConnectionHelper(mConnectionHelperCallback, context);\n         mBletia.addListener(mCallbackHandler);\n+\n+        mContext \u003d context;\n     }\n \n     /**\n@@ -247,7 +249,7 @@ public void removeAllListeners() {\n     ///////////////////////////\n     // PIO\n     ///////////////////////////\n-    \n+\n     /**\n      * PIOのピンを入力として使うか、出力として使うかの設定を行う\n      * @param pin 設定するPIOのピン名。\n@@ -256,15 +258,15 @@ public void removeAllListeners() {\n     public Promise\u003cBluetoothGattCharacteristic, BletiaException, Void\u003e pinMode(int pin, int mode){\n         return execute(new PioPinModeAction(getKonashiService(), pin, mode, mPioStore.getModes()), mPioDispatcher);\n     }\n-    \n+\n     /**\n      * PIOのピンを入力として使うか、出力として使うかの設定を行う\n      * @param modes PIO0 〜 PIO7 の計8ピンの設定\n      */\n     public Promise\u003cBluetoothGattCharacteristic, BletiaException, Void\u003e pinModeAll(int modes){\n         return execute(new PioPinModeAction(getKonashiService(), modes), mPioDispatcher);\n     }\n-    \n+\n     /**\n      * PIOのピンをプルアップするかの設定を行う\n      * @param pin 設定するPIOのピン名\n@@ -273,15 +275,15 @@ public void removeAllListeners() {\n     public Promise\u003cBluetoothGattCharacteristic, BletiaException, Void\u003e pinPullup(int pin, int pullup){\n         return execute(new PioPinPullupAction(getKonashiService(), pin, pullup, mPioStore.getPullups()), mPioDispatcher);\n     }\n-    \n+\n     /**\n      * PIOのピンをプルアップするかの設定を行う\n      * @param pullups PIO0 〜 PIO7 の計8ピンのプルアップの設定\n      */\n     public Promise\u003cBluetoothGattCharacteristic, BletiaException, Void\u003e pinPullupAll(int pullups){\n         return execute(new PioPinPullupAction(getKonashiService(), pullups), mPioDispatcher);\n     }\n-    \n+\n     /**\n      * PIOの特定のピンの入力状態を取得する\n      * @param pin PIOのピン名\n@@ -290,15 +292,15 @@ public void removeAllListeners() {\n     public int digitalRead(int pin){\n         return mPioStore.getInput(pin);\n     }\n-    \n+\n     /**\n      * PIOのすべてのピンの状態を取得する\n      * @return PIOの状態(PIO0〜PIO7の入力状態が8bit(1byte)で表現)\n      */\n     public int digitalReadAll(){\n         return mPioStore.getInputs();\n     }\n-    \n+\n     /**\n      * PIOの特定のピンの出力状態を設定する\n      * @param pin 設定するPIOのピン名\n@@ -307,20 +309,20 @@ public int digitalReadAll(){\n     public Promise\u003cBluetoothGattCharacteristic, BletiaException, Void\u003e digitalWrite(int pin, int output){\n         return execute(new PioDigitalWriteAction(getKonashiService(), pin, output, mPioStore.getOutputs()), mPioDispatcher);\n     }\n-    \n+\n     /**\n      * PIOの特定のピンの出力状態を設定する\n      * @param outputs PIOの出力状態。PIO0〜PIO7の出力状態が8bit(1byte)で表現\n      */\n     public Promise\u003cBluetoothGattCharacteristic, BletiaException, Void\u003e digitalWriteAll(int outputs){\n         return execute(new PioDigitalWriteAction(getKonashiService(), outputs), mPioDispatcher);\n     }\n-    \n-    \n+\n+\n     ///////////////////////////\n     // PWM\n     ///////////////////////////\n-    \n+\n     /**\n      * PIO の指定のピンを PWM として使用する/しないかを設定する\n      * @param pin PWMモードの設定をするPIOのピン番号。Konashi.PIO0 〜 Konashi.PIO7。\n@@ -346,7 +348,7 @@ public int digitalReadAll(){\n \n         return promise;\n     }\n-    \n+\n     /**\n      * 指定のピンのPWM周期を設定する\n      * @param pin PWMモードの設定をするPIOのピン番号。Konashi.PIO0 〜 Konashi.PIO7。\n@@ -355,7 +357,7 @@ public int digitalReadAll(){\n     public Promise\u003cBluetoothGattCharacteristic, BletiaException, Void\u003e pwmPeriod(int pin, int period){\n         return execute(new PwmPeriodAction(getKonashiService(), pin, period, mPwmStore.getDuty(pin))).then(mPwmDispatcher);\n     }\n-    \n+\n     /**\n      * 指定のピンのPWMのデューティ(ONになっている時間)を設定する。\n      * @param pin PWMモードの設定をするPIOのピン番号。Konashi.PIO0 〜 Konashi.PIO7。\n@@ -364,7 +366,7 @@ public int digitalReadAll(){\n     public Promise\u003cBluetoothGattCharacteristic, BletiaException, Void\u003e pwmDuty(int pin, int duty){\n         return execute(new PwmDutyAction(getKonashiService(), pin, duty, mPwmStore.getPeriod(pin))).then(mPwmDispatcher);\n     }\n-    \n+\n     /**\n      * 指定のピンのLEDの明るさを0%〜100%で指定する\n      * @param pin PWMモードの設定をするPIOのピン番号。Konashi.PIO0 〜 Konashi.PIO7。\n@@ -373,7 +375,7 @@ public int digitalReadAll(){\n     public Promise\u003cBluetoothGattCharacteristic, BletiaException, Void\u003e pwmLedDrive(int pin, float dutyRatio){\n         return execute(new PwmLedDriveAction(getKonashiService(), pin, dutyRatio, mPwmStore.getPeriod(pin))).then(mPwmDispatcher);\n     }\n-    \n+\n     /**\n      * pwmLedDrive(int pin, float dutyRatio) の doubleでdutyRatioを指定する版。\n      * @param pin PWMモードの設定をするPIOのピン番号。Konashi.PIO0 〜 Konashi.PIO7。\n@@ -382,8 +384,8 @@ public int digitalReadAll(){\n     public Promise\u003cBluetoothGattCharacteristic, BletiaException, Void\u003e pwmLedDrive(int pin, double dutyRatio){\n         return pwmLedDrive(pin, (float) dutyRatio);\n     }\n-    \n-    \n+\n+\n     ///////////////////////////\n     // AIO\n     ///////////////////////////\n@@ -397,7 +399,7 @@ public int digitalReadAll(){\n                 .then(mAioDispatcher)\n                 .then(new AioAnalogReadFilter(pin));\n     }\n-    \n+\n     /**\n      * AIO の指定のピンに任意の電圧を出力する\n      * @param pin AIOのピン名。指定可能なピン名は AIO0, AIO1, AIO\n@@ -424,7 +426,7 @@ public int digitalReadAll(){\n //        }\n //    }\n \n-    \n+\n     ///////////////////////////\n     // UART\n     ///////////////////////////\n@@ -435,7 +437,7 @@ public int digitalReadAll(){\n     public Promise\u003cBluetoothGattCharacteristic, BletiaException, Void\u003e uartMode(int mode){\n         return execute(new UartModeAction(getKonashiService(), mode, mUartStore), mUartDispatcher);\n     }\n-    \n+\n     /**\n      * UART の通信速度を設定する\n      * @param baudrate UARTの通信速度。Konashi.UART_RATE_2K4 か Konashi.UART_RATE_9K6 を指定\n@@ -481,12 +483,12 @@ public int digitalReadAll(){\n //            notifyKonashiError(KonashiErrorReason.NOT_ENABLED_UART);\n //        }\n //    }\n-    \n-    \n+\n+\n     ///////////////////////////\n     // I2C\n     ///////////////////////////\n-    \n+\n     /**\n      * I2Cのコンディションを発行する\n      * @param condition コンディション。Konashi.I2C_START_CONDITION, Konashi.I2C_RESTART_CONDITION, Konashi.I2C_STOP_CONDITION を指定できる。\n@@ -672,6 +674,8 @@ public int digitalReadAll(){\n \n     private void connect(BluetoothDevice device){\n         mDevice \u003d device;\n+        mBletia \u003d new Bletia(mContext);\n+        mBletia.addListener(mCallbackHandler);\n         mBletia.connect(device);\n     }\n "
        }
      ]
    }
  },
  {
    "name": "Add Audio note for Android \u003e6.0",
    "url": "https://github.com/lidox/reaction-test/issues/76",
    "description": "",
    "keywords": [],
    "code": {
      "language": "Java",
      "url": "https://github.com/lidox/reaction-test/commit/5cbd892710324378762978d46933eac186b9fc12",
      "files": [
        {
          "file_name": "ReactionTest/app/src/main/java/com/artursworld/reactiontest/controller/export/ExportViaCSV.java",
          "patch": "@@ -37,7 +37,7 @@\n  */\n public class ExportViaCSV implements IExporter {\n \n-    public static final int REQUEST_CODE_WRITE_EXTERNAL_STORAGE \u003d 1;\n+    public static final int REQUEST_CODE_WRITE_EXTERNAL_STORAGE \u003d 3;\n \n     private static final String SEPARATOR \u003d \", \";\n     private Activity activity \u003d null;\n@@ -51,37 +51,7 @@ public ExportViaCSV(Activity a, String userId) {\n \n     @Override\n     public void export() {\n-        if (!permissionExternalStorageAllowed()) {\n-            requestPermission();\n-        }\n-        if (permissionExternalStorageAllowed()) {\n-            loadDirectoryAndExport(userId);\n-        }\n-    }\n-\n-    /**\n-     * Request storage permissions\n-     */\n-    private void requestPermission() {\n-\n-        if (ActivityCompat.shouldShowRequestPermissionRationale(activity, Manifest.permission.WRITE_EXTERNAL_STORAGE)) {\n-            UtilsRG.info(\"permission for WRITE_EXTERNAL_STORAGE is already set\");\n-        } else {\n-            ActivityCompat.requestPermissions(activity, new String[]{Manifest.permission.WRITE_EXTERNAL_STORAGE}, ExportViaCSV.REQUEST_CODE_WRITE_EXTERNAL_STORAGE);\n-        }\n-    }\n-\n-    /**\n-     * Check if permission is granted\n-     *\n-     * @return true if granted otherwise false\n-     */\n-    private boolean permissionExternalStorageAllowed() {\n-        int result \u003d ContextCompat.checkSelfPermission(activity, Manifest.permission.WRITE_EXTERNAL_STORAGE);\n-        if (result \u003d\u003d PackageManager.PERMISSION_GRANTED) {\n-            return true;\n-        }\n-        return false;\n+        loadDirectoryAndExport(userId);\n     }\n \n     /**"
        },
        {
          "file_name": "ReactionTest/app/src/main/java/com/artursworld/reactiontest/controller/util/UtilsRG.java",
          "patch": "@@ -1,20 +1,25 @@\n package com.artursworld.reactiontest.controller.util;\n \n+import android.Manifest;\n import android.app.Activity;\n import android.content.Context;\n import android.content.Intent;\n import android.content.SharedPreferences;\n+import android.content.pm.PackageManager;\n import android.media.AudioManager;\n import android.media.ToneGenerator;\n import android.net.Uri;\n import android.os.AsyncTask;\n import android.os.Vibrator;\n import android.preference.PreferenceManager;\n+import android.provider.Settings;\n+import android.support.v4.app.ActivityCompat;\n import android.support.v4.content.ContextCompat;\n \n import com.artursworld.reactiontest.R;\n import com.artursworld.reactiontest.controller.helper.GameStatus;\n import com.artursworld.reactiontest.controller.helper.Type;\n+import com.artursworld.reactiontest.model.persistence.strictmode.StrictModeApplication;\n import com.artursworld.reactiontest.view.games.StartGameSettings;\n \n import org.slf4j.Logger;\n@@ -191,6 +196,51 @@ public static void shareFile(File file, Activity activity, String medId) {\n         sendIntent.setType(\"text/html\");\n         activity.startActivity(Intent.createChooser(sendIntent, activity.getResources().getString(R.string.share_using)));\n     }\n+\n+    /**\n+     * Requests permissions\n+     * @param activity\n+     * @param permissions\n+     * @param requestCode\n+     * @return true if permissions already set. Otherwise false.\n+     */\n+    public static boolean requestPermission(Activity activity, String[] permissions, int requestCode) {\n+\n+        if (ActivityCompat.shouldShowRequestPermissionRationale(activity, Manifest.permission.RECORD_AUDIO)) {\n+            UtilsRG.info(\"Permissions:\" + Arrays.toString(permissions) + \" has been set by user.\");\n+            return true;\n+        } else {\n+            ActivityCompat.requestPermissions(activity, permissions, requestCode);//new String[]{Manifest.permission.RECORD_AUDIO,Manifest.permission.WRITE_EXTERNAL_STORAGE}REQUEST_CODE_RECORD_AUDIO);\n+            return false;\n+        }\n+    }\n+\n+    /**\n+     * Check if permission is granted\n+     * @param activity\n+     * @param permission the permission e.g. Manifest.permission.RECORD_AUDIO\n+     * @return\n+     */\n+    public static boolean permissionAllowed(Activity activity, String permission) {\n+        int result \u003d ContextCompat.checkSelfPermission(activity, permission);\n+        if (result \u003d\u003d PackageManager.PERMISSION_GRANTED) {\n+            return true;\n+        }\n+        else{\n+            return false;\n+        }\n+    }\n+\n+    public static void startInstalledAppDetailsActivity(Activity activity) {\n+        final Intent i \u003d new Intent();\n+        i.setAction(Settings.ACTION_APPLICATION_DETAILS_SETTINGS);\n+        i.addCategory(Intent.CATEGORY_DEFAULT);\n+        i.setData(Uri.parse(\"package:\" + activity.getPackageName()));\n+        i.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);\n+        i.addFlags(Intent.FLAG_ACTIVITY_NO_HISTORY);\n+        i.addFlags(Intent.FLAG_ACTIVITY_EXCLUDE_FROM_RECENTS);\n+        activity.startActivity(i);\n+    }\n }\n \n "
        },
        {
          "file_name": "ReactionTest/app/src/main/java/com/artursworld/reactiontest/view/games/AudioRecorder.java",
          "patch": "@@ -1,12 +1,17 @@\n package com.artursworld.reactiontest.view.games;\n \n+import android.Manifest;\n import android.app.Activity;\n import android.content.Intent;\n+import android.content.pm.PackageManager;\n import android.media.MediaPlayer;\n import android.media.MediaRecorder;\n import android.os.AsyncTask;\n import android.os.Environment;\n import android.support.annotation.NonNull;\n+import android.support.v4.app.ActivityCompat;\n+import android.support.v4.content.ContextCompat;\n+import android.support.v4.content.pm.ActivityInfoCompat;\n import android.view.View;\n import android.widget.ImageView;\n import android.widget.TextView;\n@@ -25,6 +30,7 @@\n \n public class AudioRecorder {\n \n+    public static final int REQUEST_CODE_RECORD_AUDIO \u003d 2;\n     private ImageView recordButton \u003d null;\n     private RippleBackground rippleBackground \u003d null;\n     private TextView statusText \u003d null;\n@@ -33,9 +39,21 @@\n     private boolean isRecording \u003d false;\n     private boolean hasRecorded \u003d false;\n     private MediaPlayer mediaPlayer \u003d null;\n-    private String filepath \u003d \"reactionTest\";\n \n     public AudioRecorder(MaterialDialog audioDialog, final InOpEvent event, final Activity activity, final boolean playOnly) {\n+        boolean isAudioRecordAllowed \u003d UtilsRG.permissionAllowed(activity, Manifest.permission.RECORD_AUDIO);\n+        if (isAudioRecordAllowed) {\n+            UtilsRG.info(\"isAudioRecordAllowed \u003d true\");\n+            initAudioDialog(audioDialog, event, activity, playOnly);\n+        }\n+        if (!isAudioRecordAllowed) {\n+            UtilsRG.info(\"isAudioRecordAllowed \u003d false\");\n+            String[] permissions \u003d {Manifest.permission.RECORD_AUDIO, Manifest.permission.WRITE_EXTERNAL_STORAGE};\n+            UtilsRG.requestPermission(activity, permissions, REQUEST_CODE_RECORD_AUDIO);\n+        }\n+    }\n+\n+    private void initAudioDialog(MaterialDialog audioDialog, final InOpEvent event, final Activity activity, final boolean playOnly) {\n         recordButton \u003d (ImageView) audioDialog.getCustomView().findViewById(R.id.record_icon);\n         statusText \u003d (TextView) audioDialog.getCustomView().findViewById(R.id.record_state_label);\n         rippleBackground \u003d (RippleBackground) audioDialog.getCustomView().findViewById(R.id.ripple_background);\n@@ -122,8 +140,6 @@ protected void onPostExecute(Void aVoid) {\n \n             }\n         });\n-\n-\n     }\n \n     private void playMusic() {"
        },
        {
          "file_name": "ReactionTest/app/src/main/java/com/artursworld/reactiontest/view/games/GoGameView.java",
          "patch": "@@ -314,13 +314,13 @@ private void loadPreferances(final Activity activity) {\n             @Override\n             protected Void doInBackground(Void... params) {\n                 SharedPreferences mySharedPreferences \u003d PreferenceManager.getDefaultSharedPreferences(activity);\n-                triesPerGameCount \u003d mySharedPreferences.getInt(\"go_game_tries_per_game\", 3);\n+                triesPerGameCount \u003d mySharedPreferences.getInt(\"go_game_tries_per_game\", 1);\n                 String countdownCountKey \u003d getResources().getString(R.string.go_game_countdown_count);\n-                countDown_sec \u003d mySharedPreferences.getInt(countdownCountKey, 4);\n+                countDown_sec \u003d mySharedPreferences.getInt(countdownCountKey, 1);\n \n                 minWaitTimeBeforeGameStarts_sec \u003d 1;\n                 String maxRandomWaitTimeBeforeGameStartsKey \u003d getResources().getString(R.string.go_game_max_random_waiting_time);\n-                maxWaitTimeBeforeGameStarts_sec \u003d mySharedPreferences.getInt(maxRandomWaitTimeBeforeGameStartsKey, 3);\n+                maxWaitTimeBeforeGameStarts_sec \u003d mySharedPreferences.getInt(maxRandomWaitTimeBeforeGameStartsKey, 2);\n                 return null;\n             }\n         }.execute();"
        },
        {
          "file_name": "ReactionTest/app/src/main/java/com/artursworld/reactiontest/view/games/OperationModeView.java",
          "patch": "@@ -1,11 +1,15 @@\n package com.artursworld.reactiontest.view.games;\n \n+import android.Manifest;\n import android.app.Activity;\n import android.content.Intent;\n+import android.content.pm.PackageManager;\n import android.graphics.drawable.Drawable;\n+import android.net.Uri;\n import android.os.AsyncTask;\n import android.os.Bundle;\n import android.os.CountDownTimer;\n+import android.provider.Settings;\n import android.support.annotation.NonNull;\n import android.support.v4.content.ContextCompat;\n import android.support.v7.app.AppCompatActivity;\n@@ -228,10 +232,17 @@ public void onClick(int buttonIndex) {\n                 int addEventIndex \u003d 2;\n \n                 if (buttonIndex \u003d\u003d recordAudioIndex) {\n-                    UtilsRG.info(\"add audio record has been selected\");\n-                    InOpEvent event \u003d new InOpEvent(operationIssue, new Date(), TYPE_AUDIO, null);\n-                    MaterialDialog audioDialog \u003d getAudioDialog(activity);\n-                    AudioRecorder recorder \u003d new AudioRecorder(audioDialog, event, activity, false);\n+                    boolean isAudioRecordAllowed \u003d UtilsRG.permissionAllowed(activity, Manifest.permission.RECORD_AUDIO);\n+                    if (isAudioRecordAllowed) {\n+                        UtilsRG.info(\"add audio record has been selected\");\n+                        openAudioDialog(activity);\n+                    } else {\n+                        UtilsRG.info(\"isAudioRecordAllowed \u003d false\");\n+                        String[] permissions \u003d {Manifest.permission.RECORD_AUDIO, Manifest.permission.WRITE_EXTERNAL_STORAGE};\n+                        if (UtilsRG.requestPermission(activity, permissions, AudioRecorder.REQUEST_CODE_RECORD_AUDIO)){\n+                            UtilsRG.startInstalledAppDetailsActivity(activity);\n+                        }\n+                    }\n                 } else if (buttonIndex \u003d\u003d addEventIndex) {\n                     UtilsRG.info(\"addEventIndex has been selected\");\n                     MaterialDialog dialog \u003d initNoteDialog(activity);\n@@ -241,11 +252,38 @@ public void onClick(int buttonIndex) {\n                 } else if (buttonIndex \u003d\u003d addNewReactionTestIndex) {\n                     startIntentNewReactionTest(activity);\n                 }\n-            }//coll //coll //uncool //uncool //coll\n+            }\n         });\n     }\n \n     /**\n+     * Opens the audio dialog to reacord audio mesasge\n+     *\n+     * @param activity the running activity\n+     */\n+    private void openAudioDialog(Activity activity) {\n+        InOpEvent event \u003d new InOpEvent(operationIssue, new Date(), TYPE_AUDIO, null);\n+        MaterialDialog audioDialog \u003d getAudioDialog(activity);\n+        new AudioRecorder(audioDialog, event, activity, false);\n+    }\n+\n+    @Override\n+    public void onRequestPermissionsResult(int requestCode, String permissions[], int[] grantResults) {\n+        switch (requestCode) {\n+            case AudioRecorder.REQUEST_CODE_RECORD_AUDIO:\n+                if (grantResults.length \u003e 0 \u0026\u0026 grantResults[0] \u003d\u003d PackageManager.PERMISSION_GRANTED) {\n+                    UtilsRG.info(\"Permission Granted: REQUEST_CODE_RECORD_AUDIO\");\n+                    openAudioDialog(activity);\n+                } else {\n+                    UtilsRG.info(\"Permission Denied: REQUEST_CODE_RECORD_AUDIO\");\n+                    String[] permission \u003d {Manifest.permission.RECORD_AUDIO, Manifest.permission.WRITE_EXTERNAL_STORAGE};\n+                    UtilsRG.requestPermission(activity, permission, AudioRecorder.REQUEST_CODE_RECORD_AUDIO);\n+                }\n+                break;\n+        }\n+    }\n+\n+    /**\n      * Starts the reaction test\n      *\n      * @param activity"
        },
        {
          "file_name": "ReactionTest/app/src/main/java/com/artursworld/reactiontest/view/user/UserManagementFragmentListView.java",
          "patch": "@@ -26,6 +26,7 @@\n import com.artursworld.reactiontest.controller.util.UtilsRG;\n import com.artursworld.reactiontest.model.entity.MedicalUser;\n import com.artursworld.reactiontest.model.persistence.manager.MedicalUserManager;\n+import com.artursworld.reactiontest.view.games.AudioRecorder;\n import com.sdsmdg.tastytoast.TastyToast;\n \n import java.util.List;\n@@ -143,16 +144,33 @@ protected void onPostExecute(Void aVoid) {\n                 }\n             }.execute();\n         } else if (item.getItemId() \u003d\u003d R.id.export) {\n-            IExporter exporter \u003d new ExportViaCSV(getActivity(), selectedMedicalUserId);\n-            exporter.export();\n-\n-\n-\n+            boolean isExternalStorageAllowed \u003d UtilsRG.permissionAllowed(getActivity(), Manifest.permission.WRITE_EXTERNAL_STORAGE);\n+            if (isExternalStorageAllowed) {\n+                new ExportViaCSV(getActivity(), selectedMedicalUserId).export();\n+            }\n+            else{\n+                String[] permissions \u003d {Manifest.permission.WRITE_EXTERNAL_STORAGE};\n+                UtilsRG.requestPermission(getActivity(), permissions, ExportViaCSV.REQUEST_CODE_WRITE_EXTERNAL_STORAGE);\n+            }\n         }\n         return super.onContextItemSelected(item);\n     }\n \n     @Override\n+    public void onRequestPermissionsResult(int requestCode, String permissions[], int[] grantResults) {\n+        switch (requestCode) {\n+            case ExportViaCSV.REQUEST_CODE_WRITE_EXTERNAL_STORAGE:\n+                if (grantResults.length \u003e 0 \u0026\u0026 grantResults[0] \u003d\u003d PackageManager.PERMISSION_GRANTED) {\n+                    UtilsRG.info(\"Permission Granted: ExportViaCSV.REQUEST_CODE_WRITE_EXTERNAL_STORAGE\");\n+                    new ExportViaCSV(getActivity(), selectedMedicalUserId).export();\n+                } else {\n+                    UtilsRG.info(\"Permission Denied: ExportViaCSV.REQUEST_CODE_WRITE_EXTERNAL_STORAGE\");\n+                }\n+                break;\n+        }\n+    }\n+\n+    @Override\n     public void onActivityCreated(final Bundle savedInstanceState) {\n         UtilsRG.info(UserManagementFragmentListView.class.getSimpleName() + \" onActivityCreated\");\n         super.onActivityCreated(savedInstanceState);"
        },
        {
          "file_name": "ReactionTest/app/src/main/res/xml/settings_preference_screen.xml",
          "patch": "@@ -15,15 +15,17 @@\n \n     \u003cPreferenceCategory android:title\u003d\"@string/go_game_settings\"\u003e\n         \u003ccom.artursworld.reactiontest.view.settings.NumberPickerPreference\n-            android:defaultValue\u003d\"3\"\n+            android:defaultValue\u003d\"1\"\n             android:key\u003d\"go_game_tries_per_game\"\n             android:title\u003d\"@string/set_go_game_reaction_test_count_per_game\" /\u003e\n \n         \u003ccom.artursworld.reactiontest.view.settings.NumberPickerPreference\n+            android:defaultValue\u003d\"1\"\n             android:key\u003d\"@string/go_game_countdown_count\"\n             android:title\u003d\"@string/set_go_no_go_game_count_down_count\" /\u003e\n \n         \u003ccom.artursworld.reactiontest.view.settings.NumberPickerPreference\n+            android:defaultValue\u003d\"2\"\n             android:key\u003d\"@string/go_game_max_random_waiting_time\"\n             android:title\u003d\"@string/set_go_game_max_random_waiting_time\" /\u003e\n     \u003c/PreferenceCategory\u003e"
        }
      ]
    }
  },
  {
    "name": "Make consumer apps work on non-Android 6 devices",
    "url": "https://github.com/dimagi/commcare-android/pull/1299",
    "description": "Since I had placed the installation code for single app installs after the permissions checks, the install just didn\u0027t happen on devices that don\u0027t check for permissions... This was dumb, I should have realized this earlier. \n",
    "keywords": [],
    "code": {
      "language": "Java",
      "url": "https://github.com/dimagi/commcare-android/commit/ef52d4913d097baaa996f67d5882cc0a210543ea",
      "files": [
        {
          "file_name": "app/src/org/commcare/activities/CommCareSetupActivity.java",
          "patch": "@@ -196,9 +196,12 @@ protected void onCreate(Bundle savedInstanceState) {\n                 Permissions.acquireAllAppPermissions(this, this,\r\n                         Permissions.ALL_PERMISSIONS_REQUEST);\r\n         if (!askingForPerms) {\r\n-            // With basic perms satisfied, ask user to allow SMS reading for\r\n-            // sms app install code\r\n-            performSMSInstall(false);\r\n+            if (isSingleAppBuild()) {\r\n+                SingleAppInstallation.installSingleApp(this, DIALOG_INSTALL_PROGRESS);\r\n+            } else {\r\n+                // With basic perms satisfied, ask user to allow SMS reading for sms app install code\r\n+                performSMSInstall(false);\r\n+            }\r\n         }\r\n     }\r\n \r\n@@ -843,10 +846,6 @@ public void onRequestPermissionsResult(int requestCode,\n                     scanSMSLinks(manualSMSInstall);\r\n                 }\r\n             }\r\n-\r\n-            if (isSingleAppBuild()) {\r\n-                SingleAppInstallation.installSingleApp(this, DIALOG_INSTALL_PROGRESS);\r\n-            }\r\n         } else if (requestCode \u003d\u003d Permissions.ALL_PERMISSIONS_REQUEST) {\r\n             String[] requiredPerms \u003d Permissions.getRequiredPerms();\r\n \r\n@@ -867,8 +866,12 @@ public void onRequestPermissionsResult(int requestCode,\n                 uiStateScreenTransition();\r\n             }\r\n \r\n-            // Since SMS asks for more permissions, call was delayed until here\r\n-            performSMSInstall(false);\r\n+            if (isSingleAppBuild()) {\r\n+                SingleAppInstallation.installSingleApp(this, DIALOG_INSTALL_PROGRESS);\r\n+            } else {\r\n+                // Since SMS asks for more permissions, call was delayed until here\r\n+                performSMSInstall(false);\r\n+            }\r\n         }\r\n     }\r\n \r"
        }
      ]
    }
  },
  {
    "name": "Trimmed titles and wrong footer paddings on Android 2.3.6",
    "url": "https://github.com/nakardo/ATableView/issues/6",
    "description": "",
    "keywords": [],
    "code": {
      "language": "Java",
      "url": "https://github.com/nakardo/ATableView/commit/c67e4bd6d6eae30a6909fdb76511f1bc180fd4a0",
      "files": [
        {
          "file_name": "library/res/layout/atv_grouped_footer.xml",
          "patch": "@@ -1,18 +1,14 @@\n \u003c?xml version\u003d\"1.0\" encoding\u003d\"utf-8\"?\u003e\n-\u003cFrameLayout xmlns:android\u003d\"http://schemas.android.com/apk/res/android\"\n+\u003cmerge xmlns:android\u003d\"http://schemas.android.com/apk/res/android\"\n     android:layout_width\u003d\"match_parent\"\n     android:layout_height\u003d\"wrap_content\"\n     android:minHeight\u003d\"@dimen/atv_grouped_section_header_footer_min_height\" \u003e\n \n     \u003ccom.nakardo.atableview.uikit.UILabel\n         android:id\u003d\"@+id/textLabel\"\n         style\u003d\"@style/Widget.ATableView.Section.Grouped.Footer.TextLabel\"\n-        android:layout_width\u003d\"fill_parent\"\n+        android:layout_width\u003d\"match_parent\"\n         android:layout_height\u003d\"wrap_content\"\n-        android:layout_marginBottom\u003d\"@dimen/atv_grouped_section_footer_text_margin_bottom\"\n-        android:layout_marginLeft\u003d\"@dimen/atv_grouped_section_header_footer_text_margin_left_right\"\n-        android:layout_marginRight\u003d\"@dimen/atv_grouped_section_header_footer_text_margin_left_right\"\n-        android:layout_marginTop\u003d\"@dimen/atv_grouped_section_header_footer_text_margin_top_bottom\"\n         android:visibility\u003d\"gone\" /\u003e\n \n-\u003c/FrameLayout\u003e\n\\ No newline at end of file\n+\u003c/merge\u003e\n\\ No newline at end of file"
        },
        {
          "file_name": "library/res/layout/atv_grouped_header.xml",
          "patch": "@@ -1,19 +1,14 @@\n \u003c?xml version\u003d\"1.0\" encoding\u003d\"utf-8\"?\u003e\n-\u003cFrameLayout xmlns:android\u003d\"http://schemas.android.com/apk/res/android\"\n+\u003cmerge xmlns:android\u003d\"http://schemas.android.com/apk/res/android\"\n     android:layout_width\u003d\"match_parent\"\n     android:layout_height\u003d\"wrap_content\"\n     android:minHeight\u003d\"@dimen/atv_grouped_section_header_footer_min_height\" \u003e\n \n     \u003ccom.nakardo.atableview.uikit.UILabel\n         android:id\u003d\"@+id/textLabel\"\n         style\u003d\"@style/Widget.ATableView.Section.Grouped.Header.TextLabel\"\n-        android:layout_width\u003d\"fill_parent\"\n+        android:layout_width\u003d\"match_parent\"\n         android:layout_height\u003d\"wrap_content\"\n-        android:layout_gravity\u003d\"bottom\"\n-        android:layout_marginTop\u003d\"@dimen/atv_grouped_section_header_text_margin_top\"\n-        android:layout_marginBottom\u003d\"@dimen/atv_grouped_section_header_footer_text_margin_top_bottom\"\n-        android:layout_marginLeft\u003d\"@dimen/atv_grouped_section_header_footer_text_margin_left_right\"\n-        android:layout_marginRight\u003d\"@dimen/atv_grouped_section_header_footer_text_margin_left_right\"\n         android:visibility\u003d\"gone\" /\u003e\n \n-\u003c/FrameLayout\u003e\n\\ No newline at end of file\n+\u003c/merge\u003e\n\\ No newline at end of file"
        },
        {
          "file_name": "library/res/layout/atv_plain_header_footer.xml",
          "patch": "@@ -1,16 +1,13 @@\n \u003c?xml version\u003d\"1.0\" encoding\u003d\"utf-8\"?\u003e\n \u003cFrameLayout xmlns:android\u003d\"http://schemas.android.com/apk/res/android\"\n     android:layout_width\u003d\"match_parent\"\n-    android:layout_height\u003d\"wrap_content\"\n-    android:background\u003d\"@drawable/plain_header_background\" \u003e\n+    android:layout_height\u003d\"match_parent\" \u003e\n \n     \u003ccom.nakardo.atableview.uikit.UILabel\n         android:id\u003d\"@+id/textLabel\"\n         style\u003d\"@style/Widget.ATableView.Section.Plain.Header.TextLabel\"\n         android:layout_width\u003d\"fill_parent\"\n         android:layout_height\u003d\"wrap_content\"\n-        android:layout_gravity\u003d\"center\"\n-        android:layout_marginLeft\u003d\"@dimen/atv_plain_section_header_text_margin_left\"\n-        android:layout_marginRight\u003d\"@dimen/atv_plain_section_header_text_margin_right\" /\u003e\n+        android:layout_gravity\u003d\"center_vertical\" /\u003e\n \n \u003c/FrameLayout\u003e\n\\ No newline at end of file"
        },
        {
          "file_name": "library/res/values/dimens.xml",
          "patch": "@@ -3,24 +3,24 @@\n     \n     \u003c!-- plain table header --\u003e\n     \u003cdimen name\u003d\"atv_plain_header_text_size\"\u003e18sp\u003c/dimen\u003e\n-    \u003cdimen name\u003d\"atv_plain_section_header_text_margin_left\"\u003e15dp\u003c/dimen\u003e\n-    \u003cdimen name\u003d\"atv_plain_section_header_text_margin_right\"\u003e20dp\u003c/dimen\u003e\n+    \u003cdimen name\u003d\"atv_plain_section_header_padding_left\"\u003e15dp\u003c/dimen\u003e\n+    \u003cdimen name\u003d\"atv_plain_section_header_padding_right\"\u003e20dp\u003c/dimen\u003e\n     \u003cdimen name\u003d\"atv_plain_section_header_height\"\u003e24px\u003c/dimen\u003e\n     \n     \u003c!-- grouped table header \u0026 footer --\u003e\n-    \u003cdimen name\u003d\"atv_grouped_section_header_footer_text_margin_top_bottom\"\u003e8dp\u003c/dimen\u003e\n-    \u003cdimen name\u003d\"atv_grouped_section_header_footer_text_margin_left_right\"\u003e20dp\u003c/dimen\u003e\n+    \u003cdimen name\u003d\"atv_grouped_section_header_footer_padding_top_bottom\"\u003e8dp\u003c/dimen\u003e\n+    \u003cdimen name\u003d\"atv_grouped_section_header_footer_padding_left_right\"\u003e20dp\u003c/dimen\u003e\n     \u003cdimen name\u003d\"atv_grouped_section_header_footer_min_height\"\u003e10dp\u003c/dimen\u003e\n     \n     \u003c!-- grouped table header --\u003e\n     \u003cdimen name\u003d\"atv_grouped_section_header_text_size\"\u003e20sp\u003c/dimen\u003e\n-    \u003cdimen name\u003d\"atv_grouped_section_header_first_row_text_margin_top\"\u003e16dp\u003c/dimen\u003e\n-    \u003cdimen name\u003d\"atv_grouped_section_header_text_margin_top\"\u003e6dp\u003c/dimen\u003e\n+    \u003cdimen name\u003d\"atv_grouped_section_header_first_row_padding_top\"\u003e16dp\u003c/dimen\u003e\n+    \u003cdimen name\u003d\"atv_grouped_section_header_padding_top\"\u003e6dp\u003c/dimen\u003e\n     \n     \u003c!-- grouped table footer --\u003e\n     \u003cdimen name\u003d\"atv_grouped_section_footer_text_size\"\u003e18sp\u003c/dimen\u003e\n-    \u003cdimen name\u003d\"atv_grouped_section_footer_last_row_text_margin_bottom\"\u003e10dp\u003c/dimen\u003e\n-    \u003cdimen name\u003d\"atv_grouped_section_footer_text_margin_bottom\"\u003e6dp\u003c/dimen\u003e\n+    \u003cdimen name\u003d\"atv_grouped_section_footer_last_row_padding_bottom\"\u003e10dp\u003c/dimen\u003e\n+    \u003cdimen name\u003d\"atv_grouped_section_footer_padding_bottom\"\u003e6dp\u003c/dimen\u003e\n     \n     \u003c!-- grouped style cell --\u003e\n     \u003cdimen name\u003d\"atv_cell_grouped_margins\"\u003e10dp\u003c/dimen\u003e"
        },
        {
          "file_name": "library/src/com/nakardo/atableview/internal/ATableViewAdapter.java",
          "patch": "@@ -10,7 +10,6 @@\n import android.view.View;\n import android.view.ViewGroup;\n import android.widget.BaseAdapter;\n-import android.widget.FrameLayout;\n import android.widget.ListView;\n import android.widget.TextView;\n \n@@ -274,9 +273,8 @@ private ATableViewHeaderFooterCell getReusableHeaderFooterCell(View convertView,\n \t\n \tprivate void setupHeaderFooterRowLayout(ATableViewHeaderFooterCell cell, NSIndexPath indexPath, boolean isFooterRow) {\n \t\tATableViewDataSource dataSource \u003d mTableView.getDataSource();\n-\t\tATableViewStyle tableViewStyle \u003d mTableView.getStyle();\n \t\tint section \u003d indexPath.getSection();\n-\t\t\n+\t\tResources res \u003d mTableView.getResources();\n \t\tTextView textLabel \u003d cell.getTextLabel();\n \t\t\n \t\t// get text.\n@@ -288,31 +286,34 @@ private void setupHeaderFooterRowLayout(ATableViewHeaderFooterCell cell, NSIndex\n \t\t}\n \t\ttextLabel.setText(headerText);\n \t\t\n-\t\t// setup layout depending on style.\n-\t\tif (tableViewStyle \u003d\u003d ATableViewStyle.Grouped) {\n-\t\t\tResources res \u003d mTableView.getResources();\n-\t\t\tFrameLayout.LayoutParams params \u003d (FrameLayout.LayoutParams) textLabel.getLayoutParams();\n+\t\t// setup layout and background depending on table style.\n+\t\tRect padding \u003d new Rect();\n+\t\tif (mTableView.getStyle() \u003d\u003d ATableViewStyle.Grouped) {\n+\t\t\tpadding.left \u003d padding.right \u003d (int) res.getDimension(R.dimen.atv_grouped_section_header_footer_padding_left_right);\n \t\t\t\n-\t\t\t// if we\u0027re on the very first header of the table, we\u0027ve to add an extra margin top to textView.\n-\t\t\tint marginTop \u003d (int) res.getDimension(R.dimen.atv_grouped_section_header_text_margin_top);\n+\t\t\t// if we\u0027re on the very first header of the table, we\u0027ve to add an extra padding top to the cell.\n+\t\t\tpadding.top \u003d (int) res.getDimension(R.dimen.atv_grouped_section_header_padding_top);\n \t\t\tif (!isFooterRow \u0026\u0026 section \u003d\u003d 0) {\n-\t\t\t\tmarginTop \u003d (int) res.getDimension(R.dimen.atv_grouped_section_header_first_row_text_margin_top);\n+\t\t\t\tpadding.top \u003d (int) res.getDimension(R.dimen.atv_grouped_section_header_first_row_padding_top);\n \t\t\t}\n-\t\t\tparams.topMargin \u003d marginTop;\n \t\t\t\n-\t\t\t// if we\u0027re on the last footer of the table, extra margin applies here as well.\n-\t\t\tint marginBottom \u003d (int) res.getDimension(R.dimen.atv_grouped_section_footer_text_margin_bottom);\n+\t\t\t// if we\u0027re on the last footer of the table, extra padding applies here as well.\n+\t\t\tpadding.bottom \u003d (int) res.getDimension(R.dimen.atv_grouped_section_footer_padding_bottom);\n \t\t\tif (isFooterRow \u0026\u0026 section \u003d\u003d mRows.size() - 1) {\n-\t\t\t\tmarginBottom \u003d (int) res.getDimension(R.dimen.atv_grouped_section_footer_last_row_text_margin_bottom);\t\t\t\n+\t\t\t\tpadding.bottom \u003d (int) res.getDimension(R.dimen.atv_grouped_section_footer_last_row_padding_bottom);\t\t\t\n \t\t\t}\n-\t\t\tparams.bottomMargin \u003d marginBottom;\n-\t\t\t\n-\t\t\ttextLabel.setLayoutParams(params);\n \t\t\t\n \t\t\t// hide header or footer text if it\u0027s null.\n \t\t\tint visibility \u003d headerText !\u003d null \u0026\u0026 headerText.length() \u003e 0 ? View.VISIBLE : View.GONE;\n \t\t\ttextLabel.setVisibility(visibility);\n+\t\t} else {\n+\t\t\tpadding.left \u003d (int) res.getDimension(R.dimen.atv_plain_section_header_padding_left);\n+\t\t\tpadding.right \u003d (int) res.getDimension(R.dimen.atv_plain_section_header_padding_right);\n+\t\t\t\n+\t\t\t// set background for plain style.\n+\t\t\tcell.setBackgroundResource(R.drawable.plain_header_background);\n \t\t}\n+\t\tcell.setPadding(padding.left, padding.top, padding.right, padding.bottom);\n \t\t\n \t\t// setup layout height.\n \t\tint rowHeight \u003d getHeaderFooterRowHeight(indexPath, isFooterRow);"
        },
        {
          "file_name": "library/src/com/nakardo/atableview/internal/ATableViewHeaderFooterCell.java",
          "patch": "@@ -2,7 +2,6 @@\n \n import android.content.Context;\n import android.view.LayoutInflater;\n-import android.view.View;\n import android.widget.FrameLayout;\n \n import com.nakardo.atableview.R;\n@@ -25,16 +24,14 @@ protected static int getLayout(ATableViewHeaderFooterCellType type, ATableView t\n \t\t\treturn R.layout.atv_grouped_footer;\n \t\t}\n \t\t\n-\t\treturn R.layout.atv_plain_header;\n+\t\treturn R.layout.atv_plain_header_footer;\n \t}\n \t\n \tpublic ATableViewHeaderFooterCell(ATableViewHeaderFooterCellType type, ATableView tableView) {\n \t\tsuper(tableView.getContext());\n-\t\tLayoutInflater inflater \u003d LayoutInflater.from(tableView.getContext());\n+\t\tLayoutInflater.from(getContext()).inflate(getLayout(type, tableView), this, true);\n \t\t\n-\t\tView headerFooterView \u003d inflater.inflate(getLayout(type, tableView), null);\n-\t\tmTextLabel \u003d (UILabel) headerFooterView.findViewById(R.id.textLabel);\n-\t\taddView(headerFooterView);\n+\t\tmTextLabel \u003d (UILabel) findViewById(R.id.textLabel);\n \t}\n \t\n \tpublic ATableViewHeaderFooterCell(Context context) {"
        }
      ]
    }
  },
  {
    "name": "does not working with android 6",
    "url": "https://github.com/manumaticx/Ti.DrawerLayout/issues/69",
    "description": "this made my app crushes with android 6 .. need updates\n",
    "keywords": [],
    "code": {
      "language": "Java",
      "url": "https://github.com/manumaticx/Ti.DrawerLayout/commit/bd273913fb2d5dcee76593a83e651a24365258c6",
      "files": [
        {
          "file_name": "README.md",
          "patch": "@@ -1,4 +1,4 @@\n-# Ti.DrawerLayout [![gittio](http://img.shields.io/badge/gittio-1.4.1-00B4CC.svg)](http://gitt.io/component/com.tripvi.drawerlayout)\n+# Ti.DrawerLayout [![gittio](http://img.shields.io/badge/gittio-1.4.2-00B4CC.svg)](http://gitt.io/component/com.tripvi.drawerlayout)\n Native Android [Navigation Drawer](http://developer.android.com/design/patterns/navigation-drawer.html) for [Titanium](http://www.appcelerator.com/titanium/)\n \n - [Overview](#overview)"
        },
        {
          "file_name": "android/dist/com.tripvi.drawerlayout-android-1.4.1.zip"
        },
        {
          "file_name": "android/dist/com.tripvi.drawerlayout-android-1.4.2.zip"
        },
        {
          "file_name": "android/dist/drawerlayout.jar"
        },
        {
          "file_name": "android/manifest",
          "patch": "@@ -1,4 +1,4 @@\n-version: 1.4.1\n+version: 1.4.2\n apiversion: 2\n description: Native Android DrawerLayout for Titanium\n author: metacortex, manumaticx"
        },
        {
          "file_name": "package.json",
          "patch": "@@ -1,7 +1,7 @@\n {\n   \"name\": \"drawerlayout\",\n   \"id\": \"com.tripvi.drawerlayout\",\n-  \"version\": \"1.4.1\",\n+  \"version\": \"1.4.2\",\n   \"description\": \"Android Drawer for Titanium \",\n   \"license\": \"MIT\",\n   \"devDependencies\": {"
        }
      ]
    }
  },
  {
    "name": "Request dangerous permissions for Android 6.0",
    "url": "https://github.com/lgallard/qBittorrent-Controller/issues/65",
    "description": "For Android 6.0 and target SDK 23 some permission are considered dangerous and must be requested when the app is running.\n\nMore info http://developer.android.com/intl/es/training/permissions/requesting.html#perm-request and http://developer.android.com/intl/es/guide/topics/security/permissions.html#normal-dangerous\n\nReported by Roberto Herreros via email\n",
    "keywords": [
      "android"
    ],
    "code": {
      "language": "Java",
      "url": "https://github.com/lgallard/qBittorrent-Controller/commit/140edb927ca17826ed0071b34be88fa7e5e20b08",
      "files": [
        {
          "file_name": "app/app.iml",
          "patch": "@@ -1,5 +1,5 @@\n \u003c?xml version\u003d\"1.0\" encoding\u003d\"UTF-8\"?\u003e\n-\u003cmodule external.linked.project.id\u003d\":app\" external.linked.project.path\u003d\"$MODULE_DIR$\" external.root.project.path\u003d\"$MODULE_DIR$/..\" external.system.id\u003d\"GRADLE\" external.system.module.group\u003d\"qBittorrent-Controller\" external.system.module.version\u003d\"unspecified\" type\u003d\"JAVA_MODULE\" version\u003d\"4\"\u003e\n+\u003cmodule external.linked.project.id\u003d\":app\" external.linked.project.path\u003d\"$MODULE_DIR$\" external.root.project.path\u003d\"$MODULE_DIR$/..\" external.system.id\u003d\"GRADLE\" external.system.module.group\u003d\"qBittorrent-Client\" external.system.module.version\u003d\"unspecified\" type\u003d\"JAVA_MODULE\" version\u003d\"4\"\u003e\n   \u003ccomponent name\u003d\"FacetManager\"\u003e\n     \u003cfacet type\u003d\"android-gradle\" name\u003d\"Android-Gradle\"\u003e\n       \u003cconfiguration\u003e\n@@ -41,19 +41,19 @@\n       \u003csourceFolder url\u003d\"file://$MODULE_DIR$/src/proDebug/java\" isTestSource\u003d\"false\" /\u003e\n       \u003csourceFolder url\u003d\"file://$MODULE_DIR$/src/proDebug/jni\" isTestSource\u003d\"false\" /\u003e\n       \u003csourceFolder url\u003d\"file://$MODULE_DIR$/src/proDebug/rs\" isTestSource\u003d\"false\" /\u003e\n-      \u003csourceFolder url\u003d\"file://$MODULE_DIR$/build/generated/source/r/androidTest/pro/debug\" isTestSource\u003d\"true\" generated\u003d\"true\" /\u003e\n-      \u003csourceFolder url\u003d\"file://$MODULE_DIR$/build/generated/source/aidl/androidTest/pro/debug\" isTestSource\u003d\"true\" generated\u003d\"true\" /\u003e\n-      \u003csourceFolder url\u003d\"file://$MODULE_DIR$/build/generated/source/buildConfig/androidTest/pro/debug\" isTestSource\u003d\"true\" generated\u003d\"true\" /\u003e\n-      \u003csourceFolder url\u003d\"file://$MODULE_DIR$/build/generated/source/rs/androidTest/pro/debug\" isTestSource\u003d\"true\" generated\u003d\"true\" /\u003e\n-      \u003csourceFolder url\u003d\"file://$MODULE_DIR$/build/generated/res/rs/androidTest/pro/debug\" type\u003d\"java-test-resource\" /\u003e\n-      \u003csourceFolder url\u003d\"file://$MODULE_DIR$/build/generated/res/resValues/androidTest/pro/debug\" type\u003d\"java-test-resource\" /\u003e\n       \u003csourceFolder url\u003d\"file://$MODULE_DIR$/src/testProDebug/res\" type\u003d\"java-test-resource\" /\u003e\n       \u003csourceFolder url\u003d\"file://$MODULE_DIR$/src/testProDebug/resources\" type\u003d\"java-test-resource\" /\u003e\n       \u003csourceFolder url\u003d\"file://$MODULE_DIR$/src/testProDebug/assets\" type\u003d\"java-test-resource\" /\u003e\n       \u003csourceFolder url\u003d\"file://$MODULE_DIR$/src/testProDebug/aidl\" isTestSource\u003d\"true\" /\u003e\n       \u003csourceFolder url\u003d\"file://$MODULE_DIR$/src/testProDebug/java\" isTestSource\u003d\"true\" /\u003e\n       \u003csourceFolder url\u003d\"file://$MODULE_DIR$/src/testProDebug/jni\" isTestSource\u003d\"true\" /\u003e\n       \u003csourceFolder url\u003d\"file://$MODULE_DIR$/src/testProDebug/rs\" isTestSource\u003d\"true\" /\u003e\n+      \u003csourceFolder url\u003d\"file://$MODULE_DIR$/build/generated/source/r/androidTest/pro/debug\" isTestSource\u003d\"true\" generated\u003d\"true\" /\u003e\n+      \u003csourceFolder url\u003d\"file://$MODULE_DIR$/build/generated/source/aidl/androidTest/pro/debug\" isTestSource\u003d\"true\" generated\u003d\"true\" /\u003e\n+      \u003csourceFolder url\u003d\"file://$MODULE_DIR$/build/generated/source/buildConfig/androidTest/pro/debug\" isTestSource\u003d\"true\" generated\u003d\"true\" /\u003e\n+      \u003csourceFolder url\u003d\"file://$MODULE_DIR$/build/generated/source/rs/androidTest/pro/debug\" isTestSource\u003d\"true\" generated\u003d\"true\" /\u003e\n+      \u003csourceFolder url\u003d\"file://$MODULE_DIR$/build/generated/res/rs/androidTest/pro/debug\" type\u003d\"java-test-resource\" /\u003e\n+      \u003csourceFolder url\u003d\"file://$MODULE_DIR$/build/generated/res/resValues/androidTest/pro/debug\" type\u003d\"java-test-resource\" /\u003e\n       \u003csourceFolder url\u003d\"file://$MODULE_DIR$/src/pro/res\" type\u003d\"java-resource\" /\u003e\n       \u003csourceFolder url\u003d\"file://$MODULE_DIR$/src/pro/resources\" type\u003d\"java-resource\" /\u003e\n       \u003csourceFolder url\u003d\"file://$MODULE_DIR$/src/pro/assets\" type\u003d\"java-resource\" /\u003e\n@@ -96,29 +96,31 @@\n       \u003csourceFolder url\u003d\"file://$MODULE_DIR$/src/main/java\" isTestSource\u003d\"false\" /\u003e\n       \u003csourceFolder url\u003d\"file://$MODULE_DIR$/src/main/jni\" isTestSource\u003d\"false\" /\u003e\n       \u003csourceFolder url\u003d\"file://$MODULE_DIR$/src/main/rs\" isTestSource\u003d\"false\" /\u003e\n-      \u003csourceFolder url\u003d\"file://$MODULE_DIR$/src/test/res\" type\u003d\"java-test-resource\" /\u003e\n-      \u003csourceFolder url\u003d\"file://$MODULE_DIR$/src/test/resources\" type\u003d\"java-test-resource\" /\u003e\n-      \u003csourceFolder url\u003d\"file://$MODULE_DIR$/src/test/assets\" type\u003d\"java-test-resource\" /\u003e\n-      \u003csourceFolder url\u003d\"file://$MODULE_DIR$/src/test/aidl\" isTestSource\u003d\"true\" /\u003e\n-      \u003csourceFolder url\u003d\"file://$MODULE_DIR$/src/test/java\" isTestSource\u003d\"true\" /\u003e\n-      \u003csourceFolder url\u003d\"file://$MODULE_DIR$/src/test/jni\" isTestSource\u003d\"true\" /\u003e\n-      \u003csourceFolder url\u003d\"file://$MODULE_DIR$/src/test/rs\" isTestSource\u003d\"true\" /\u003e\n       \u003csourceFolder url\u003d\"file://$MODULE_DIR$/src/androidTest/res\" type\u003d\"java-test-resource\" /\u003e\n       \u003csourceFolder url\u003d\"file://$MODULE_DIR$/src/androidTest/resources\" type\u003d\"java-test-resource\" /\u003e\n       \u003csourceFolder url\u003d\"file://$MODULE_DIR$/src/androidTest/assets\" type\u003d\"java-test-resource\" /\u003e\n       \u003csourceFolder url\u003d\"file://$MODULE_DIR$/src/androidTest/aidl\" isTestSource\u003d\"true\" /\u003e\n       \u003csourceFolder url\u003d\"file://$MODULE_DIR$/src/androidTest/java\" isTestSource\u003d\"true\" /\u003e\n       \u003csourceFolder url\u003d\"file://$MODULE_DIR$/src/androidTest/jni\" isTestSource\u003d\"true\" /\u003e\n       \u003csourceFolder url\u003d\"file://$MODULE_DIR$/src/androidTest/rs\" isTestSource\u003d\"true\" /\u003e\n+      \u003csourceFolder url\u003d\"file://$MODULE_DIR$/src/test/res\" type\u003d\"java-test-resource\" /\u003e\n+      \u003csourceFolder url\u003d\"file://$MODULE_DIR$/src/test/resources\" type\u003d\"java-test-resource\" /\u003e\n+      \u003csourceFolder url\u003d\"file://$MODULE_DIR$/src/test/assets\" type\u003d\"java-test-resource\" /\u003e\n+      \u003csourceFolder url\u003d\"file://$MODULE_DIR$/src/test/aidl\" isTestSource\u003d\"true\" /\u003e\n+      \u003csourceFolder url\u003d\"file://$MODULE_DIR$/src/test/java\" isTestSource\u003d\"true\" /\u003e\n+      \u003csourceFolder url\u003d\"file://$MODULE_DIR$/src/test/jni\" isTestSource\u003d\"true\" /\u003e\n+      \u003csourceFolder url\u003d\"file://$MODULE_DIR$/src/test/rs\" isTestSource\u003d\"true\" /\u003e\n       \u003cexcludeFolder url\u003d\"file://$MODULE_DIR$/build/intermediates/assets\" /\u003e\n       \u003cexcludeFolder url\u003d\"file://$MODULE_DIR$/build/intermediates/classes\" /\u003e\n       \u003cexcludeFolder url\u003d\"file://$MODULE_DIR$/build/intermediates/dependency-cache\" /\u003e\n       \u003cexcludeFolder url\u003d\"file://$MODULE_DIR$/build/intermediates/dex\" /\u003e\n-      \u003cexcludeFolder url\u003d\"file://$MODULE_DIR$/build/intermediates/exploded-aar/com.android.support/appcompat-v7/23.1.1/jars\" /\u003e\n+      \u003cexcludeFolder url\u003d\"file://$MODULE_DIR$/build/intermediates/exploded-aar/com.android.support/animated-vector-drawable/23.2.0/jars\" /\u003e\n+      \u003cexcludeFolder url\u003d\"file://$MODULE_DIR$/build/intermediates/exploded-aar/com.android.support/appcompat-v7/23.2.0/jars\" /\u003e\n       \u003cexcludeFolder url\u003d\"file://$MODULE_DIR$/build/intermediates/exploded-aar/com.android.support/cardview-v7/23.1.1/jars\" /\u003e\n-      \u003cexcludeFolder url\u003d\"file://$MODULE_DIR$/build/intermediates/exploded-aar/com.android.support/design/23.1.1/jars\" /\u003e\n-      \u003cexcludeFolder url\u003d\"file://$MODULE_DIR$/build/intermediates/exploded-aar/com.android.support/recyclerview-v7/23.1.1/jars\" /\u003e\n-      \u003cexcludeFolder url\u003d\"file://$MODULE_DIR$/build/intermediates/exploded-aar/com.android.support/support-v4/23.1.1/jars\" /\u003e\n+      \u003cexcludeFolder url\u003d\"file://$MODULE_DIR$/build/intermediates/exploded-aar/com.android.support/design/23.2.0/jars\" /\u003e\n+      \u003cexcludeFolder url\u003d\"file://$MODULE_DIR$/build/intermediates/exploded-aar/com.android.support/recyclerview-v7/23.2.0/jars\" /\u003e\n+      \u003cexcludeFolder url\u003d\"file://$MODULE_DIR$/build/intermediates/exploded-aar/com.android.support/support-v4/23.2.0/jars\" /\u003e\n+      \u003cexcludeFolder url\u003d\"file://$MODULE_DIR$/build/intermediates/exploded-aar/com.android.support/support-vector-drawable/23.2.0/jars\" /\u003e\n       \u003cexcludeFolder url\u003d\"file://$MODULE_DIR$/build/intermediates/exploded-aar/com.google.android.gms/play-services-ads/7.3.0/jars\" /\u003e\n       \u003cexcludeFolder url\u003d\"file://$MODULE_DIR$/build/intermediates/exploded-aar/com.google.android.gms/play-services-analytics/7.3.0/jars\" /\u003e\n       \u003cexcludeFolder url\u003d\"file://$MODULE_DIR$/build/intermediates/exploded-aar/com.google.android.gms/play-services-appindexing/7.3.0/jars\" /\u003e\n@@ -140,7 +142,7 @@\n       \u003cexcludeFolder url\u003d\"file://$MODULE_DIR$/build/intermediates/exploded-aar/com.google.android.gms/play-services-wallet/7.3.0/jars\" /\u003e\n       \u003cexcludeFolder url\u003d\"file://$MODULE_DIR$/build/intermediates/exploded-aar/com.google.android.gms/play-services-wearable/7.3.0/jars\" /\u003e\n       \u003cexcludeFolder url\u003d\"file://$MODULE_DIR$/build/intermediates/exploded-aar/com.google.android.gms/play-services/7.3.0/jars\" /\u003e\n-      \u003cexcludeFolder url\u003d\"file://$MODULE_DIR$/build/intermediates/exploded-aar/com.nbsp/library/1.03/jars\" /\u003e\n+      \u003cexcludeFolder url\u003d\"file://$MODULE_DIR$/build/intermediates/exploded-aar/com.nbsp/library/1.04/jars\" /\u003e\n       \u003cexcludeFolder url\u003d\"file://$MODULE_DIR$/build/intermediates/incremental\" /\u003e\n       \u003cexcludeFolder url\u003d\"file://$MODULE_DIR$/build/intermediates/manifests\" /\u003e\n       \u003cexcludeFolder url\u003d\"file://$MODULE_DIR$/build/intermediates/mockable-android-22.jar\" /\u003e\n@@ -162,27 +164,29 @@\n     \u003corderEntry type\u003d\"library\" exported\u003d\"\" name\u003d\"play-services-drive-7.3.0\" level\u003d\"project\" /\u003e\n     \u003corderEntry type\u003d\"library\" exported\u003d\"\" name\u003d\"play-services-analytics-7.3.0\" level\u003d\"project\" /\u003e\n     \u003corderEntry type\u003d\"library\" exported\u003d\"\" name\u003d\"play-services-panorama-7.3.0\" level\u003d\"project\" /\u003e\n-    \u003corderEntry type\u003d\"library\" exported\u003d\"\" name\u003d\"library-1.03\" level\u003d\"project\" /\u003e\n+    \u003corderEntry type\u003d\"library\" exported\u003d\"\" name\u003d\"library-1.04\" level\u003d\"project\" /\u003e\n     \u003corderEntry type\u003d\"library\" exported\u003d\"\" name\u003d\"robotium-solo-5.4.1\" level\u003d\"project\" /\u003e\n     \u003corderEntry type\u003d\"library\" exported\u003d\"\" name\u003d\"play-services-appindexing-7.3.0\" level\u003d\"project\" /\u003e\n     \u003corderEntry type\u003d\"library\" exported\u003d\"\" name\u003d\"play-services-cast-7.3.0\" level\u003d\"project\" /\u003e\n-    \u003corderEntry type\u003d\"library\" exported\u003d\"\" name\u003d\"recyclerview-v7-23.1.1\" level\u003d\"project\" /\u003e\n+    \u003corderEntry type\u003d\"library\" exported\u003d\"\" name\u003d\"recyclerview-v7-23.2.0\" level\u003d\"project\" /\u003e\n     \u003corderEntry type\u003d\"library\" exported\u003d\"\" name\u003d\"play-services-location-7.3.0\" level\u003d\"project\" /\u003e\n-    \u003corderEntry type\u003d\"library\" exported\u003d\"\" name\u003d\"support-v4-23.1.1\" level\u003d\"project\" /\u003e\n+    \u003corderEntry type\u003d\"library\" exported\u003d\"\" name\u003d\"support-v4-23.2.0\" level\u003d\"project\" /\u003e\n     \u003corderEntry type\u003d\"library\" exported\u003d\"\" name\u003d\"play-services-ads-7.3.0\" level\u003d\"project\" /\u003e\n     \u003corderEntry type\u003d\"library\" exported\u003d\"\" name\u003d\"httpclient-android-4.3.5.1\" level\u003d\"project\" /\u003e\n     \u003corderEntry type\u003d\"library\" exported\u003d\"\" name\u003d\"play-services-7.3.0\" level\u003d\"project\" /\u003e\n     \u003corderEntry type\u003d\"library\" exported\u003d\"\" name\u003d\"play-services-base-7.3.0\" level\u003d\"project\" /\u003e\n     \u003corderEntry type\u003d\"library\" exported\u003d\"\" name\u003d\"play-services-safetynet-7.3.0\" level\u003d\"project\" /\u003e\n-    \u003corderEntry type\u003d\"library\" exported\u003d\"\" name\u003d\"support-annotations-23.1.1\" level\u003d\"project\" /\u003e\n-    \u003corderEntry type\u003d\"library\" exported\u003d\"\" name\u003d\"appcompat-v7-23.1.1\" level\u003d\"project\" /\u003e\n+    \u003corderEntry type\u003d\"library\" exported\u003d\"\" name\u003d\"support-annotations-23.2.0\" level\u003d\"project\" /\u003e\n+    \u003corderEntry type\u003d\"library\" exported\u003d\"\" name\u003d\"appcompat-v7-23.2.0\" level\u003d\"project\" /\u003e\n+    \u003corderEntry type\u003d\"library\" exported\u003d\"\" name\u003d\"animated-vector-drawable-23.2.0\" level\u003d\"project\" /\u003e\n+    \u003corderEntry type\u003d\"library\" exported\u003d\"\" name\u003d\"support-vector-drawable-23.2.0\" level\u003d\"project\" /\u003e\n     \u003corderEntry type\u003d\"library\" exported\u003d\"\" name\u003d\"play-services-appinvite-7.3.0\" level\u003d\"project\" /\u003e\n     \u003corderEntry type\u003d\"library\" exported\u003d\"\" name\u003d\"play-services-gcm-7.3.0\" level\u003d\"project\" /\u003e\n     \u003corderEntry type\u003d\"library\" exported\u003d\"\" name\u003d\"httpmime-4.3.5\" level\u003d\"project\" /\u003e\n     \u003corderEntry type\u003d\"library\" exported\u003d\"\" name\u003d\"play-services-nearby-7.3.0\" level\u003d\"project\" /\u003e\n     \u003corderEntry type\u003d\"library\" exported\u003d\"\" name\u003d\"cardview-v7-23.1.1\" level\u003d\"project\" /\u003e\n     \u003corderEntry type\u003d\"library\" exported\u003d\"\" name\u003d\"play-services-fitness-7.3.0\" level\u003d\"project\" /\u003e\n-    \u003corderEntry type\u003d\"library\" exported\u003d\"\" name\u003d\"design-23.1.1\" level\u003d\"project\" /\u003e\n+    \u003corderEntry type\u003d\"library\" exported\u003d\"\" name\u003d\"design-23.2.0\" level\u003d\"project\" /\u003e\n     \u003corderEntry type\u003d\"library\" exported\u003d\"\" name\u003d\"play-services-plus-7.3.0\" level\u003d\"project\" /\u003e\n     \u003corderEntry type\u003d\"library\" exported\u003d\"\" name\u003d\"play-services-wearable-7.3.0\" level\u003d\"project\" /\u003e\n     \u003corderEntry type\u003d\"library\" exported\u003d\"\" name\u003d\"play-services-appstate-7.3.0\" level\u003d\"project\" /\u003e"
        },
        {
          "file_name": "app/build.gradle",
          "patch": "@@ -2,7 +2,7 @@ apply plugin: \u0027com.android.application\u0027\n \n android {\n \n-    buildToolsVersion \"23.0.0\"\n+    buildToolsVersion \"23.0.0   \"\n     compileSdkVersion 23\n \n     defaultConfig {\n@@ -67,7 +67,7 @@ repositories {\n \n dependencies {\n     compile \u0027com.android.support:support-v4:23.1.1\u0027\n-    compile \u0027com.android.support:appcompat-v7:23.1.1\u0027\n+    compile \u0027com.android.support:appcompat-v7:23.2.0\u0027\n     compile \u0027com.android.support:recyclerview-v7:23.1.1\u0027\n     compile \u0027com.android.support:cardview-v7:23.1.1\u0027\n     compile group: \u0027org.apache.httpcomponents\u0027, name: \u0027httpclient-android\u0027, version: \u00274.3.5.1\u0027\n@@ -78,7 +78,7 @@ dependencies {\n \n     // nbsp-team/MaterialFilePicker\n     dependencies {\n-        compile \u0027com.nbsp:library:1.03\u0027\n+        compile \u0027com.nbsp:library:1.04\u0027\n     }\n \n     // Robotium"
        },
        {
          "file_name": "app/src/main/java/com/lgallardo/qbittorrentclient/MainActivity.java",
          "patch": "@@ -1213,16 +1213,9 @@ private void addTorrentByIntent(Intent intent) {\n     private void checkDangerousPermissions() {\n \n         // Check Dangerous permissions (Android 6.0+, API 23+)\n-        Log.d(\"Debug\", \"checkDangerousPermissions invoked\");\n-\n-\n         if (ContextCompat.checkSelfPermission(this, Manifest.permission.WRITE_EXTERNAL_STORAGE) !\u003d PackageManager.PERMISSION_GRANTED) {\n \n \n-            // No explanation needed, request the permission.\n-            Log.d(\"Debug\", \"checkDangerousPermissions invoked - no explanation needed\");\n-\n-\n             // Should we show an explanation?\n             if (ActivityCompat.shouldShowRequestPermissionRationale(this, Manifest.permission.WRITE_EXTERNAL_STORAGE)) {\n                 genericOkDialog(R.string.error_permission,\n@@ -1235,6 +1228,8 @@ public void onClick(DialogInterface dialog, int which) {\n                         });\n \n             }else{\n+\n+                // No explanation needed, request the permission.\n                 ActivityCompat.requestPermissions(this, new String[]{Manifest.permission.WRITE_EXTERNAL_STORAGE, Manifest.permission.WRITE_EXTERNAL_STORAGE},\n                         MY_PERMISSIONS_REQUEST_WRITE_EXTERNAL_STORAGE);\n \n@@ -1243,7 +1238,7 @@ public void onClick(DialogInterface dialog, int which) {\n \n         } else {\n \n-            Log.d(\"Debug\", \"Permissions granted - PERMISSION_GRANTED\");\n+            // Permissions granted\n             handleUrlTorrent();\n \n         }\n@@ -1260,18 +1255,14 @@ public void onRequestPermissionsResult(int requestCode,\n                 // If request is cancelled, the result arrays are empty.\n                 if (grantResults.length \u003e 0 \u0026\u0026 grantResults[0] \u003d\u003d PackageManager.PERMISSION_GRANTED) {\n \n-                    Log.d(\"Debug\", \"Permissions granted - onRequestPermissionsResult\");\n+                    // Permissions granted\n                     handleUrlTorrent();\n \n \n                 } else {\n \n-                    // permission denied, boo! Disable the\n-                    // functionality that depends on this permission.\n+                    // Permission denied\n \n-                    Log.d(\"Debug\", \"Permissions denied\");\n-                    Log.d(\"Debug\", \"grantResults.length: \" + grantResults.length);\n-                    Log.d(\"Debug\", \"grantResults[0] \u003d \" + grantResults[0] + \"/\" + PackageManager.PERMISSION_GRANTED);\n \n                     // Should we show an explanation?\n                     if (!ActivityCompat.shouldShowRequestPermissionRationale(this, Manifest.permission.WRITE_EXTERNAL_STORAGE)) {\n@@ -1288,9 +1279,6 @@ public void onClick(DialogInterface dialog, int which) {\n                     }\n                     return;\n                 }\n-\n-                // other \u0027case\u0027 lines to check for other\n-                // permissions this app might request\n             }\n         }\n     }"
        },
        {
          "file_name": "app/src/main/java/com/lgallardo/qbittorrentclient/SettingsActivity.java",
          "patch": "@@ -27,6 +27,7 @@\n import com.nbsp.materialfilepicker.ui.FilePickerActivity;\n \n import java.util.ArrayList;\n+import java.util.regex.Pattern;\n \n public class SettingsActivity extends PreferenceActivity implements SharedPreferences.OnSharedPreferenceChangeListener {\n \n@@ -311,6 +312,7 @@ public void onCancel(DialogInterface dialog) {\n             @Override\n             public boolean onPreferenceClick(Preference preference) {\n                 Intent intent \u003d new Intent(getApplicationContext(), FilePickerActivity.class);\n+                intent.putExtra(FilePickerActivity.ARG_FILE_FILTER, Pattern.compile(\".*\\\\.bks\"));\n                 startActivityForResult(intent, 1);\n                 return true;\n             }"
        }
      ]
    }
  },
  {
    "name": "No time entry possible on Android 6.0",
    "url": "https://github.com/koelleChristian/trickytripper/issues/5",
    "description": "The entry of the date is possible on Android 6. But there is no mask to change the time. The application always chooses the actual time only.\n",
    "keywords": [
      "time"
    ],
    "code": {
      "language": "Java",
      "url": "https://github.com/koelleChristian/trickytripper/commit/3ef9782d504559b5d9727c3551177bd45a9818ef",
      "files": [
        {
          "file_name": "app/src/main/res/layout/date_picker_dialog_view.xml",
          "patch": "@@ -1,19 +1,36 @@\n \u003c?xml version\u003d\"1.0\" encoding\u003d\"utf-8\"?\u003e\n \n-\u003cLinearLayout xmlns:android\u003d\"http://schemas.android.com/apk/res/android\"\n-              android:orientation\u003d\"vertical\"\n-              android:layout_width\u003d\"match_parent\"\n-              android:layout_height\u003d\"match_parent\"\u003e\n+\u003c!--\u003cLinearLayout xmlns:android\u003d\"http://schemas.android.com/apk/res/android\"--\u003e\n+              \u003c!--android:orientation\u003d\"vertical\"--\u003e\n+              \u003c!--android:layout_width\u003d\"match_parent\"--\u003e\n+              \u003c!--android:layout_height\u003d\"match_parent\"\u003e--\u003e\n \n+    \u003cScrollView xmlns:android\u003d\"http://schemas.android.com/apk/res/android\"\n+        android:layout_width\u003d\"fill_parent\"\n+        android:layout_height\u003d\"fill_parent\"\n+        android:id\u003d\"@+id/scrollView\"\n+        android:layout_gravity\u003d\"center_horizontal\" \u003e\n \n-    \u003cDatePicker\n-            android:layout_width\u003d\"fill_parent\"\n+        \u003cLinearLayout\n+            android:orientation\u003d\"vertical\"\n+            android:layout_width\u003d\"match_parent\"\n+            android:layout_height\u003d\"match_parent\"\u003e\n+\n+\n+        \u003cDatePicker\n+            android:layout_width\u003d\"wrap_content\"\n             android:layout_height\u003d\"wrap_content\"\n             android:id\u003d\"@+id/datePicker_datePicker\"/\u003e\n \n-    \u003cTimePicker\n+\n+        \u003cTimePicker\n             android:layout_width\u003d\"wrap_content\"\n             android:layout_height\u003d\"wrap_content\"\n             android:id\u003d\"@+id/datePicker_timePicker\"\n             android:layout_gravity\u003d\"right|center_vertical\"/\u003e\n-\u003c/LinearLayout\u003e\n\\ No newline at end of file\n+\n+        \u003c/LinearLayout\u003e\n+\n+    \u003c/ScrollView\u003e\n+\n+\u003c!--\u003c/LinearLayout\u003e--\u003e\n\\ No newline at end of file"
        }
      ]
    }
  },
  {
    "name": "Signature widget crashing on Android 6",
    "url": "https://github.com/dimagi/commcare-android/pull/925",
    "description": "Signature widget was crashing on my phone upon launch. Not sure what was causing it because it looks like it wasn\u0027t crashing on 2.25. Regardless this PR addresses the crash.\n",
    "keywords": [
      "crashing"
    ],
    "code": {
      "language": "Java",
      "url": "https://github.com/dimagi/commcare-android/commit/6407feab9d56793070fa02d5bc3bf577f8fb8f2e",
      "files": [
        {
          "file_name": "app/src/org/odk/collect/android/activities/DrawActivity.java",
          "patch": "@@ -3,7 +3,6 @@\n import android.app.Activity;\n import android.content.Context;\n import android.content.pm.ActivityInfo;\n-import android.content.res.Configuration;\n import android.graphics.Bitmap;\n import android.graphics.Canvas;\n import android.graphics.Color;\n@@ -37,9 +36,8 @@\n /**\n  * Modified from the FingerPaint example found in The Android Open Source\n  * Project.\n- * \n+ *\n  * @author BehrAtherton@gmail.com\n- * \n  */\n public class DrawActivity extends Activity {\n     private static final String t \u003d \"DrawActivity\";\n@@ -59,8 +57,6 @@\n     private File output \u003d null;\n     private File savepointImage \u003d null;\n \n-    private Paint paint;\n-    private Paint pointPaint;\n     private DrawView drawView;\n     private String alertTitleString;\n \n@@ -72,7 +68,7 @@ protected void onSaveInstanceState(Bundle outState) {\n         } catch (FileNotFoundException e) {\n             e.printStackTrace();\n         }\n-        if ( savepointImage.exists() ) {\n+        if (savepointImage.exists()) {\n             outState.putString(SAVEPOINT_IMAGE, savepointImage.getAbsolutePath());\n         }\n     }\n@@ -99,7 +95,7 @@ protected void onCreate(Bundle savedInstanceState) {\n                 loadOption \u003d OPTION_DRAW;\n             }\n             // refImage can also be present if resuming a drawing\n-            Uri uri \u003d (Uri) extras.get(REF_IMAGE);\n+            Uri uri \u003d (Uri)extras.get(REF_IMAGE);\n             if (uri !\u003d null) {\n                 refImage \u003d new File(uri.getPath());\n             }\n@@ -118,7 +114,7 @@ protected void onCreate(Bundle savedInstanceState) {\n                 }\n             }\n             //sets where the result will be saved to\n-            uri \u003d (Uri) extras.get(EXTRA_OUTPUT);\n+            uri \u003d (Uri)extras.get(EXTRA_OUTPUT);\n             if (uri !\u003d null) {\n                 output \u003d new File(uri.getPath());\n             } else {\n@@ -150,60 +146,59 @@ protected void onCreate(Bundle savedInstanceState) {\n         setTitle(getString(R.string.application_name) + \" \u003e \"\n                 + getString(R.string.draw_image));\n \n-        LayoutInflater inflater \u003d (LayoutInflater) getSystemService(Context.LAYOUT_INFLATER_SERVICE);\n-        RelativeLayout v \u003d (RelativeLayout) inflater.inflate(\n+        LayoutInflater inflater \u003d (LayoutInflater)getSystemService(Context.LAYOUT_INFLATER_SERVICE);\n+        RelativeLayout v \u003d (RelativeLayout)inflater.inflate(\n                 R.layout.draw_layout, null);\n-        LinearLayout ll \u003d (LinearLayout) v.findViewById(R.id.drawViewLayout);\n+        LinearLayout ll \u003d (LinearLayout)v.findViewById(R.id.drawViewLayout);\n \n-        drawView \u003d new DrawView(this, OPTION_SIGNATURE.equals(loadOption),\n-                savepointImage, paint, pointPaint);\n-\n-        ll.addView(drawView);\n-\n-        setContentView(v);\n-\n-        paint \u003d new Paint();\n+        Paint paint \u003d new Paint();\n         paint.setAntiAlias(true);\n         paint.setDither(true);\n         paint.setStyle(Paint.Style.STROKE);\n         paint.setStrokeJoin(Paint.Join.ROUND);\n         paint.setStrokeWidth(10);\n         paint.setColor(Color.BLACK);\n \n-        pointPaint \u003d new Paint();\n+        Paint pointPaint \u003d new Paint();\n         pointPaint.setAntiAlias(true);\n         pointPaint.setDither(true);\n         pointPaint.setStyle(Paint.Style.FILL_AND_STROKE);\n         pointPaint.setStrokeWidth(10);\n         pointPaint.setColor(Color.BLACK);\n \n+        drawView \u003d new DrawView(this, OPTION_SIGNATURE.equals(loadOption),\n+                savepointImage, paint, pointPaint);\n+\n+        ll.addView(drawView);\n+\n+        setContentView(v);\n+\n         Button btnFinished \u003d (Button)findViewById(R.id.btnFinishDraw);\n         btnFinished.setOnClickListener(new View.OnClickListener() {\n             @Override\n             public void onClick(View v) {\n \n-                SaveAndClose();\n+                saveAndClose();\n             }\n         });\n         Button btnReset \u003d (Button)findViewById(R.id.btnResetDraw);\n         btnReset.setOnClickListener(new View.OnClickListener() {\n             @Override\n             public void onClick(View v) {\n-                Reset();\n+                reset();\n             }\n         });\n         Button btnCancel \u003d (Button)findViewById(R.id.btnCancelDraw);\n         btnCancel.setOnClickListener(new View.OnClickListener() {\n             @Override\n             public void onClick(View v) {\n-\n-                CancelAndClose();\n+                cancelAndClose();\n             }\n         });\n \n     }\n \n-    private void SaveAndClose() {\n+    private void saveAndClose() {\n         try {\n             saveFile(output);\n             setResult(Activity.RESULT_OK);\n@@ -215,11 +210,11 @@ private void SaveAndClose() {\n     }\n \n     private void saveFile(File f) throws FileNotFoundException {\n-        if ( drawView.getWidth() \u003d\u003d 0 || drawView.getHeight() \u003d\u003d 0 ) {\n+        if (drawView.getWidth() \u003d\u003d 0 || drawView.getHeight() \u003d\u003d 0) {\n             // apparently on 4.x, the orientation change notification can occur\n             // sometime before the view is rendered. In that case, the view\n             // dimensions will not be known.\n-            Log.e(t,\"view has zero width or zero height\");\n+            Log.e(t, \"view has zero width or zero height\");\n         } else {\n             FileOutputStream fos;\n             fos \u003d new FileOutputStream(f);\n@@ -231,12 +226,12 @@ private void saveFile(File f) throws FileNotFoundException {\n             try {\n                 fos.flush();\n                 fos.close();\n-            } catch ( Exception e) {\n+            } catch (Exception e) {\n             }\n         }\n     }\n \n-    private void Reset() {\n+    private void reset() {\n         savepointImage.delete();\n         if (!OPTION_SIGNATURE.equals(loadOption) \u0026\u0026 refImage !\u003d null\n                 \u0026\u0026 refImage.exists()) {\n@@ -246,32 +241,32 @@ private void Reset() {\n         drawView.invalidate();\n     }\n \n-    private void CancelAndClose() {\n+    private void cancelAndClose() {\n         setResult(Activity.RESULT_CANCELED);\n         this.finish();\n     }\n \n     @Override\n     public boolean onKeyDown(int keyCode, KeyEvent event) {\n         switch (keyCode) {\n-        case KeyEvent.KEYCODE_BACK:\n-\n-            createQuitDrawDialog();\n-            return true;\n-        case KeyEvent.KEYCODE_DPAD_RIGHT:\n-            if (event.isAltPressed()) {\n+            case KeyEvent.KEYCODE_BACK:\n \n                 createQuitDrawDialog();\n                 return true;\n-            }\n-            break;\n-        case KeyEvent.KEYCODE_DPAD_LEFT:\n-            if (event.isAltPressed()) {\n+            case KeyEvent.KEYCODE_DPAD_RIGHT:\n+                if (event.isAltPressed()) {\n \n-                createQuitDrawDialog();\n-                return true;\n-            }\n-            break;\n+                    createQuitDrawDialog();\n+                    return true;\n+                }\n+                break;\n+            case KeyEvent.KEYCODE_DPAD_LEFT:\n+                if (event.isAltPressed()) {\n+\n+                    createQuitDrawDialog();\n+                    return true;\n+                }\n+                break;\n         }\n         return super.onKeyDown(keyCode, event);\n     }\n@@ -286,7 +281,7 @@ private void createQuitDrawDialog() {\n         View.OnClickListener keepChangesListener \u003d new View.OnClickListener() {\n             @Override\n             public void onClick(View v) {\n-                SaveAndClose();\n+                saveAndClose();\n             }\n         };\n         DialogChoiceItem keepOption \u003d new DialogChoiceItem(getString(R.string.keep_changes), -1,\n@@ -295,7 +290,7 @@ public void onClick(View v) {\n         View.OnClickListener discardChangesListener \u003d new View.OnClickListener() {\n             @Override\n             public void onClick(View v) {\n-                CancelAndClose();\n+                cancelAndClose();\n             }\n         };\n         DialogChoiceItem discardOption \u003d new DialogChoiceItem(getString(R.string.do_not_save), -1,\n@@ -322,9 +317,11 @@ public void onClick(View v) {\n         private File mBackgroundBitmapFile;\n         private final Paint paint;\n         private final Paint pointPaint;\n+        private float mX, mY;\n \n         public DrawView(final Context c, Paint paint, Paint pointPaint) {\n             super(c);\n+\n             this.paint \u003d paint;\n             this.pointPaint \u003d pointPaint;\n             isSignature \u003d false;\n@@ -336,12 +333,13 @@ public DrawView(final Context c, Paint paint, Paint pointPaint) {\n \n         public DrawView(Context c, boolean isSignature, File f, Paint paint, Paint pointPaint) {\n             this(c, paint, pointPaint);\n+\n             this.isSignature \u003d isSignature;\n             mBackgroundBitmapFile \u003d f;\n         }\n \n         public void reset() {\n-            Display display \u003d ((WindowManager) getContext().getSystemService(\n+            Display display \u003d ((WindowManager)getContext().getSystemService(\n                     Context.WINDOW_SERVICE)).getDefaultDisplay();\n             int screenWidth \u003d display.getWidth();\n             int screenHeight \u003d display.getHeight();\n@@ -361,8 +359,9 @@ public void resetImage(int w, int h) {\n                 mBitmap \u003d Bitmap.createBitmap(w, h, Bitmap.Config.ARGB_8888);\n                 mCanvas \u003d new Canvas(mBitmap);\n                 mCanvas.drawColor(0xFFFFFFFF);\n-                if (isSignature)\n+                if (isSignature) {\n                     drawSignLine();\n+                }\n             }\n         }\n \n@@ -374,13 +373,11 @@ protected void onSizeChanged(int w, int h, int oldw, int oldh) {\n \n         @Override\n         protected void onDraw(Canvas canvas) {\n-            canvas.drawColor(R.color.grey);\n+            canvas.drawColor(getResources().getColor(R.color.grey));\n             canvas.drawBitmap(mBitmap, 0, 0, mBitmapPaint);\n             canvas.drawPath(mCurrentPath, paint);\n         }\n \n-        private float mX, mY;\n-\n         private void touch_start(float x, float y) {\n             mCurrentPath.reset();\n             mCurrentPath.moveTo(x, y);\n@@ -389,8 +386,8 @@ private void touch_start(float x, float y) {\n         }\n \n         public void drawSignLine() {\n-            mCanvas.drawLine(0, (int) (mCanvas.getHeight() * .7),\n-                    mCanvas.getWidth(), (int) (mCanvas.getHeight() * .7), paint);\n+            mCanvas.drawLine(0, (int)(mCanvas.getHeight() * .7),\n+                    mCanvas.getWidth(), (int)(mCanvas.getHeight() * .7), paint);\n         }\n \n         private void touch_move(float x, float y) {\n@@ -432,6 +429,5 @@ public boolean onTouchEvent(MotionEvent event) {\n             }\n             return true;\n         }\n-\n     }\n }"
        }
      ]
    }
  },
  {
    "name": "Can\u0027t count traffic data from other apps in android \u003e 6",
    "url": "https://github.com/niclabs/adkintun-mobile-middleware/issues/6",
    "description": "Starting in N (android 7) the methods getUidRxBytes and getUidTxBytes used to calculate application traffic for each app, will only report traffic statistics for the calling UID (in our case, only statistics for AdkintunMobile). It will return UNSUPPORTED for all other UIDs for privacy reasons. \r\n\r\nTo access historical network statistics belonging to other UIDs, Android recommend to use NetworkStatsManager.",
    "keywords": [
      "android",
      "statistics",
      "traffic"
    ],
    "code": {
      "language": "Java",
      "url": "https://github.com/niclabs/adkintun-mobile-middleware/commit/0d538d7f75db2f5ab0f3f15d08aa5289fd4c06b1",
      "files": [
        {
          "file_name": "library/src/main/java/cl/niclabs/adkmobile/monitor/Traffic.java",
          "patch": "@@ -1,5 +1,9 @@\n package cl.niclabs.adkmobile.monitor;\n \n+import java.io.BufferedReader;\n+import java.io.FileNotFoundException;\n+import java.io.FileReader;\n+import java.io.IOException;\n import java.util.ArrayList;\n import java.util.Calendar;\n import java.util.List;\n@@ -54,7 +58,7 @@\n \t/**\n \t * @var Frequency of sampling for check NetworkStatsManager for android version \u003e 6 (in seconds)\n \t */\n-\tpublic static int NEW_TRAFFIC_UPDATE_INTERVAL \u003d 600;\n+\tpublic static int NEW_TRAFFIC_UPDATE_INTERVAL \u003d 10;\n \n \t/**\n \t * Extra key for configuring the traffic update interval\n@@ -274,31 +278,28 @@ public void run() {\n \t\t\t\tuids \u003d getUids(mContext);\n \t\t\t}\n \n-\t\t\tif (VERSION.SDK_INT \u003e\u003d Build.VERSION_CODES.M){\n-\t\t\t\tcalculateApplicationTrafficForAllUids(uids);\n-\t\t\t}\n-\t\t\telse {\n-\t\t\t\tlong newWifiRxBytes \u003d TrafficStats.getTotalRxBytes()\n-\t\t\t\t\t\t- TrafficStats.getMobileRxBytes();\n-\t\t\t\tlong dWifiRxBytes \u003d newWifiRxBytes - appWifiRxBytes;\n-\n-\t\t\t\tint networkType \u003d NETWORK_TYPE_MOBILE;\n-\t\t\t\tif (dWifiRxBytes \u003e 0) {\n-\t\t\t\t\tnetworkType \u003d NETWORK_TYPE_WIFI;\n-\t\t\t\t}\n-\t\t\t\tfor (int uid : uids) {\n-\t\t\t\t\tcalculateApplicationTrafficForUid(networkType, uid);\n-\t\t\t\t}\n+\t\t\tlong newWifiRxBytes \u003d TrafficStats.getTotalRxBytes()\n+\t\t\t\t\t- TrafficStats.getMobileRxBytes();\n+\t\t\tlong dWifiRxBytes \u003d newWifiRxBytes - appWifiRxBytes;\n \n-\t\t\t\tappWifiRxBytes \u003d newWifiRxBytes;\n+\t\t\tint networkType \u003d NETWORK_TYPE_MOBILE;\n+\t\t\tif (dWifiRxBytes \u003e 0) {\n+\t\t\t\tnetworkType \u003d NETWORK_TYPE_WIFI;\n+\t\t\t}\n+\t\t\tfor (int uid : uids) {\n+\t\t\t\tcalculateApplicationTrafficForUid(networkType, uid);\n \t\t\t}\n+\n+\t\t\tappWifiRxBytes \u003d newWifiRxBytes;\n \t\t}\n \t};\n \n \tprivate SparseArray\u003cLong\u003e appRxBytes;\n \tprivate SparseArray\u003cLong\u003e appTxBytes;\n \tprivate SparseArray\u003cLong\u003e appRxPackets;\n \tprivate SparseArray\u003cLong\u003e appTxPackets;\n+\tprivate final String UID_STAT_RX_PATH \u003d \"/proc/uid_stat/%1$d/tcp_rcv\";\n+\tprivate final String UID_STAT_TX_PATH \u003d \"/proc/uid_stat/%1$d/tcp_snd\";\n \n \tprivate ArrayList\u003cInteger\u003e uids;\n \n@@ -309,8 +310,27 @@ private void calculateApplicationTrafficForUid(int networkType, int uid) {\n \t\t\t\tTRAFFIC_APPLICATION, Time.currentTimeMillis());\n \t\tappData.setUid(uid);\n \n-\t\tlong newAppRxBytes \u003d TrafficStats.getUidRxBytes(uid);\n-\t\tlong newAppTxBytes \u003d TrafficStats.getUidTxBytes(uid);\n+\t\tlong newAppRxBytes \u003d 0;\n+\t\tlong newAppTxBytes \u003d 0;\n+\n+\t\t// if the following is not possible to use in the future, the method calculateApplicationTrafficForAllUids\n+\t\t// must be used (like in version 1.3.8b)\n+\t\tif (VERSION.SDK_INT \u003e\u003d Build.VERSION_CODES.M) {\n+\t\t\ttry {\n+\t\t\t\tBufferedReader rxBytesReader \u003d new BufferedReader(new FileReader(String.format(UID_STAT_RX_PATH, uid)));\n+\t\t\t\tBufferedReader txBytesReader \u003d new BufferedReader(new FileReader(String.format(UID_STAT_TX_PATH, uid)));\n+\t\t\t\tnewAppRxBytes \u003d Long.parseLong(rxBytesReader.readLine());\n+\t\t\t\tnewAppTxBytes \u003d Long.parseLong(txBytesReader.readLine());\n+\t\t\t} catch (FileNotFoundException e) {\n+\t\t\t\te.printStackTrace();\n+\t\t\t} catch (IOException e) {\n+\t\t\t\te.printStackTrace();\n+\t\t\t}\n+\t\t}\n+\t\telse {\n+\t\t\tnewAppRxBytes \u003d TrafficStats.getUidRxBytes(uid);\n+\t\t\tnewAppTxBytes \u003d TrafficStats.getUidTxBytes(uid);\n+\t\t}\n \n \t\t// IF the entry does not exist, the delta is 0\n \t\tlong dAppRxBytes \u003d newAppRxBytes\n@@ -396,7 +416,7 @@ private void calculateApplicationTrafficForAllUids(ArrayList\u003cInteger\u003e uids){\n \t\tlong startOfActualDay \u003d calendar.getTimeInMillis();\n \n \t\tfor (int uid : uids){\n-            //Get wifi traffic\n+\t\t\t//Get wifi traffic\n \t\t\tString uidWifiKey \u003d Integer.toString(uid) + \"_wifi\";\n \t\t\tlong lastEndTimestamp;\n \t\t\tif (sharedPreferences.contains(uidWifiKey))\n@@ -412,7 +432,7 @@ private void calculateApplicationTrafficForAllUids(ArrayList\u003cInteger\u003e uids){\n \t\t\t\twhile (stats.hasNextBucket()){\n \t\t\t\t\tstats.getNextBucket(bucketOut);\n \t\t\t\t\tTrafficObservation appData \u003d new TrafficObservation(\n-\t\t\t\t\t\t\tTRAFFIC_APPLICATION, bucketOut.getEndTimeStamp());\n+\t\t\t\t\t\t\tTRAFFIC_APPLICATION, bucketOut.getStartTimeStamp());\n \t\t\t\t\tappData.setUid(bucketOut.getUid());\n \t\t\t\t\tappData.setNetworkType(NETWORK_TYPE_WIFI);\n \t\t\t\t\tappData.setRxBytes(bucketOut.getRxBytes());\n@@ -425,10 +445,10 @@ private void calculateApplicationTrafficForAllUids(ArrayList\u003cInteger\u003e uids){\n \t\t\t} catch (RemoteException e) {\n \t\t\t\te.printStackTrace();\n \t\t\t} finally {\n-                editor.commit();\n-            }\n+\t\t\t\teditor.commit();\n+\t\t\t}\n \n-            //Get mobile traffic\n+\t\t\t//Get mobile traffic\n \t\t\tString uidMobileKey \u003d Integer.toString(uid) + \"_mobile\";\n \t\t\tif (sharedPreferences.contains(uidMobileKey))\n \t\t\t\tlastEndTimestamp \u003d sharedPreferences.getLong(uidMobileKey, 0);\n@@ -455,9 +475,9 @@ private void calculateApplicationTrafficForAllUids(ArrayList\u003cInteger\u003e uids){\n \t\t\t\t}\n \t\t\t} catch (RemoteException e) {\n \t\t\t\te.printStackTrace();\n-            } finally {\n-                editor.commit();\n-            }\n+\t\t\t} finally {\n+\t\t\t\teditor.commit();\n+\t\t\t}\n \t\t}\n \t}\n "
        }
      ]
    }
  },
  {
    "name": "Crash on android 2.3.6",
    "url": "https://github.com/nextgis/android_gisapp/issues/513",
    "description": "```\njava.lang.NoSuchMethodError: android.view.MenuItem.getActionView\n    at com.nextgis.mobile.activity.MainActivity$1.run(MainActivity.java:352)\n    at android.os.Handler.handleCallback(Handler.java:587)\n    at android.os.Handler.dispatchMessage(Handler.java:92)\n    at android.os.Looper.loop(Looper.java:130)\n    at android.app.ActivityThread.main(ActivityThread.java:3687)\n    at java.lang.reflect.Method.invokeNative(Native Method)\n    at java.lang.reflect.Method.invoke(Method.java:507)\n    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:867)\n    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:625)\n    at dalvik.system.NativeStart.main(Native Method)\n```\n\nabi armeabi\nabi2    unknown\napiLevel    10\nboard   torino\nbootloader  unknown\nbrand   samsung\ncpuCores    1\ndevice  GT-S6102\ndeviceId    GINGERBREAD\ndeviceModel GT-S6102\ndisplay GINGERBREAD.XXMA1\nisRoot  false\nlocaleCountry   RU\nlocaleLanguage  ru\nmanufacturer    samsung\nmemorySize  296360\nosRelease   2.3.6\nosVersion   2.6.35.7\nproduct GT-S6102\nscreenDensity   120\nscreenHeight    320\nscreenWidth 240\nDisk Info  \n/sdcard     1,779 MB / 3,716 MB\n",
    "keywords": [
      "com",
      "handler",
      "2",
      "gt-s6102",
      "3",
      "java",
      "os",
      "method",
      "6",
      "android",
      "main",
      "lang",
      "zygoteinit"
    ],
    "code": {
      "language": "Java",
      "url": "https://github.com/nextgis/android_gisapp/commit/afff7758167a672bb9ffaa7174bd19e275864a0f",
      "files": [
        {
          "file_name": "app/src/main/java/com/nextgis/mobile/activity/MainActivity.java",
          "patch": "@@ -347,6 +347,9 @@ public synchronized void onRefresh(boolean isRefresh) {\n     }\n \n     protected void stopRefresh(final MenuItem refreshItem) {\n+        if (Build.VERSION.SDK_INT \u003c Build.VERSION_CODES.HONEYCOMB)\n+            return;\n+\n         Handler handler \u003d new Handler(Looper.getMainLooper());\n         final Runnable r \u003d new Runnable() {\n             @TargetApi(Build.VERSION_CODES.HONEYCOMB)"
        }
      ]
    }
  },
  {
    "name": "Unable to decompile Settings.apk HTC Android 5.1  /6.0",
    "url": "https://github.com/iBotPeaches/Apktool/issues/1072",
    "description": "I\u0027m not able to decompile Settings.apk with any version of apktool. This is for 5.1 and just released 6.0 android version of HTC A9. Both apks give the same error. Here is a link to latest settings.apk if needed: https://drive.google.com/file/d/0Bw2v2JVflPziOGZ0Y1VPdGZESVE/view?usp\u003dsharing\n\n```\n2:22:32.624: [Error] - ApkTool.DecompileApk: \u0027ApkTool: I: Using Apktool 2.0.1-037041-SNAPSHOT on C79B78.apk\u0027\n22:22:32.624: [Error] - ApkTool.DecompileApk: \u0027ApkTool: I: Loading resource table...\u0027\n22:22:32.624: [Error] - ApkTool.DecompileApk: \u0027ApkTool: Exception in thread \"main\" brut.androlib.AndrolibException:  *Multiple resources: spec\u003d0x7f110000 bool/config_allow_edit_carrier_enabled, config\u003d[DEFAULT]\u0027*\n22:22:32.624: [Error] - ApkTool.DecompileApk: \u0027ApkTool:     at brut.androlib.res.data.ResConfig.addResource(ResConfig.java:63)\u0027\n22:22:32.624: [Error] - ApkTool.DecompileApk: \u0027ApkTool:     at brut.androlib.res.data.ResConfig.addResource(ResConfig.java:56)\u0027\n22:22:32.624: [Error] - ApkTool.DecompileApk: \u0027ApkTool:     at brut.androlib.res.decoder.ARSCDecoder.readEntry(ARSCDecoder.java:223)\u0027\n22:22:32.624: [Error] - ApkTool.DecompileApk: \u0027ApkTool:     at brut.androlib.res.decoder.ARSCDecoder.readConfig(ARSCDecoder.java:191)\u0027\n22:22:32.624: [Error] - ApkTool.DecompileApk: \u0027ApkTool:     at brut.androlib.res.decoder.ARSCDecoder.readType(ARSCDecoder.java:159)\u0027\n22:22:32.624: [Error] - ApkTool.DecompileApk: \u0027ApkTool:     at brut.androlib.res.decoder.ARSCDecoder.readPackage(ARSCDecoder.java:116)\u0027\n22:22:32.624: [Error] - ApkTool.DecompileApk: \u0027ApkTool:     at brut.androlib.res.decoder.ARSCDecoder.readTable(ARSCDecoder.java:78)\u0027\n22:22:32.624: [Error] - ApkTool.DecompileApk: \u0027ApkTool:     at brut.androlib.res.decoder.ARSCDecoder.decode(ARSCDecoder.java:47)\u0027\n22:22:32.624: [Error] - ApkTool.DecompileApk: \u0027ApkTool:     at brut.androlib.res.AndrolibResources.getResPackagesFromApk(AndrolibResources.java:538)\u0027\n22:22:32.624: [Error] - ApkTool.DecompileApk: \u0027ApkTool:     at brut.androlib.res.AndrolibResources.loadMainPkg(AndrolibResources.java:63)\u0027\n22:22:32.624: [Error] - ApkTool.DecompileApk: \u0027ApkTool:     at brut.androlib.res.AndrolibResources.getResTable(AndrolibResources.java:55)\u0027\n22:22:32.624: [Error] - ApkTool.DecompileApk: \u0027ApkTool:     at brut.androlib.Androlib.getResTable(Androlib.java:64)\u0027\n22:22:32.624: [Error] - ApkTool.DecompileApk: \u0027ApkTool:     at brut.androlib.ApkDecoder.setTargetSdkVersion(ApkDecoder.java:209)\u0027\n22:22:32.624: [Error] - ApkTool.DecompileApk: \u0027ApkTool:     at brut.androlib.ApkDecoder.decode(ApkDecoder.java:92)\u0027\n22:22:32.624: [Error] - ApkTool.DecompileApk: \u0027ApkTool:     at brut.apktool.Main.cmdDecode(Main.java:165)\u0027\n22:22:32.624: [Error] - ApkTool.DecompileApk: \u0027ApkTool:     at brut.apktool.Main.main(Main.java:81)\u0027\n```\n",
    "keywords": [
      "brut",
      "apktool",
      "main",
      "apktool decompileapk",
      "decompileapk",
      "androlib res",
      "decompileapk: \u0027apktool",
      "22:22:32",
      "[error]",
      "apk",
      "resconfig",
      "res decoder",
      "res",
      "settings",
      "androlibresources",
      "decoder arscdecoder",
      "decoder",
      "\u0027apktool",
      "22:22:32 624",
      "androlib",
      "624: [error]",
      "0",
      "624",
      "apkdecoder",
      "arscdecoder",
      "brut androlib"
    ],
    "code": {
      "language": "Java",
      "url": "https://github.com/iBotPeaches/Apktool/commit/5f5f50f6fdc43d15565f6fbf428526ec72a5684c",
      "files": [
        {
          "file_name": "brut.apktool/apktool-lib/src/main/java/brut/androlib/res/data/ResConfigFlags.java",
          "patch": "@@ -178,6 +178,10 @@ private String generateQualifiers() {\n             } else {\n                 ret.append(\"-mnc00\");\n             }\n+        } else {\n+            if (mnc !\u003d 0) {\n+                ret.append(\"-mnc\").append(mnc);\n+            }\n         }\n         ret.append(getLocaleString());\n "
        },
        {
          "file_name": "brut.apktool/apktool-lib/src/test/java/brut/androlib/BuildAndDecodeTest.java",
          "patch": "@@ -188,6 +188,11 @@ public void shortendedMncTest() throws BrutException {\n     }\n \n     @Test\n+    public void shortMncHtcTest() throws BrutException {\n+        compareValuesFiles(\"values-mnc1/strings.xml\");\n+    }\n+\n+    @Test\n     public void anyDpiTest() throws BrutException, IOException {\n         compareValuesFiles(\"values-watch/strings.xml\");\n     }"
        },
        {
          "file_name": "brut.apktool/apktool-lib/src/test/resources/brut/apktool/testapp/res/values-mnc1/strings.xml",
          "patch": "@@ -0,0 +1,4 @@\n+\u003c?xml version\u003d\"1.0\" encoding\u003d\"utf-8\"?\u003e\n+\u003cresources\u003e\n+    \u003cstring name\u003d\"test1\"\u003etest1\u003c/string\u003e\n+\u003c/resources\u003e\n\\ No newline at end of file"
        }
      ]
    }
  },
  {
    "name": "Map is not visible on android 6",
    "url": "https://github.com/ojacquemart/vlilleChecker/issues/96",
    "description": "User remark from the store (Lg g4 on android 6.0).\nMarkers are only visible.\n\nSee https://github.com/osmdroid/osmdroid/issues/178\n",
    "keywords": [],
    "code": {
      "language": "Java",
      "url": "https://github.com/ojacquemart/vlilleChecker/commit/7216b3aa4a4750c575c25716ca01f17371a18497",
      "files": [
        {
          "file_name": "app/res/values-fr/strings.xml",
          "patch": "@@ -32,6 +32,13 @@\n     \u003cstring name\u003d\"error_no_location_found\"\u003eAucune position disponible\u003c/string\u003e\n     \u003cstring name\u003d\"error_no_gmaps_app_found\"\u003eAucune application de navigation trouvée\u003c/string\u003e\n \n+    \u003c!-- Permissions --\u003e\n+    \u003cstring name\u003d\"permission_location_explanation\"\u003eVotre position est nécessaire pour placer une icône sur la carte\u003c/string\u003e\n+    \u003cstring name\u003d\"permission_storage_explanation\"\u003eLes cartes sont stockées sur votre appareil pour réduire l\\\u0027utilisation de votre data\u003c/string\u003e\n+    \u003cstring name\u003d\"permission_location_not_granted\"\u003eVotre position est nécessaire pour vous localiser sur la carte\u003c/string\u003e\n+    \u003cstring name\u003d\"permission_storage_not_granted\"\u003eLe stockage est nécessaire pour la mise en cache des cartes\u003c/string\u003e\n+\n+\n     \u003c!-- Home Preferences --\u003e\n     \u003cstring name\u003d\"prefs_home_title\"\u003eAffichage stations\u003c/string\u003e\n     \u003cstring name\u003d\"prefs_station_id_visible_title\"\u003eNuméro\u003c/string\u003e"
        },
        {
          "file_name": "app/res/values/strings.xml",
          "patch": "@@ -32,6 +32,12 @@\n     \u003cstring name\u003d\"error_no_location_found\"\u003eNo location available\u003c/string\u003e\n     \u003cstring name\u003d\"error_no_gmaps_app_found\"\u003eNo navigation app found\u003c/string\u003e\n \n+    \u003c!-- Permissions --\u003e\n+    \u003cstring name\u003d\"permission_location_explanation\"\u003eYour location is needed to place an icon on the map\u003c/string\u003e\n+    \u003cstring name\u003d\"permission_storage_explanation\"\u003eWe store tiles to your devices storage to reduce data usage\u003c/string\u003e\n+    \u003cstring name\u003d\"permission_location_not_granted\"\u003eLocation permission is required for user location on map\u003c/string\u003e\n+    \u003cstring name\u003d\"permission_storage_not_granted\"\u003e\"Storage permission is needed for offline map data caching\u003c/string\u003e\n+\n     \u003c!-- Home Preferences --\u003e\n     \u003cstring name\u003d\"prefs_home_title\"\u003eStations display\u003c/string\u003e\n     \u003cstring name\u003d\"prefs_station_id_visible_title\"\u003eId\u003c/string\u003e"
        },
        {
          "file_name": "app/src/com/vlille/checker/ui/fragment/MapFragment.java",
          "patch": "@@ -1,7 +1,11 @@\n package com.vlille.checker.ui.fragment;\n \n+import android.Manifest;\n+import android.content.pm.PackageManager;\n import android.os.Bundle;\n import android.support.design.widget.FloatingActionButton;\n+import android.support.v4.app.ActivityCompat;\n+import android.support.v4.content.ContextCompat;\n import android.util.Log;\n import android.view.LayoutInflater;\n import android.view.View;\n@@ -13,53 +17,125 @@\n import com.vlille.checker.ui.delegate.StationUpdateDelegate;\n import com.vlille.checker.ui.osm.MapState;\n import com.vlille.checker.ui.osm.MapView;\n+import com.vlille.checker.utils.ToastUtils;\n import org.droidparts.annotation.inject.InjectDependency;\n import org.droidparts.fragment.support.v4.Fragment;\n import org.osmdroid.util.GeoPoint;\n \n+import java.util.HashMap;\n import java.util.List;\n- \n+import java.util.Map;\n+\n /**\n  * A fragment to localize and bookmark stations from a map, using OpenStreetMap.\n  */\n public class MapFragment extends Fragment implements StationUpdateDelegate {\n \n-\tprivate static final String TAG \u003d MapFragment.class.getSimpleName();\n+    private static final String TAG \u003d MapFragment.class.getSimpleName();\n+\n+    private static final Map\u003cInteger, PermissionConfig\u003e PERMISSIONS_CONFIG \u003d new HashMap\u003c\u003e();\n+    static {\n+        PERMISSIONS_CONFIG.put(PermissionConfig.LOCATION, new PermissionConfig(PermissionConfig.LOCATION,\n+                Manifest.permission.ACCESS_FINE_LOCATION,\n+                R.string.permission_location_explanation,\n+                R.string.permission_location_not_granted));\n+        PERMISSIONS_CONFIG.put(PermissionConfig.STORAGE, new PermissionConfig(PermissionConfig.STORAGE,\n+                Manifest.permission.WRITE_EXTERNAL_STORAGE,\n+                R.string.permission_storage_explanation,\n+                R.string.permission_storage_not_granted));\n+    }\n \n     @InjectDependency\n     private StationEntityManager stationEntityManager;\n+    private MapState state \u003d new MapState();\n+\n+    private MapView mapView;\n+\n+    private List\u003cStation\u003e stations;\n+\n+    static class PermissionConfig {\n+        public static int LOCATION \u003d 1;\n+        public static int STORAGE \u003d 2;\n \n-\tprivate MapState state \u003d new MapState();\n-\tprivate MapView mapView;\n-\tprivate List\u003cStation\u003e stations;\n-\t\n-\t@Override\n-\tpublic void onCreate(Bundle bundle) {\n-\t\tsuper.onCreate(bundle);\n-\t\tLog.d(TAG, \"onCreate\");\n+        int requestCode;\n+        String permission;\n+        int explanation;\n+        int notGrantedText;\n+\n+        PermissionConfig(int requestCode, String permission, int explanation, int notGrantedText) {\n+            this.requestCode \u003d requestCode;\n+            this.permission \u003d permission;\n+            this.explanation \u003d explanation;\n+            this.notGrantedText \u003d notGrantedText;\n+        }\n+    }\n+\n+    @Override\n+    public void onCreate(Bundle bundle) {\n+        super.onCreate(bundle);\n+        Log.d(TAG, \"onCreate\");\n+\n+        checkPermissions();\n \n         if (!this.state.isInitialized()) {\n             this.state.save(MapView.DEFAULT_CENTER_GEO_POINT, MapView.DEFAULT_ZOOM_LEVEL);\n         }\n     }\n \n+    private void checkPermissions() {\n+        Log.d(TAG, \"checkPermissions\");\n+        for (PermissionConfig permissionConfig : PERMISSIONS_CONFIG.values()) {\n+            checkPermission(permissionConfig);\n+        }\n+    }\n+\n+    private void checkPermission(PermissionConfig permissionConfig) {\n+        Log.v(TAG, \"Check for permission \" + permissionConfig.permission);\n+\n+        int permissionCheck \u003d ContextCompat.checkSelfPermission(getActivity(), permissionConfig.permission);\n+        if (permissionCheck !\u003d PackageManager.PERMISSION_GRANTED) {\n+            if (ActivityCompat.shouldShowRequestPermissionRationale(getActivity(), permissionConfig.permission)) {\n+                ToastUtils.show(getActivity(), permissionConfig.explanation);\n+            } else {\n+                // No explanation needed, we can request the permission.\n+                ActivityCompat.requestPermissions(getActivity(), new String[]{permissionConfig.permission}, permissionConfig.requestCode);\n+            }\n+        }\n+    }\n+\n+    @Override\n+    public void onRequestPermissionsResult(int requestCode, String permissions[], int[] grantResults) {\n+        PermissionConfig permissionConfig \u003d PERMISSIONS_CONFIG.get(requestCode);\n+        if (permissionConfig !\u003d null) {\n+            handleOnRequestPermissionsResult(permissionConfig, permissions, grantResults);\n+        }\n+    }\n+\n+    private void handleOnRequestPermissionsResult(PermissionConfig permissionConfig, String[] permissions, int[] grantResults) {\n+        Log.v(TAG, \"Handle permission result for \" + permissionConfig.permission);\n+        boolean granted \u003d grantResults.length \u003e 0 \u0026\u0026 grantResults[0] \u003d\u003d PackageManager.PERMISSION_GRANTED;\n+        if (!granted) {\n+            ToastUtils.show(getActivity(), permissionConfig.notGrantedText);\n+        }\n+    }\n+\n     public void setCenter(GeoPoint center) {\n         Log.d(TAG, \"setCenter \" + center);\n         this.state.currentCenter \u003d center;\n         this.state.zoomLevel \u003d MapView.DEFAULT_ZOOM_LEVEL;\n     }\n-\t\n-\t@Override\n+\n+    @Override\n     public View onCreateView(Bundle savedInstanceState,\n                              LayoutInflater inflater, ViewGroup container) {\n-\t\tsuper.onCreate(savedInstanceState);\n-\t\tLog.d(TAG, \"onCreateView\");\n+        super.onCreate(savedInstanceState);\n+        Log.d(TAG, \"onCreateView\");\n \n-\t\tfinal View view \u003d inflater.inflate(R.layout.maps, container, false);\n-\t\tmapView \u003d (MapView) view.findViewById(R.id.mapview);\n+        final View view \u003d inflater.inflate(R.layout.maps, container, false);\n+        mapView \u003d (MapView) view.findViewById(R.id.mapview);\n \n-\t\treturn view;\n-\t}\n+        return view;\n+    }\n \n     @Override\n     public void onActivityCreated(Bundle savedInstanceState) {\n@@ -92,23 +168,23 @@ public void onClick(View v) {\n         });\n     }\n \n-\t@Override\n-\tpublic void onResume() {\n-\t\tsuper.onResume();\n-\t\t\n-\t\tmapView.updateStations();\n-\t}\n-\t\n-\t@Override\n-\tpublic void onPause() {\n-\t\tsuper.onPause();\n-\t\tLog.d(TAG, \"onPause\");\n-\t\t\n-\t\tGeoPoint mapCenter \u003d (GeoPoint) mapView.getMapCenter();\n-\t\tif (mapView.isLocationOn()) {\n-\t\t\tmapCenter \u003d null;\n-\t\t}\n-\t\tstate.save(mapCenter, mapView.getZoomLevel());\n-\t}\n+    @Override\n+    public void onResume() {\n+        super.onResume();\n+\n+        mapView.updateStations();\n+    }\n+\n+    @Override\n+    public void onPause() {\n+        super.onPause();\n+        Log.d(TAG, \"onPause\");\n+\n+        GeoPoint mapCenter \u003d (GeoPoint) mapView.getMapCenter();\n+        if (mapView.isLocationOn()) {\n+            mapCenter \u003d null;\n+        }\n+        state.save(mapCenter, mapView.getZoomLevel());\n+    }\n \n }"
        }
      ]
    }
  },
  {
    "name": "PermissionDenied in image upload on Android 6.0+",
    "url": "https://github.com/vickychijwani/quill/issues/119",
    "description": "We need to use runtime permissions on Android 6.0+. Currently the only _dangerous_ permission we have ([\"dangerous\" as defined by Android](https://developer.android.com/guide/topics/permissions/requesting.html#perm-groups)) is [`READ_EXTERNAL_STORAGE`](https://github.com/vickychijwani/quill/blob/master/app/src/main/AndroidManifest.xml).",
    "keywords": [
      "android"
    ],
    "code": {
      "language": "Java",
      "url": "https://github.com/vickychijwani/quill/commit/2d43fce2dcb59debd6795a6b1592a44b9f65f932",
      "files": [
        {
          "file_name": "app/build.gradle",
          "patch": "@@ -131,6 +131,8 @@ dependencies {\n     compile(\"com.crashlytics.sdk.android:answers:1.3.7@aar\") {\n         transitive \u003d true\n     }\n+    compile \"com.github.hotchemi:permissionsdispatcher:$rootProject.ext.permissionsDispatcherVersion\"\n+    annotationProcessor \"com.github.hotchemi:permissionsdispatcher-processor:$rootProject.ext.permissionsDispatcherVersion\"\n     compile \"com.github.slugify:slugify:2.1.3\"\n \n     // debug"
        },
        {
          "file_name": "app/src/main/java/me/vickychijwani/spectre/util/AppUtils.java",
          "patch": "@@ -1,12 +1,14 @@\n package me.vickychijwani.spectre.util;\n \n+import android.app.Activity;\n import android.content.Context;\n import android.content.Intent;\n import android.content.pm.PackageInfo;\n import android.content.pm.PackageManager;\n import android.content.res.Resources;\n import android.net.Uri;\n import android.os.Build;\n+import android.provider.Settings;\n import android.support.annotation.NonNull;\n import android.util.DisplayMetrics;\n import android.widget.Toast;\n@@ -60,6 +62,17 @@ public static String getAppVersion(@NonNull Context context) {\n         }\n     }\n \n+    public static void showSystemAppSettingsActivity(@NonNull final Activity context) {\n+        final Intent i \u003d new Intent();\n+        i.setAction(Settings.ACTION_APPLICATION_DETAILS_SETTINGS);\n+        i.addCategory(Intent.CATEGORY_DEFAULT);\n+        i.setData(Uri.parse(\"package:\" + context.getPackageName()));\n+        i.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);\n+        i.addFlags(Intent.FLAG_ACTIVITY_NO_HISTORY);\n+        i.addFlags(Intent.FLAG_ACTIVITY_EXCLUDE_FROM_RECENTS);\n+        context.startActivity(i);\n+    }\n+\n     /**\n      * Set the app to use the given locale. Useful for testing translations. This is normally\n      * not needed because the device locale is applied automatically."
        },
        {
          "file_name": "app/src/main/java/me/vickychijwani/spectre/view/fragments/PostEditFragment.java",
          "patch": "@@ -1,5 +1,7 @@\n package me.vickychijwani.spectre.view.fragments;\n \n+import android.Manifest;\n+import android.annotation.SuppressLint;\n import android.app.Activity;\n import android.app.ProgressDialog;\n import android.content.Intent;\n@@ -47,6 +49,7 @@\n import me.vickychijwani.spectre.model.entity.Post;\n import me.vickychijwani.spectre.model.entity.Tag;\n import me.vickychijwani.spectre.network.ApiFailure;\n+import me.vickychijwani.spectre.util.AppUtils;\n import me.vickychijwani.spectre.util.EditTextSelectionState;\n import me.vickychijwani.spectre.util.EditTextUtils;\n import me.vickychijwani.spectre.util.KeyboardUtils;\n@@ -55,6 +58,10 @@\n import me.vickychijwani.spectre.view.FormatOptionClickListener;\n import me.vickychijwani.spectre.view.Observables;\n import me.vickychijwani.spectre.view.PostViewActivity;\n+import permissions.dispatcher.NeedsPermission;\n+import permissions.dispatcher.OnNeverAskAgain;\n+import permissions.dispatcher.OnPermissionDenied;\n+import permissions.dispatcher.RuntimePermissions;\n import rx.Observable;\n import rx.Subscription;\n import rx.android.schedulers.AndroidSchedulers;\n@@ -63,6 +70,7 @@\n import rx.schedulers.Schedulers;\n import rx.subscriptions.Subscriptions;\n \n+@RuntimePermissions\n public class PostEditFragment extends BaseFragment implements\n         FormatOptionClickListener {\n \n@@ -329,13 +337,21 @@ public void onFormatImageClicked(View v) {\n             if (item.getItemId() \u003d\u003d R.id.action_insert_image_url) {\n                 onInsertImageUrlClicked(insertMarkdownAction);\n             } else if (item.getItemId() \u003d\u003d R.id.action_insert_image_upload) {\n-                onInsertImageUploadClicked(insertMarkdownAction);\n+                // the *WithCheck() method checks for runtime permissions and\n+                // is generated by the PermissionsDispatcher library\n+                PostEditFragmentPermissionsDispatcher.onInsertImageUploadClickedWithCheck(this,\n+                        insertMarkdownAction);\n             }\n             return true;\n         });\n         popupMenu.show();\n     }\n \n+    @Override\n+    public void onRequestPermissionsResult(int requestCode, @NonNull String[] permissions, @NonNull int[] grantResults) {\n+        PostEditFragmentPermissionsDispatcher.onRequestPermissionsResult(this, requestCode, grantResults);\n+    }\n+\n     public void onInsertImageUrlClicked(Action1\u003cString\u003e resultAction) {\n         Observables.getImageUrlDialog(mActivity).subscribe((imageUrl) -\u003e {\n             resultAction.call(imageUrl);\n@@ -344,6 +360,8 @@ public void onInsertImageUrlClicked(Action1\u003cString\u003e resultAction) {\n         });\n     }\n \n+    @SuppressLint(\"InlinedApi\") // suppressed because PermissionsDispatcher handles API levels for us\n+    @NeedsPermission(Manifest.permission.READ_EXTERNAL_STORAGE)\n     public void onInsertImageUploadClicked(Action1\u003cString\u003e uploadDoneAction) {\n         mImageUploadDoneAction \u003d uploadDoneAction;\n         Intent imagePickIntent \u003d new Intent(Intent.ACTION_GET_CONTENT);\n@@ -356,6 +374,19 @@ public void onInsertImageUploadClicked(Action1\u003cString\u003e uploadDoneAction) {\n         }\n     }\n \n+    @SuppressLint(\"InlinedApi\") // suppressed because PermissionsDispatcher handles API levels for us\n+    @OnPermissionDenied(Manifest.permission.READ_EXTERNAL_STORAGE)\n+    void onStoragePermissionDenied() {\n+        Toast.makeText(mActivity, R.string.image_upload_failed, Toast.LENGTH_SHORT).show();\n+    }\n+\n+    @SuppressLint(\"InlinedApi\") // suppressed because PermissionsDispatcher handles API levels for us\n+    @OnNeverAskAgain(Manifest.permission.READ_EXTERNAL_STORAGE)\n+    void onStoragePermissionPermanentlyDenied() {\n+        Toast.makeText(mActivity, R.string.enable_permission_tip, Toast.LENGTH_LONG).show();\n+        AppUtils.showSystemAppSettingsActivity(mActivity);\n+    }\n+\n     @Override\n     public void onActivityResult(int requestCode, int resultCode, Intent result) {\n         if (result \u003d\u003d null || result.getData() \u003d\u003d null || resultCode !\u003d Activity.RESULT_OK) {"
        },
        {
          "file_name": "app/src/main/res/values/strings.xml",
          "patch": "@@ -93,6 +93,7 @@\n     \u003cstring name\u003d\"uploading\"\u003eUploading…\u003c/string\u003e\n     \u003cstring name\u003d\"image_upload_failed\"\u003eCouldn\\\u0027t upload image\u003c/string\u003e\n     \u003cstring name\u003d\"remove_image\"\u003eRemove This Image\u003c/string\u003e\n+    \u003cstring name\u003d\"enable_permission_tip\"\u003eTap \"Permissions\" and enable the \"Storage\" permission\u003c/string\u003e\n \n     \u003c!-- conflict resolution --\u003e\n     \u003cstring name\u003d\"conflict_explanation\"\u003e\u003c![CDATA[\u003cb\u003eThe post \u003ci\u003e%s\u003c/i\u003e has a conflict.\u003c/b\u003e It was updated on the server before your device\\\u0027s copy could be uploaded. Which version of the post would you like to keep?]]\u003e\u003c/string\u003e"
        },
        {
          "file_name": "build.gradle",
          "patch": "@@ -22,5 +22,6 @@ allprojects {\n ext {\n     okhttpVersion \u003d \u00273.6.0\u0027\n     supportLibVersion \u003d \u002725.1.1\u0027\n+    permissionsDispatcherVersion \u003d \u00272.3.1\u0027\n     debugdrawerVersion \u003d \u00270.7.0\u0027\n }"
        }
      ]
    }
  },
  {
    "name": "No image for existing contacts on Android 6",
    "url": "https://github.com/kontalk/androidclient/issues/664",
    "description": "Yesterday morning, I got an upgrade to CyanogenMod 13 (Android 6.0.1) through my nightly updates. After doing so, most of my contact pictures in Kontalk disappeared (they are still visible in the Phone and SMSSecure app). I have made sure that Kontalk has access to all its requested permissions. This device does not run Google Play.\n\nScreenshot of the issue:\n![missing_contact_pictures](https://cloud.githubusercontent.com/assets/1885159/14066830/40b8fd82-f455-11e5-9dd9-1dc4e5c75b56.png)\n\nI must note the following:\n- Tapping the letters opens the Android contact view, with the contact image visible in that view (but not in Kontalk).\n- Some contacts who I still have conversations open with, but do no longer use Kontalk, do have their avatar displayed correctly.\n\nThings I have tried:\n- Resyncing contacts\n- Rebooting device\n- Force-killing Kontalk\n- Toggle \"sync invisible contacts\"\n\nThe logs (opening the app and starting a sync) contain nothing interesting:\n\n```\n03-27 20:03:22.145 19751 19751 D MessageCenterService: Message Center starting - Intent { act\u003dorg.kontalk.action.HOLD cmp\u003dorg.kontalk/.service.msgcenter.MessageCenterService }\n03-27 20:03:22.146 19751 19751 D MessageCenterService: entering active state\n03-27 20:03:23.982 19751 19751 D MessageCenterService: Message Center starting - Intent { act\u003dorg.kontalk.action.RELEASE cmp\u003dorg.kontalk/.service.msgcenter.MessageCenterService }\n03-27 20:03:24.215 19751 19751 D MessageCenterService: Message Center starting - Intent { act\u003dorg.kontalk.action.HOLD cmp\u003dorg.kontalk/.service.msgcenter.MessageCenterService }\n03-27 20:03:24.316 19751 19767 D OpenGLRenderer: endAllStagingAnimators on 0x9fdb6900 (RippleDrawable) with handle 0x9f8be260\n03-27 20:03:25.813 19751 20025 I SyncAdapter: sync started (authority\u003dcom.android.contacts)\n03-27 20:03:25.822 19751 20025 V SyncAdapter: resyncing users database\n03-27 20:03:25.836 19751 19751 D MessageCenterService: Message Center starting - Intent { act\u003dorg.kontalk.action.HOLD cmp\u003dorg.kontalk/.service.msgcenter.MessageCenterService }\n03-27 20:03:26.794 19751 20025 D SyncAdapter: users database resynced (109)\n03-27 20:03:27.139 19751 19751 D MessageCenterService: Message Center starting - Intent { act\u003dorg.kontalk.action.CONNECTED cmp\u003dorg.kontalk/.service.msgcenter.MessageCenterService }\n03-27 20:03:27.168 19751 19751 D MessageCenterService: Message Center starting - Intent { act\u003dorg.kontalk.action.ROSTER_MATCH cmp\u003dorg.kontalk/.service.msgcenter.MessageCenterService (has extras) }\n03-27 20:03:27.387 19751 19751 D MessageCenterService: Message Center starting - Intent { act\u003dorg.kontalk.action.PRESENCE cmp\u003dorg.kontalk/.service.msgcenter.MessageCenterService (has extras) }\n03-27 20:03:27.514 19751 19751 D MessageCenterService: Message Center starting - Intent { act\u003dorg.kontalk.action.PUBLICKEY cmp\u003dorg.kontalk/.service.msgcenter.MessageCenterService (has extras) }\n03-27 20:03:27.516 19751 19751 D MessageCenterService: Message Center starting - Intent { act\u003dorg.kontalk.action.BLOCKLIST cmp\u003dorg.kontalk/.service.msgcenter.MessageCenterService }\n03-27 20:03:27.797 19751 20032 V MessageCenterService: broadcasting blocklist: Intent { act\u003dorg.kontalk.action.BLOCKLIST }\n03-27 20:03:27.965 19751 20033 V MessageCenterService: personal key updated.\n03-27 20:03:31.948 19751 20025 D SyncAdapter: users database committed\n03-27 20:03:32.468 19751 20025 D SyncAdapter: sync took 6.65700 seconds\n03-27 20:03:32.472 19751 19751 D MessageCenterService: Message Center starting - Intent { act\u003dorg.kontalk.action.RELEASE cmp\u003dorg.kontalk/.service.msgcenter.MessageCenterService }\n```\n",
    "keywords": [
      "messagecenterservice",
      "20:03:25",
      "android",
      "messagecenterservice: message",
      "extras",
      "msgcenter",
      "msgcenter messagecenterservice",
      "center starting",
      "hold",
      "kontalk/",
      "syncadapter",
      "database",
      "03-27 20:03:27",
      "contact",
      "action",
      "message center",
      "19751 d",
      "19751 19751",
      "cmp\u003dorg",
      "kontalk",
      "blocklist",
      "kontalk action",
      "20025",
      "d",
      "20025 d",
      "19751",
      "center",
      "service msgcenter",
      "cmp\u003dorg kontalk/",
      "message",
      "intent",
      "sync",
      "d messagecenterservice",
      "users",
      "03-27",
      "kontalk/ service",
      "act\u003dorg",
      "service",
      "v",
      "6",
      "20:03:27",
      "starting",
      "contacts",
      "act\u003dorg kontalk"
    ],
    "code": {
      "language": "Java",
      "url": "https://github.com/kontalk/androidclient/commit/2ed87e17f4d8b2a58b75478e0caf2a1a09877533",
      "files": [
        {
          "file_name": "app/src/main/java/org/kontalk/data/Contact.java",
          "patch": "@@ -514,17 +514,8 @@ private static Contact _findByUserId(Context context, String userId) {\n     private static byte[] loadAvatarData(Context context, Uri contactUri) {\n         byte[] data \u003d null;\n \n-        Uri uri;\n-        try {\n-            long cid \u003d ContentUris.parseId(contactUri);\n-            uri \u003d ContentUris.withAppendedId(ContactsContract.Contacts.CONTENT_URI, cid);\n-        }\n-        catch (Exception e) {\n-            uri \u003d contactUri;\n-        }\n-\n         InputStream avatarDataStream \u003d Contacts.openContactPhotoInputStream(\n-                    context.getContentResolver(), uri);\n+                    context.getContentResolver(), contactUri);\n         if (avatarDataStream !\u003d null) {\n             try {\n                     data \u003d new byte[avatarDataStream.available()];"
        }
      ]
    }
  }
]